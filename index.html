<!-- Author: Honglie Zhang -->
<!DOCTYPE html>
<html lang="zh-CN"> <!-- 更准确的中文语言代码 -->

<head>
  <!-- Meta Tags (最优先加载) -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="宏基因组报告分析系统">
  <meta name="author" content="Honglie Zhang"> <!-- 建议添加作者信息 -->

  <title>宏基因组报告</title>

  <!-- Critical CSS (如果有) -->
  <style>
    /* 关键渲染路径的CSS */
  </style>

  <!-- 预加载关键资源 -->
  <link
    rel="preload"
    href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@500;700;800&display=swap"
    as="style"
    crossorigin="anonymous"
  >

  <!-- 第三方CSS -->
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    crossorigin="anonymous"
  >

  <!-- 字体资源 -->
  <!-- 优化字体加载 -->
  <link
    href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@500;700;800&display=swap"
    rel="stylesheet"
    media="print"
    onload="this.media='all'"
    crossorigin="anonymous"
  >

  <!-- 自定义CSS -->
  <link rel="stylesheet" href="./css/style.css">

  <!-- 全局配置（在框架之前） -->
  <script>
    window.DATA_PATHS = {
      DATA: './data/bacteria_data.json'
    };
  </script>

  <!-- 框架/库（使用 defer 确保不阻塞） -->
  <script src="https://cdn.tailwindcss.com" defer></script>

  <!-- 无JS时的降级方案 -->
  <noscript>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@500;700;800&display=swap"
      rel="stylesheet"
      crossorigin="anonymous"
    >
  </noscript>
</head>

<!-- 页面主体 -->
<body class="bg-white p-6">

  <!-- 宏基因组检测报告总结页 -->

  <!-- h1标题：使用自定义样式类custom-title-first-level来定制"宏基因组检测报告"的样式 -->
  <h1 class="custom-title-first-level mt-[-5mm]">宏基因组检测报告</h1>

<!--  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">-->

<!--    &lt;!&ndash; 基本信息行 &ndash;&gt;-->
<!--    <div class="grid grid-cols-2 gap-4 mb-2">-->
<!--      &lt;!&ndash; 左边三个 summary-info-card &ndash;&gt;-->
<!--      <div class="flex gap-2">-->
<!--        <div class="summary-info-card" style="flex: 75;">-->
<!--          <div class="summary-title font-bold">姓名</div>-->
<!--          <div class="font-bold text-gray-500">张三</div>-->
<!--        </div>-->
<!--        <div class="summary-info-card" style="flex: 75;">-->
<!--          <div class="summary-title font-bold">性别</div>-->
<!--          <div class="font-bold text-gray-500">男性</div>-->
<!--        </div>-->
<!--        <div class="summary-info-card" style="flex: 100;">-->
<!--          <div class="summary-title font-bold">年龄</div>-->
<!--          <div class="font-bold text-gray-500">3岁0月</div>-->
<!--        </div>-->
<!--      </div>-->

<!--      &lt;!&ndash; 右边两个 summary-info-card &ndash;&gt;-->
<!--      <div class="flex gap-2">-->
<!--        <div class="summary-info-card flex-1">-->
<!--          <div class="summary-title font-bold">样本编号</div>-->
<!--          <div class="font-bold text-gray-500">681364179</div>-->
<!--        </div>-->
<!--        <div class="summary-info-card flex-1">-->
<!--          <div class="summary-title font-bold">报告日期</div>-->
<!--          <div class="font-bold text-gray-500">2025-02-11</div>-->
<!--        </div>-->
<!--      </div>-->
<!--    </div>-->

<!--    &lt;!&ndash; 健康总分和右侧三个框并排显示 &ndash;&gt;-->
<!--    <div class="grid grid-cols-2 gap-4 mb-2">-->
<!--      &lt;!&ndash; 左侧健康总分 &ndash;&gt;-->
<!--      <div class="summary-info-card">-->
<!--        <div class="summary-title mb-7"><b>健康总分</b></div>-->
<!--        <div class="flex flex-col items-center">-->
<!--          <div class="w-40 h-40 mb-5">-->
<!--            <svg viewBox="0 0 100 100">-->
<!--              <circle class="summary-circle-bg" cx="50" cy="50" r="45"/>-->
<!--              <circle class="summary-circle" cx="50" cy="50" r="45"-->
<!--                      stroke-dasharray="282.7"-->
<!--                      stroke-dashoffset="101.772"/>-->
<!--              <text x="50" y="45"-->
<!--                    class="summary-score-text"-->
<!--                    text-anchor="middle"-->
<!--                    dominant-baseline="middle"-->
<!--                    font-size="30"-->
<!--                    font-weight="bold"-->
<!--                    fill="#FF5733">64</text>-->
<!--              <text x="50" y="68"-->
<!--                    class="summary-score-text"-->
<!--                    text-anchor="middle"-->
<!--                    font-size="10"-->
<!--                    fill="#2DA6A8">总分: 100</text>-->
<!--            </svg>-->
<!--          </div>-->
<!--          <div class="summary-description text-center">-->
<!--            处于亚健康及营养饮食不合理状态，表明目前健康状况处于中等偏下水平，主要原因是饮食营养不均衡，需要通过调整饮食结构和生活习惯来改善健康状况。-->
<!--          </div>-->
<!--        </div>-->
<!--      </div>-->

<!--      &lt;!&ndash; 右侧三个框堆叠 &ndash;&gt;-->
<!--      <div class="flex flex-col gap-2 h-full">-->
<!--        &lt;!&ndash; 菌群健康 &ndash;&gt;-->
<!--        <div class="flex-1 summary-info-card p-4">-->
<!--          <div class="summary-title font-bold mb-3">菌群健康</div>-->
<!--          <div class="flex w-full items-center">-->
<!--            <div class="flex-1 bg-gray-200 rounded-full h-3 mr-3">-->
<!--              <div class="bg-[#FFD700] h-3 rounded-full" style="width: 73%"></div>-->
<!--            </div>-->
<!--            <div class="text-[#2DA6A8] font-bold w-16 text-right">-->
<!--              <span class="text-[#FFD700]">73</span>/100-->
<!--            </div>-->
<!--          </div>-->
<!--          <div class="text-sm text-gray-600 mt-2">-->
<!--            肠道菌群多样性良好-->
<!--          </div>-->
<!--        </div>-->

<!--        &lt;!&ndash; 慢病控制 &ndash;&gt;-->
<!--        <div class="flex-1 summary-info-card p-4">-->
<!--          <div class="summary-title font-bold mb-3">慢病控制</div>-->
<!--          <div class="flex w-full items-center">-->
<!--            <div class="flex-1 bg-gray-200 rounded-full h-3 mr-3">-->
<!--              <div class="bg-[#9ACD32] h-3 rounded-full" style="width: 81%"></div>-->
<!--            </div>-->
<!--            <div class="text-[#2DA6A8] font-bold w-16 text-right">-->
<!--              <span class="text-[#9ACD32]">81</span>/100-->
<!--            </div>-->
<!--          </div>-->
<!--          <div class="text-sm text-gray-600 mt-2">-->
<!--            慢性疾病风险较低-->
<!--          </div>-->
<!--        </div>-->

<!--        &lt;!&ndash; 营养均衡 &ndash;&gt;-->
<!--        <div class="flex-1 summary-info-card p-4">-->
<!--          <div class="summary-title font-bold mb-3">营养均衡</div>-->
<!--          <div class="flex w-full items-center">-->
<!--            <div class="flex-1 bg-gray-200 rounded-full h-3 mr-3">-->
<!--              <div class="bg-[#9ACD32] h-3 rounded-full" style="width: 80%"></div>-->
<!--            </div>-->
<!--            <div class="text-[#2DA6A8] font-bold w-16 text-right">-->
<!--              <span class="text-[#9ACD32]">80</span>/100-->
<!--            </div>-->
<!--          </div>-->
<!--          <div class="text-sm text-gray-600 mt-2">-->
<!--            营养摄入基本均衡-->
<!--          </div>-->
<!--        </div>-->
<!--      </div>-->
<!--    </div>-->

<!--    <div class="flex gap-4">-->
<!--      &lt;!&ndash; 肠道年龄容器 (占7份) &ndash;&gt;-->
<!--      <div class="summary-info-card flex-[7]">-->
<!--        <div class="summary-title mb-10"><b>肠道年龄</b></div>-->
<!--        <div class="flex flex-col">-->
<!--          <div class="relative w-full">-->
<!--            &lt;!&ndash; 真实年龄部分 &ndash;&gt;-->
<!--            <div class="mb-9">-->
<!--              <div class="flex items-center">-->
<!--                <div class="text-gray-600 mr-4 w-20">实际年龄</div>-->
<!--                <div class="flex-1 relative">-->
<!--                  <div class="absolute -top-6 left-[30%] transform -translate-x-1/2 text-gray-500 font-bold text-lg">30岁</div>-->
<!--                  <div class="summary-age-bar bg-gray-200">-->
<!--                    <div class="summary-age-bar bg-blue-200" style="width: 30%"></div>-->
<!--                  </div>-->
<!--                </div>-->
<!--              </div>-->
<!--            </div>-->
<!--            &lt;!&ndash; 肠道年龄部分 &ndash;&gt;-->
<!--            <div>-->
<!--              <div class="flex items-center">-->
<!--                <div class="text-gray-600 mr-4 w-20">肠道年龄</div>-->
<!--                <div class="flex-1 relative">-->
<!--                  <div class="absolute -top-6 left-[54.7%] transform -translate-x-1/2 text-gray-500 font-bold text-lg">54.7岁</div>-->
<!--                  <div class="summary-age-bar bg-gray-200">-->
<!--                    <div class="summary-age-bar" style="width: 54.7%; background-color: rgb(45, 166, 168)"></div>-->
<!--                  </div>-->
<!--                </div>-->
<!--              </div>-->
<!--            </div>-->
<!--          </div>-->
<!--          <div class="summary-description mt-5">-->
<!--            当肠道菌群反映的年龄大幅偏离真实年龄时道常代表您的肠道菌群出现了紊乱，存在疾病风险或发育滞后-->
<!--          </div>-->
<!--        </div>-->
<!--      </div>-->

<!--      &lt;!&ndash; 肠型容器 (占3份) &ndash;&gt;-->
<!--      <div class="summary-info-card flex-[3]">-->
<!--        <div class="summary-title mb-3"><b>肠型</b></div>-->

<!--        <div class="flex flex-col gap-2">-->

<!--          &lt;!&ndash; 拟杆菌型 &ndash;&gt;-->
<!--          <div class="rounded-xl bg-white p-3">-->
<!--            <div class="flex justify-between items-start">-->
<!--              <div>-->
<!--                <span class="text-[10px] font-medium text-gray-400 block mb-0.5">类型 A</span>-->
<!--                <h2 class="text-base font-bold text-gray-500">拟杆菌型</h2>-->
<!--              </div>-->
<!--              <div class="w-6 h-6 rounded-lg bg-gray-100 flex items-center justify-center">-->
<!--                <svg class="w-3 h-3 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">-->
<!--                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>-->
<!--                </svg>-->
<!--              </div>-->
<!--            </div>-->
<!--          </div>-->

<!--          &lt;!&ndash; 普雷沃氏菌型（当前用户类型） &ndash;&gt;-->
<!--          <div class="rounded-xl p-3" style="background: #D0E7FF">-->
<!--            <div class="flex justify-between items-start">-->
<!--              <div>-->
<!--                <span class="text-[10px] font-medium text-blue-600 block mb-0.5">类型 B（您的类型）</span>-->
<!--                <h2 class="text-base font-bold text-gray-500">普雷沃氏菌型</h2>-->
<!--              </div>-->
<!--              <div class="w-6 h-6 rounded-lg bg-blue-600 bg-opacity-30 flex items-center justify-center">-->
<!--                <svg class="w-3 h-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">-->
<!--                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>-->
<!--                </svg>-->
<!--              </div>-->
<!--            </div>-->
<!--          </div>-->

<!--          &lt;!&ndash; 厚壁菌型 &ndash;&gt;-->
<!--          <div class="rounded-xl bg-white p-3">-->
<!--            <div class="flex justify-between items-start">-->
<!--              <div>-->
<!--                <span class="text-[10px] font-medium text-gray-400 block mb-0.5">类型 C</span>-->
<!--                <h2 class="text-base font-bold text-gray-500">厚壁菌型</h2>-->
<!--              </div>-->
<!--              <div class="w-6 h-6 rounded-lg bg-gray-100 flex items-center justify-center">-->
<!--                <svg class="w-3 h-3 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">-->
<!--                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M13 10V3L4 14h7v7l9-11h-7z"></path>-->
<!--                </svg>-->
<!--              </div>-->
<!--            </div>-->
<!--          </div>-->
<!--        </div>-->

<!--      </div>-->
<!--    </div>-->

    <div id="container" class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">
      <!-- 内容将通过JavaScript动态加载 -->
    </div>

    <script>
      // 根据健康总分动态改变颜色
      function getScoreColor(score) {
        const numScore = parseInt(score);
        if (numScore >= 85) {
          return {
            circle: '#7CB342', // 柔和的绿色
            text: '#558B2F'    // 深橄榄绿
          };
        } else if (numScore >= 75) {
          return {
            circle: '#9CCC65', // 淡青绿色
            text: '#689F38'    // 中青绿色
          };
        } else if (numScore >= 60) {
          return {
            circle: '#FFB74D', // 温和的橙色
            text: '#F57C00'    // 中橙色
          };
        } else if (numScore >= 40) {
          return {
            circle: '#FF8A65', // 柔和的珊瑚色
            text: '#E64A19'    // 深珊瑚色
          };
        } else {
          return {
            circle: '#EF5350', // 柔和的红色
            text: '#D32F2F'    // 深红色
          };
        }
      }

      function calculateAgeBarMetrics(actualAge, gutAge) {
        // 基础配置
        const minAge = 0;
        const maxAge = 120;
        const minWidth = 5; // 最小显示宽度百分比
        const youngAge = 7; // 年轻年龄的分界点
        const youngAgeScale = 0.3; // 0-7岁占总宽度的比例
        const remainingScale = 1 - youngAgeScale; // 剩余年龄占总宽度的比例

        // 计算函数
        function calculatePosition(age) {
          if (age <= youngAge) {
            // 0-7岁范围内的计算
            return (age / youngAge) * (youngAgeScale * 100);
          } else {
            // 7岁以上范围的计算
            const remainingAge = age - youngAge;
            const remainingMaxAge = maxAge - youngAge;
            return (youngAgeScale * 100) + ((remainingAge / remainingMaxAge) * (remainingScale * 100));
          }
        }

        // 计算实际年龄和肠道年龄的位置
        const actualAgePercent = calculatePosition(actualAge);
        const gutAgePercent = calculatePosition(gutAge);

        return {
          actualAge: {
            width: Math.max(minWidth, Math.min(actualAgePercent, 100)),
            position: Math.min(actualAgePercent, 100)
          },
          gutAge: {
            width: Math.max(minWidth, Math.min(gutAgePercent, 100)),
            position: Math.min(gutAgePercent, 100)
          }
        };
      }

      // 生成肠型卡片的辅助函数
      function generateGutTypeCards(currentType) {
        const gutTypes = [
          {
            type: "A",
            name: "拟杆菌型",
            icon: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>'
          },
          {
            type: "B",
            name: "普雷沃氏菌型",
            icon: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>'
          },
          {
            type: "C",
            name: "厚壁菌型",
            icon: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M13 10V3L4 14h7v7l9-11h-7z"></path>'
          }
        ];

        return gutTypes.map(gutType => {
          const isActive = gutType.name === currentType;
          return `
                    <div class="rounded-xl ${isActive ? 'bg-[#D0E7FF]' : 'bg-white'} p-3">
                        <div class="flex justify-between items-start">
                            <div>
                                <span class="text-[10px] font-medium ${isActive ? 'text-blue-600' : 'text-gray-400'} block mb-0.5">
                                    类型 ${gutType.type}${isActive ? '（您的类型）' : ''}
                                </span>
                                <h2 class="text-base font-bold text-gray-500">${gutType.name}</h2>
                            </div>
                            <div class="w-6 h-6 rounded-lg ${isActive ? 'bg-blue-600 bg-opacity-30' : 'bg-gray-100'} flex items-center justify-center">
                                <svg class="w-3 h-3 ${isActive ? 'text-white' : 'text-gray-500'}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    ${gutType.icon}
                                </svg>
                            </div>
                        </div>
                    </div>
                `;
        }).join('');
      }

      // 主渲染函数
      function renderSummary(data) {
        const d = data.general_summary;
        const container = document.getElementById('container');

        if (!d) return;

        // 获取健康总分的颜色
        const scoreColors = getScoreColor(d.summarized_health_index.overall_health_score.value);

        container.innerHTML = `
        <!-- 基本信息行 -->
        <div class="grid grid-cols-2 gap-4 mb-2">
            <!-- 左边三个 summary-info-card -->
            <div class="flex gap-2">
                ${d.sample_info.patient_name ? `
                <div class="summary-info-card" style="flex: 75;">
                    <div class="summary-title font-bold">姓名</div>
                    <div class="font-bold text-gray-500">${d.sample_info.patient_name}</div>
                </div>
                ` : ''}
                ${d.sample_info.sex ? `
                <div class="summary-info-card" style="flex: 75;">
                    <div class="summary-title font-bold">性别</div>
                    <div class="font-bold text-gray-500">${d.sample_info.sex}</div>
                </div>
                ` : ''}
                ${d.sample_info.age ? `
                <div class="summary-info-card" style="flex: 100;">
                    <div class="summary-title font-bold">年龄</div>
                    <div class="font-bold text-gray-500">${d.sample_info.age}</div>
                </div>
                ` : ''}
            </div>

            <!-- 右边两个 summary-info-card -->
            <div class="flex gap-2">
                ${d.sample_info.sample_id ? `
                <div class="summary-info-card flex-1">
                    <div class="summary-title font-bold">样本编号</div>
                    <div class="font-bold text-gray-500">${d.sample_info.sample_id}</div>
                </div>
                ` : ''}
                ${d.sample_info.report_date ? `
                <div class="summary-info-card flex-1">
                    <div class="summary-title font-bold">报告日期</div>
                    <div class="font-bold text-gray-500">${d.sample_info.report_date}</div>
                </div>
                ` : ''}
            </div>
        </div>

        <!-- 健康总分和指标框 -->
        <div class="grid grid-cols-2 gap-4 mb-2">
            ${d.summarized_health_index.overall_health_score.value ? `
            <div class="summary-info-card">
                <div class="summary-title mb-7"><b>健康总分</b></div>
                <div class="flex flex-col items-center">
                    <div class="w-40 h-40 mb-5">
                        <svg viewBox="0 0 100 100">
                            <circle class="summary-circle-bg" cx="50" cy="50" r="45"/>
                            <circle class="summary-circle"
                                    cx="50"
                                    cy="50"
                                    r="45"
                                    stroke="${scoreColors.circle}"
                                    stroke-dasharray="282.7"
                                    stroke-dashoffset="${282.7 - (282.7 * parseInt(d.summarized_health_index.overall_health_score.value) / 100)}"/>
                            <text x="50"
                                  y="45"
                                  class="summary-score-text"
                                  text-anchor="middle"
                                  dominant-baseline="middle"
                                  font-size="30"
                                  font-weight="bold"
                                  fill="${scoreColors.text}">${d.summarized_health_index.overall_health_score.value}</text>
                            <text x="50"
                                  y="68"
                                  class="summary-score-text"
                                  text-anchor="middle"
                                  font-size="10"
                                  fill="#2DA6A8">总分: 100</text>
                        </svg>
                    </div>
                    ${d.summarized_health_index.overall_health_score.analysis ? `
                    <div class="summary-description text-center">
                        ${d.summarized_health_index.overall_health_score.analysis}
                    </div>
                    ` : ''}
                </div>
            </div>
            ` : ''}

            <!-- 右侧指标栏 -->
            <div class="flex flex-col gap-2 h-full">
                <div class="flex-1 summary-info-card p-4">
                    <div class="summary-title font-bold mb-3">菌群健康</div>
                    <div class="flex w-full items-center">
                        <div class="flex-1 bg-gray-200 rounded-full h-3 mr-3">
                            <div class="bg-[#FFD700] h-3 rounded-full" style="width: 73%"></div>
                        </div>
                        <div class="text-[#2DA6A8] font-bold w-16 text-right">
                            <span class="text-[#FFD700]">73</span>/100
                        </div>
                    </div>
                    <div class="text-sm text-gray-600 mt-2">肠道菌群多样性良好</div>
                </div>

                <div class="flex-1 summary-info-card p-4">
                    <div class="summary-title font-bold mb-3">慢病控制</div>
                    <div class="flex w-full items-center">
                        <div class="flex-1 bg-gray-200 rounded-full h-3 mr-3">
                            <div class="bg-[#9ACD32] h-3 rounded-full" style="width: 81%"></div>
                        </div>
                        <div class="text-[#2DA6A8] font-bold w-16 text-right">
                            <span class="text-[#9ACD32]">81</span>/100
                        </div>
                    </div>
                    <div class="text-sm text-gray-600 mt-2">慢性疾病风险较低</div>
                </div>

                <div class="flex-1 summary-info-card p-4">
                    <div class="summary-title font-bold mb-3">营养均衡</div>
                    <div class="flex w-full items-center">
                        <div class="flex-1 bg-gray-200 rounded-full h-3 mr-3">
                            <div class="bg-[#9ACD32] h-3 rounded-full" style="width: 80%"></div>
                        </div>
                        <div class="text-[#2DA6A8] font-bold w-16 text-right">
                            <span class="text-[#9ACD32]">80</span>/100
                        </div>
                    </div>
                    <div class="text-sm text-gray-600 mt-2">营养摄入基本均衡</div>
                </div>
            </div>
        </div>

        <!-- 肠道年龄和肠型 -->
        <div class="flex gap-4">
            ${d.summarized_health_index.gut_age.value ? `
            <div class="summary-info-card flex-[7]">
    <div class="summary-title mb-10"><b>肠道年龄</b></div>
    <div class="flex flex-col">
        <div class="relative w-full">
            ${(() => {
          const ageMetrics = calculateAgeBarMetrics(
            parseInt(d.sample_info.age),
            parseInt(d.summarized_health_index.gut_age.value)
          );
          return `
    <div class="mb-9">
        <div class="flex items-center">
            <div class="text-gray-600 mr-4 w-20">实际年龄</div>
            <div class="flex-1 relative">
                <div class="absolute -top-6 left-[${ageMetrics.actualAge.position}%]">
                    <div class="text-gray-500 font-bold text-lg whitespace-nowrap"
                         style="
                            ${ageMetrics.actualAge.position >= 95 ? 'transform: translateX(-100%);' :
            ageMetrics.actualAge.position <= 5 ? 'transform: translateX(0);' :
              'transform: translateX(-50%);'}
                         ">
                        ${d.sample_info.age}
                    </div>
                </div>
                <div class="summary-age-bar bg-gray-200">
                    <div class="summary-age-bar bg-blue-200"
                         style="width: ${ageMetrics.actualAge.width}%"></div>
                </div>
            </div>
        </div>
    </div>
    <div>
        <div class="flex items-center">
            <div class="text-gray-600 mr-4 w-20">肠道年龄</div>
            <div class="flex-1 relative">
                <div class="absolute -top-6 left-[${ageMetrics.gutAge.position}%]">
                    <div class="transform -translate-x-1/2 text-gray-500 font-bold text-lg whitespace-nowrap"
                         style="
                            ${ageMetrics.gutAge.position >= 95 ? 'transform: translateX(-100%);' :
            ageMetrics.gutAge.position <= 5 ? 'transform: translateX(0);' :
              'transform: translateX(-50%);'}
                         ">
                        ${d.summarized_health_index.gut_age.value}
                    </div>
                </div>
                <div class="summary-age-bar bg-gray-200">
                    <div class="summary-age-bar"
                         style="width: ${ageMetrics.gutAge.width}%; background-color: rgb(45, 166, 168)"></div>
                </div>
            </div>
        </div>
    </div>
`;
        })()}
</div>
${d.summarized_health_index.gut_age.analysis ? `
<div class="summary-description mt-5">
    ${d.summarized_health_index.gut_age.analysis}
</div>
` : ''}
</div>
</div>
` : ''}

${d.summarized_health_index.gut_type.value ? `
<div class="summary-info-card flex-[3]">
    <div class="summary-title mb-3"><b>肠型</b></div>
    <div class="flex flex-col gap-2">
        ${generateGutTypeCards(d.summarized_health_index.gut_type.value)}
    </div>
</div>
` : ''}
</div>
`;
      }

      // 加载数据的异步函数
      async function loadData() {
        try {
          const response = await fetch(DATA_PATHS.DATA);
          const data = await response.json();
          renderSummary(data);
        } catch (error) {
          console.error('Error loading data:', error);
          document.getElementById('container').innerHTML = `
                    <div class="text-red-500 text-center p-4">
                        加载数据时发生错误，请稍后重试
                    </div>
                `;
        }
      }

      // 页面加载完成后自动加载数据
      document.addEventListener('DOMContentLoaded', () => {
        loadData();
      });

      // 错误处理函数
      function handleError(error) {
        console.error('Error:', error);
        document.getElementById('container').innerHTML = `
                <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert">
                    <strong class="font-bold">错误！</strong>
                    <span class="block sm:inline">加载数据时发生错误，请刷新页面重试。</span>
                </div>
            `;
      }

      // 数据格式化辅助函数
      function formatValue(value, type) {
        if (!value) return '';

        switch(type) {
          case 'percentage':
            return `${Math.round(value)}%`;
          case 'age':
            return `${value}岁`;
          case 'date':
            return new Date(value).toLocaleDateString('zh-CN');
          default:
            return value;
        }
      }

      // 防抖函数，用于优化窗口调整时的重新渲染
      function debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
          const later = () => {
            clearTimeout(timeout);
            func(...args);
          };
          clearTimeout(timeout);
          timeout = setTimeout(later, wait);
        };
      }

      // 窗口调整时重新渲染的处理函数
      const handleResize = debounce(() => {
        loadData();
      }, 250);

      // 添加窗口调整事件监听
      window.addEventListener('resize', handleResize);
    </script>

<!--    <div class="summary-info-card">-->
<!--      <div class="summary-title"><b>肠型</b></div>-->
<!--      <div class="flex gap-4 mt-4">-->
<!--        &lt;!&ndash; 拟杆菌型 &ndash;&gt;-->
<!--        <div class="w-1/3 rounded-2xl bg-white overflow-hidden">-->
<!--          <div class="p-3">-->
<!--            <div class="flex justify-between items-start mb-2">-->
<!--              <div>-->
<!--                <span class="text-[10px] font-medium text-gray-400 block mb-0.5">类型 A</span>-->
<!--                <h2 class="text-base font-bold text-gray-900">拟杆菌型</h2>-->
<!--              </div>-->
<!--              <div class="w-6 h-6 rounded-lg bg-gray-100 flex items-center justify-center">-->
<!--                <svg class="w-3 h-3 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">-->
<!--                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>-->
<!--                </svg>-->
<!--              </div>-->
<!--            </div>-->
<!--            <div class="space-y-2">-->
<!--              <p class="text-gray-600 text-xs leading-relaxed">擅长分解复杂的植物纤维，与植物性饮食密切相关。</p>-->
<!--              <div class="space-y-1.5">-->
<!--                <div class="flex items-center gap-2 p-1.5 rounded-lg bg-gray-50">-->
<!--                  <span class="text-gray-700 text-[11px]">善于消化膳食纤维</span>-->
<!--                </div>-->
<!--                <div class="flex items-center gap-2 p-1.5 rounded-lg bg-gray-50">-->
<!--                  <span class="text-gray-700 text-[11px]">有益于肠道健康</span>-->
<!--                </div>-->
<!--              </div>-->
<!--            </div>-->
<!--          </div>-->
<!--        </div>-->

<!--        &lt;!&ndash; 普雷沃氏菌型（当前用户类型） &ndash;&gt;-->
<!--        <div class="w-1/3 rounded-2xl overflow-hidden" style="background: #D0E7FF"> &lt;!&ndash; 浅蓝色背景 &ndash;&gt;-->
<!--          <div class="p-3">-->
<!--            <div class="flex justify-between items-start mb-2">-->
<!--              <div>-->
<!--                <span class="text-[10px] font-medium text-blue-600 block mb-0.5">类型 B（您的类型）</span> &lt;!&ndash; 浅蓝色 &ndash;&gt;-->
<!--                <h2 class="text-base font-bold text-gray-800">普雷沃氏菌型</h2> &lt;!&ndash; 深灰色 &ndash;&gt;-->
<!--              </div>-->
<!--              <div class="w-6 h-6 rounded-lg bg-blue-600 bg-opacity-30 flex items-center justify-center">-->
<!--                <svg class="w-3 h-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">-->
<!--                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>-->
<!--                </svg>-->
<!--              </div>-->
<!--            </div>-->
<!--            <div class="space-y-2">-->
<!--              <p class="text-blue-600 text-xs leading-relaxed"> &lt;!&ndash; 浅蓝色 &ndash;&gt;-->
<!--                以普雷沃氏菌为主导菌群，与高碳水化合物、高纤维的饮食方式相关。常见于偏好植物性食物的人群。-->
<!--              </p>-->
<!--              <div class="space-y-1.5">-->
<!--                <div class="flex items-center gap-2 p-1.5 rounded-lg bg-blue-600 bg-opacity-30">-->
<!--                  <span class="text-white text-[11px]">高碳水化合物代谢能力</span>-->
<!--                </div>-->
<!--                <div class="flex items-center gap-2 p-1.5 rounded-lg bg-blue-600 bg-opacity-30">-->
<!--                  <span class="text-white text-[11px]">适合植物性饮食</span>-->
<!--                </div>-->
<!--              </div>-->
<!--            </div>-->
<!--          </div>-->
<!--        </div>-->

<!--        &lt;!&ndash; 厚壁菌型 &ndash;&gt;-->
<!--        <div class="w-1/3 rounded-2xl bg-white overflow-hidden">-->
<!--          <div class="p-3">-->
<!--            <div class="flex justify-between items-start mb-2">-->
<!--              <div>-->
<!--                <span class="text-[10px] font-medium text-gray-400 block mb-0.5">类型 C</span>-->
<!--                <h2 class="text-base font-bold text-gray-900">厚壁菌型</h2>-->
<!--              </div>-->
<!--              <div class="w-6 h-6 rounded-lg bg-gray-100 flex items-center justify-center">-->
<!--                <svg class="w-3 h-3 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">-->
<!--                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M13 10V3L4 14h7v7l9-11h-7z"></path>-->
<!--                </svg>-->
<!--              </div>-->
<!--            </div>-->
<!--            <div class="space-y-2">-->
<!--              <p class="text-gray-600 text-xs leading-relaxed">以厚壁菌为主要菌群，对脂肪和蛋白质的代谢能力较强，常见于高蛋白饮食。</p>-->
<!--              <div class="space-y-1.5">-->
<!--                <div class="flex items-center gap-2 p-1.5 rounded-lg bg-gray-50">-->
<!--                  <span class="text-gray-700 text-[11px]">脂肪代谢能力强</span>-->
<!--                </div>-->
<!--                <div class="flex items-center gap-2 p-1.5 rounded-lg bg-gray-50">-->
<!--                  <span class="text-gray-700 text-[11px]">促进肠道健康</span>-->
<!--                </div>-->
<!--              </div>-->
<!--            </div>-->
<!--          </div>-->
<!--        </div>-->
<!--      </div>-->
<!--    </div>-->



  <!-- 宏基因组报告阅读指南 -->

<!--  <div class="pt-[5mm] page-break">-->
  <h1 class="custom-title-second-level page-break">报告阅读指南</h1>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">
    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            本宏基因组报告旨在提供对您肠道中微生物群落的全面分析与理解。以下是一些关于宏基因组的基本概念，技术解析和注意事项。
          </p>
        </div>
      </div>
    </div>

    <!-- 问答信息框 -->
    <div class="qa-box">
      <div class="flex items-start ml-2">
        <p class="text-lg font-bold text-lightpurple">
          <i class="fas fa-question-circle icon icon-purple"></i>
          什么是肠道菌群的宏基因组？和16S有什么区别？
        </p>
      </div>
      <div class="flex items-start ml-2 mt-2">
        <p class="answer-text">
          <i class="fas fa-comments icon icon-orange"></i>
          肠道菌群的宏基因组是指从肠道微生物群体中提取的所有微生物（如细菌、古菌、真菌和病毒等）的遗传物质（DNA）进行分析和研究的领域。宏基因组报告提供更为详尽和全面的微生物分析，可以揭示微生物的功能和相互作用，而16S rRNA报告则更侧重于分类学上的信息，适合用作微生物群落的初步分析。
        </p>
      </div>
    </div>

    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-exclamation-triangle" style="color: orange;"></i>
            <strong>特别注意：</strong>本报告采用高通量测序对肠道菌群进行宏基因组检测，然后使用大数据和人工智能技术对各项指标进行评估，以下是您在阅读报告时要注意的事项：
          </p>
          <ul class="list-disc ml-5">
            <li>
              <strong>结果的解读并非绝对</strong>：
              <ul class="list-disc ml-5">
                <li>报告中的数据和分析结果只是对您肠道菌群的一个快照，它们可能会受到多种因素的影响，如饮食、生活方式、地理环境等。因此，请保持对结果的审慎态度，不要将其视为绝对的健康指标。</li>
              </ul>
            </li>

            <li>
              <strong>个体差异</strong>：
              <ul class="list-disc ml-5">
                <li>肠道菌群的构成因人而异，个体差异可能会导致相同的微生物组成在不同人群中的健康影响截然不同。因此，报告中某些相关性的普遍性可能无法适用于每个人。</li>
              </ul>
            </li>

            <li>
              <strong>技术和方法的限制</strong>：
              <ul class="list-disc ml-5">
                <li>尽管高通量测序和人工智能技术能提供强大的分析能力，但这些技术也有局限性。例如，某些微生物可能在样本处理中丢失，或存在序列的拼接错误，这可能导致结果的不准确性或偏差。</li>
              </ul>
            </li>

            <li>
              <strong>功能预测的局限性</strong>：
              <ul class="list-disc ml-5">
                <li>报告中对微生物功能的预测基于已有数据库和算法，这些预测并不一定能准确反映微生物的实际生理功能。请谨慎对待这些预测，尤其是在临床决策时。</li>
              </ul>
            </li>

            <li>
              <strong>临床相关性并不确定</strong>：
              <ul class="list-disc ml-5">
                <li>报告可能会提到与某些健康状况的相关性，但关联并不等于因果关系。个别结果需结合您的整体健康状况和其他临床因素进行判断，而不是单一指标决定健康状况。</li>
              </ul>
            </li>

            <li>
              <strong>避免过度解读</strong>：
              <ul class="list-disc ml-5">
                <li>有些微小的变化可能并不具有临床意义。</li>
              </ul>
            </li>

            <li>
              <strong>跟踪研究的重要性</strong>：
              <ul class="list-disc ml-5">
                <li>肠道菌群是动态的，定期监测和跟踪会提供更好的健康状态评估。单次测试结果的意义有限，尤其是在没有长期数据对比的情况下。</li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </div>

  </div>

  <!-- 肠道整体评估板块 -->
  <h2 class="custom-title-second-level page-break">肠道整体评估</h2>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">
    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            本部分总结了您本次肠道菌群检测的整体关键指标，主要涵盖以下两个核心维度：
          </p>
          <ul class="list-disc ml-5">
            <li><strong>肠道基础功能：</strong> 评估肠道的基本生理功能，包括：
              <ul class="list-disc ml-5">
                <li>
                  蛋白质发酵能力：测定肠道中细菌对蛋白质的发酵和利用能力，反映肠道微生物的代谢功能。
                </li>
                <li>
                  消化吸收效率：评估肠道对营养物质的消化与吸收能力，影响整体营养状态。
                </li>
                <li>
                  肠道产气情况：监测肠道气体的生成量，过量气体可能提示消化不良或肠道菌群失衡。
                </li>
                <li>
                  肠道屏障完整性：评估肠道粘膜的健康状况，影响体内物质的吸收和免疫反应。
                </li>
                <li>
                  肠道炎症状态：评估肠道内的炎症反应，可能与各种消化系统疾病关联。
                </li>
              </ul>
            </li>
          </ul>
          <ul class="list-disc ml-5">
            <li><strong>肠道菌群整体：</strong> 评估肠道菌群的整体功能状态，包括：
              <ul class="list-disc ml-5">
                <li>
                  菌种数量：反映肠道中微生物菌种的多样性，多样性越高，通常代表健康的肠道环境。
                </li>
                <li>
                  菌群多样性：评估不同类型菌群的存在比例，有助于判断肠道生态平衡。
                </li>
                <li>
                  肠道菌群平衡：分析有益菌与有害菌的比例，维持平衡对健康至关重要。
                </li>
                <li>
                  菌群恢复力：衡量菌群在遭受外部干扰后恢复到正常状态的能力，表示肠道的抗压能力。
                </li>
                <li>
                  有益菌和有害菌的比例：评估有益菌（如乳酸菌）与有害菌（如病原菌）的相对数量，直接影响健康。
                </li>
                <li>
                  革兰氏阴性菌和好氧菌的分布：分析不同类别细菌的比例，帮助了解肠道生态及其对健康的影响。
                </li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </div>

    <div class="qa-box">
      <div class="flex items-start ml-2">
        <p class="text-lg font-bold text-lightpurple">
          <i class="fas fa-question-circle icon icon-purple"></i>
          理想且健康的肠道状态是怎样的？
        </p>
      </div>
      <div class="flex items-start ml-2 mt-2">
        <p class="answer-text">
          <i class="fas fa-comments icon icon-orange"></i>
          理想而健康的肠道不仅依赖于合理、丰富且平衡的菌群构成，还需要具备完善的基础功能。这些功能和菌群状态相辅相成，共同维系肠道的健康与稳定。
        </p>
      </div>
    </div>

  </div>


  <!-- 肠道整体评估 : 肠道基础功能评估 -->
  <h3 class="custom-title-third-level page-break">肠道基础功能评估</h3>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">

    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            下列各项评估了您的肠道的基础⽣理功能。
          </p>
        </div>
      </div>
    </div>

    <!-- 肠道基础功能表格 -->
    <div class="rounded-table">
      <table class="min-w-full">
        <thead>
        <tr style="background-color: #00B2B4; color: white;">
          <th class="py-2 px-4 text-left basic-function-of-gut-first-column"
              style="font-size: 13px;">
            肠道基础功能项目
          </th>
          <th class="py-2 px-4 text-center basic-function-of-gut-second-column"
              style="font-size: 13px; padding: 5px 5px;">
            参考范围
          </th>
          <th class="py-2 px-4 text-center basic-function-of-gut-third-column"
              style="font-size: 13px; padding: 5px 5px;">
            评估数值
          </th>
          <th class="py-2 px-4 text-center basic-function-of-gut-fourth-column"
              style="font-size: 13px; padding: 5px 5px;">
            结果评价
          </th>
        </tr>
        </thead>
      </table>

      <div id="basic-functions-of-gut-data-table-body">
        <!-- 数据将通过 JavaScript 动态插入 -->
      </div>
    </div>

    <script>
      async function loadBasicFunctionOfGutData() {
        try {
          const response = await fetch(DATA_PATHS.DATA);
          const data = await response.json();
          renderBasicFunctionOfGutTable(data.basic_function_of_gut_data);
        } catch (error) {
          console.error('Error loading basic function of gut data:', error);
        }
      }

      function calculateProgressPercentage(value, maxValue) {
        if (!value || !maxValue) return 0;
        // 使用 detected abundance 除以 normal range max 计算进度
        const percentage = (value / maxValue) * 100;
        return Math.min(100, Math.max(5, percentage));
      }

      function renderBasicFunctionOfGutTable(functionData) {
        const container = document.getElementById('basic-functions-of-gut-data-table-body');
        container.innerHTML = '';

        const CUSTOM_COLORS = {
          red: '#ff4d4f',
          green: '#389e0d',
          gray: '#808080'
        };

        functionData.forEach(item => {
          let statusColor, statusText, statusIcon;
          const value = item.evaluated_value;
          const minRange = item.normal_range.min_normal_value;
          const maxRange = item.normal_range.max_normal_value;

          let isNormal = true;

          if (value < minRange) {
            statusColor = 'red';
            statusText = '异常';
            statusIcon = '<i class="fas fa-arrow-down ml-1"></i>';
            isNormal = false;
          } else if (value > maxRange) {
            statusColor = 'red';
            statusText = '异常';
            statusIcon = '<i class="fas fa-arrow-up ml-1"></i>';
            isNormal = false;
          } else {
            statusColor = 'green';
            statusText = '正常';
            statusIcon = '';
          }

          const itemContainer = document.createElement('div');
          itemContainer.className = 'bacteria-info-container';

          const table = document.createElement('table');
          table.className = 'bacteria-table min-w-full';

          // 计算进度条百分比
          const progressPercentage = calculateProgressPercentage(value, maxRange);

          const dataRow = `
            <tr>
              <td class="py-2 px-4 text-left basic-function-of-gut-first-column">
                <div class="core-gut-bacteria-chinese-text"><strong>${item.chinese_name}</strong></div>
                <div class="core-gut-bacteria-latin-text">${item.english_name}</div>
              </td>
              <td class="py-2 px-4 text-center core-gut-bacteria-column-text basic-function-of-gut-second-column">
                ${minRange}-${maxRange}
              </td>
              <td class="py-2 px-4 text-center core-gut-bacteria-column-text basic-function-of-gut-third-column">
                <div class="flex items-center justify-center">
                  <span style="color: ${!isNormal ? CUSTOM_COLORS.red : '#000000'}">
                    ${value}
                  </span>
                </div>
                <div class="progress-bar w-full mt-1">
                  <div class="progress mt-2"
                       style="width: ${progressPercentage}%;
                              background-color: ${!isNormal ? CUSTOM_COLORS.red : CUSTOM_COLORS.green};
                              transition: width 0.3s ease;">
                  </div>
                </div>
              </td>
              <td class="py-2 px-4 text-center core-gut-bacteria-column-text basic-function-of-gut-fourth-column">
                <span style="color: ${CUSTOM_COLORS[statusColor]}">
                  <strong>${statusText}</strong>${statusIcon}
                </span>
              </td>
            </tr>
          `;

          const descRow = item.descriptions.length > 0 ? `
      <tr class="virus-desc-row">
        <td colspan="4" class="py-2 px-4 text-left">
          <div class="description-container text-gray-600" style="font-size: 10px;">
            ${item.descriptions.map(desc => `
              <div class="flex items-start">
                <div class="ml-1">
                  <p>
                    <i class="fas fa-${desc.type === 'info' ? 'info-circle' : 'bell'}"
                       style="color: ${desc.color};">
                    </i>
                    ${desc.text}
                  </p>
                </div>
              </div>
            `).join('')}
          </div>
        </td>
      </tr>
    ` : '';

          table.innerHTML = `<tbody>${dataRow}${descRow}</tbody>`;
          itemContainer.appendChild(table);
          container.appendChild(itemContainer);
        });
      }

      // 页面加载时调用
      document.addEventListener('DOMContentLoaded', loadBasicFunctionOfGutData);
    </script>

  </div>

  <!-- 肠道整体评估 : 肠道菌群整体评估 -->
  <h3 class="custom-title-third-level page-break">肠道菌群整体评估</h3>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">

    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            下列各项对您的肠道菌群进行了整体性评估。
          </p>
        </div>
      </div>
    </div>

    <!-- 肠道菌群整体评估表格 -->
    <div class="rounded-table">
      <table class="min-w-full">
        <thead>
        <tr style="background-color: #00B2B4; color: white;">
          <th class="py-2 px-4 text-left overall-evaluation-of-gut-first-column" style="font-size: 13px;">
            肠道菌群整体项目
          </th>
          <th class="py-2 px-4 text-center overall-evaluation-of-gut-second-column" style="font-size: 13px; padding: 5px 5px;">
            参考范围
          </th>
          <th class="py-2 px-4 text-center overall-evaluation-of-gut-third-column" style="font-size: 13px; padding: 5px 5px;">
            评估数值
          </th>
          <th class="py-2 px-4 text-center overall-evaluation-of-gut-fourth-column" style="font-size: 13px; padding: 5px 5px;">
            结果评价
          </th>
        </tr>
        </thead>
      </table>

      <div id="overall-evaluation-of-gut-microbiome-data-table-body">
        <!-- 数据将通过 JavaScript 动态插入 -->
      </div>
    </div>

    <script>
      async function loadEvaluationOfGutMicrobiomeData() {
        try {
          const response = await fetch(DATA_PATHS.DATA);
          const data = await response.json();
          renderEvaluationOfGutMicrobiomeTable(data.overall_evaluation_of_gut_microbiome_data);
        } catch (error) {
          console.error('Error loading overall evaluation of gut microbiome data:', error);
        }
      }

      function calculateProgressPercentage(value, maxValue) {
        if (!value || !maxValue) return 0;
        const percentage = (value / maxValue) * 100;
        return Math.min(100, Math.max(5, percentage));
      }

      function renderEvaluationOfGutMicrobiomeTable(microbiomeData) {
        const container = document.getElementById('overall-evaluation-of-gut-microbiome-data-table-body');
        if (!container) {
          console.error('Container element not found');
          return;
        }
        container.innerHTML = '';

        const CUSTOM_COLORS = {
          red: '#ff4d4f',
          green: '#389e0d',
          gray: '#808080'
        };

        microbiomeData.forEach(item => {
          let statusColor, statusText, statusIcon;
          const value = item.evaluated_value;
          const minRange = item.normal_range.min_normal_value;
          const maxRange = item.normal_range.max_normal_value;

          let isNormal = true;

          if (value < minRange) {
            statusColor = 'red';
            statusText = '异常';
            statusIcon = '<i class="fas fa-arrow-down ml-1"></i>';
            isNormal = false;
          } else if (value > maxRange) {
            statusColor = 'red';
            statusText = '异常';
            statusIcon = '<i class="fas fa-arrow-up ml-1"></i>';
            isNormal = false;
          } else {
            statusColor = 'green';
            statusText = '正常';
            statusIcon = '';
          }

          const itemContainer = document.createElement('div');
          itemContainer.className = 'bacteria-info-container';

          const table = document.createElement('table');
          table.className = 'bacteria-table min-w-full';

          const dataRow = `
      <tr>
        <td class="py-2 px-4 text-left overall-evaluation-of-gut-first-column">
          <div class="core-gut-bacteria-chinese-text"><strong>${item.chinese_name}</strong></div>
          <div class="core-gut-bacteria-latin-text">${item.english_name}</div>
        </td>
        <td class="py-2 px-4 text-center core-gut-bacteria-column-text overall-evaluation-of-gut-second-column">
          ${minRange}-${maxRange}
        </td>
        <td class="py-2 px-4 text-center core-gut-bacteria-column-text overall-evaluation-of-gut-third-column">
          <div class="flex items-center justify-center">
            <span style="color: ${!isNormal ? CUSTOM_COLORS.red : '#000000'}">
              ${value}
            </span>
          </div>
          <div class="progress-bar w-full mt-1">
            <div class="progress mt-2"
                 style="width: ${calculateProgressPercentage(value, maxRange)}%;
                        background-color: ${!isNormal ? CUSTOM_COLORS.red : CUSTOM_COLORS.green};
                        transition: width 0.3s ease;">
            </div>
          </div>
        </td>
        <td class="py-2 px-4 text-center core-gut-bacteria-column-text overall-evaluation-of-gut-fourth-column">
          <span style="color: ${CUSTOM_COLORS[statusColor]}">
            <strong>${statusText}</strong>${statusIcon}
          </span>
        </td>
      </tr>
    `;

          const descRow = item.descriptions && item.descriptions.length > 0 ? `
      <tr class="virus-desc-row">
        <td colspan="4" class="py-2 px-4 text-left">
          <div class="description-container text-gray-600" style="font-size: 10px;">
            ${item.descriptions.map(desc => `
              <div class="flex items-start">
                <div class="ml-1">
                  <p>
                    <i class="fas fa-${desc.type === 'info' ? 'info-circle' : 'bell'}"
                       style="color: ${desc.color};">
                    </i>
                    ${desc.text}
                  </p>
                </div>
              </div>
            `).join('')}
          </div>
        </td>
      </tr>
    ` : '';

          table.innerHTML = `<tbody>${dataRow}${descRow}</tbody>`;
          itemContainer.appendChild(table);
          container.appendChild(itemContainer);
        });
      }

      // 页面加载时调用
      document.addEventListener('DOMContentLoaded', loadEvaluationOfGutMicrobiomeData);
    </script>

  </div>

  <!-- 肠道菌群检测模块 -->
  <h1 class="custom-title-first-level page-break">肠道菌群检测</h1>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">

    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-1.5">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            肠道菌群可以大分类成细菌，病毒，真菌，原生生物和寄生虫 5 个类别，下列是各项组成部分的介绍及他们在您肠道中的分布比例图。
          </p>
        </div>
      </div>
    </div>

    <!-- 肠道菌群组成比例信息图   -->
    <div class="container mx-auto space-y-2">
      <!-- 细菌 -->
      <div class="flex gap-3">
        <!-- 左侧标题 -->
        <div class="w-2/6 flex items-center justify-center bg-blue-100 rounded-md">
          <span class="text-blue-500 text-2xl font-bold">细菌</span>
        </div>
        <!-- 右侧内容 -->
        <div class="w-4/6">
          <div class="flex items-center gap-4 mb-3">
            <div class="flex-1 overall-progress-container">
              <div class="overall-progress-bar bg-blue-500" style="width: 90%"></div>
            </div>
            <div class="w-20 flex justify-center">
              <span class="text-blue-500 text-3xl font-bold">90%</span>
            </div>
          </div>
          <div class="bg-blue-50 rounded-md p-4">
            <p class="text-gray-600 text-sm">肠道细菌是肠道菌群中最主要的组成部分，在消化、代谢、合成维生素和调节免疫系统方面发挥着重要作用。健康的肠道菌群通常表现出良好的多样性，包含厚壁菌门、拟杆菌门等细菌。</p>
          </div>
        </div>
      </div>

      <!-- 病毒 -->
      <div class="flex gap-6">
        <div class="w-2/6 flex items-center justify-center bg-green-100 rounded-md">
          <span class="text-green-500 text-2xl font-bold">病毒</span>
        </div>
        <div class="w-4/6">
          <div class="flex items-center gap-4 mb-3">
            <div class="flex-1 overall-progress-container">
              <div class="overall-progress-bar bg-green-500" style="width: 5%"></div>
            </div>
            <div class="w-20 flex justify-center">
              <span class="text-green-500 text-3xl font-bold">5%</span>
            </div>
          </div>
          <div class="bg-green-50 rounded-md p-4">
            <p class="text-gray-600 text-sm">病毒，尤其是噬菌体，在调节细菌的种类和数量方面扮演重要角色。它们既可以抑制有害细菌的生长，也可以推动微生物群落的多样性。</p>
          </div>
        </div>
      </div>

      <!-- 真菌 -->
      <div class="flex gap-6">
        <div class="w-2/6 flex items-center justify-center bg-purple-100 rounded-md">
          <span class="text-purple-500 text-2xl font-bold">真菌</span>
        </div>
        <div class="w-4/6">
          <div class="flex items-center gap-4 mb-3">
            <div class="flex-1 overall-progress-container">
              <div class="overall-progress-bar bg-purple-500" style="width: 3%"></div>
            </div>
            <div class="w-20 flex justify-center">
              <span class="text-purple-500 text-3xl font-bold">3%</span>
            </div>
          </div>
          <div class="bg-purple-50 rounded-md p-4">
            <p class="text-gray-600 text-sm">主要包括酵母菌（如白色念珠菌），在数量较少时是正常的一部分，但当免疫系统受损时，可能会因其快速繁殖而导致感染或其它问题。</p>
          </div>
        </div>
      </div>

      <!-- 原生生物 -->
      <div class="flex gap-6">
        <div class="w-2/6 flex items-center justify-center bg-amber-100 rounded-md">
          <span class="text-amber-500 text-2xl font-bold">原生生物</span>
        </div>
        <div class="w-4/6">
          <div class="flex items-center gap-4 mb-3">
            <div class="flex-1 overall-progress-container">
              <div class="overall-progress-bar bg-amber-500" style="width: 1%"></div>
            </div>
            <div class="w-20 flex justify-center">
              <span class="text-amber-500 text-3xl font-bold">1%</span>
            </div>
          </div>
          <div class="bg-amber-50 rounded-md p-4">
            <p class="text-gray-600 text-sm">数量较少，但原生生物如变形虫和细胞虫有时会影响肠道环境，参与营养循环和分解。</p>
          </div>
        </div>
      </div>

      <!-- 寄生虫 -->
      <div class="flex gap-6">
        <div class="w-2/6 flex items-center justify-center bg-red-100 rounded-md">
          <span class="text-red-500 text-2xl font-bold">寄生虫</span>
        </div>
        <div class="w-4/6">
          <div class="flex items-center gap-4 mb-3">
            <div class="flex-1 overall-progress-container">
              <div class="overall-progress-bar bg-red-500" style="width: 1%"></div>
            </div>
            <div class="w-20 flex justify-center">
              <span class="text-red-500 text-3xl font-bold">1%</span>
            </div>
          </div>
          <div class="bg-red-50 rounded-md p-4">
            <p class="text-gray-600 text-sm">常见的肠道寄生虫如蛔虫和鞭虫，虽然数量较少，但在某些情况下可能导致消化不良和腹痛等健康问题。</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 肠道细菌板块 -->
  <h2 class="custom-title-second-level page-break">肠道细菌</h2>
  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;"></div>

    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-1.5">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            肠道微生物主要由肠道细菌组成，人体肠道中存在数千种细菌，总数量可达数十万亿个。健康成年人的肠道细菌主要分为厚壁菌门（Firmicutes）、拟杆菌门（Bacteroidetes）、放线菌门（Actinobacteria）和变形菌门（Proteobacteria），其中厚壁菌门和拟杆菌门占据了90%以上的比例。评估肠道菌群时，我们可以从丰度和菌群特性两个维度入手，这两者的结合有助于深入理解不同菌属在肠道微生态中的重要性和分布特征。
          </p>
        </div>
      </div>
    </div>

    <!-- 肠道细菌分类信息图总容器-->
    <div class="gut-bacteria-container">
      <div class="gut-bacteria-title">肠道菌群细菌分类体系</div>
      <div class="gut-bacteria-content">
        <!-- 左侧分类卡片 -->
        <div class="left">
          <div class="gut-bacteria-sub-title">按菌群丰度分</div>

          <div class="gut-bacteria-card core">
            <div>核心菌属</div>
            <p style="color: #555555;">在绝大多数健康人群肠道中普遍存在的优势菌属，包括厚壁菌属、拟杆菌属等，占据总菌群的主要组成部分。</p>
          </div>

          <div class="gut-bacteria-card non-core">
            <div class="card-title">非核心重要菌属</div>
            <p style="color: #555555;">虽然丰度相对较低，但对维持肠道健康具有重要作用的菌属，如乳酸菌属、双歧杆菌属等。</p>
          </div>

        </div>
        <!-- 右侧分类卡片 -->
        <div class="right">
          <div class="gut-bacteria-sub-title">按菌群特性分</div>
          <div class="gut-bacteria-card beneficial">
            <div class="card-title">有益菌</div>
            <p style="color: #555555;">对人体健康有益的菌群，如双歧杆菌、乳酸菌等。它们参与营养物质的消化吸收，产生维生素，增强免疫力。</p>
          </div>
          <div class="gut-bacteria-card harmful">
            <div class="card-title">有害菌</div>
            <p style="color: #555555;">有害菌通常是指那些在肠道中可能对宿主产生负面影响的细菌，这些细菌可能会干扰肠道平衡，导致消化问题，或促进肠道炎症。</p>
          </div>
          <div class="gut-bacteria-card opportunistic">
            <div class="card-title">机会致病菌</div>
            <p style="color: #555555;">通常情况下与人体和平共处，但在特定条件下（如免疫力下降时）可能导致疾病的菌群。</p>
          </div>
          <div class="gut-bacteria-card pathogenic">
            <div class="card-title">致病菌</div>
            <p style="color: #555555;">能够直接导致疾病的有害菌群，它们会破坏肠道环境，引起感染和炎症等症状。</p>
          </div>
        </div>

      </div>
    </div>

  <!-- 核心菌属板块 -->
  <h3 class="custom-title-third-level page-break">核心菌属</h3>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">

    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            <strong>核心菌属</strong>是指在肠道菌群中相对丰度较高、对生理功能具有重要作用的优势菌群。它们在维持肠道健康、参与营养物质代谢和调节免疫系统等方面发挥着主导作用，构成了肠道微生态系统的基石。主要的核心菌属包括拟杆菌属（Bacteroides）、普雷沃氏菌属（Prevotella）和瘤胃球菌属（Ruminococcus）等。在正常情况下，这些菌群能帮助消化纤维、产生短链脂肪酸，维持肠道屏障功能。
            此外，核心肠道菌属还在合成维生素、促进矿物质吸收和抑制病原菌生长中发挥重要作用。它们通过与肠道内的免疫系统相互作用，增强机体的免疫反应，抵御外界的病原体侵袭。因此，保持核心菌属的平衡与多样性是维护肠道健康的关键。对于饮食和生活方式的调整，能够有效影响这些核心菌属的构成，从而促进整体健康。
          </p>
          <ul class="list-disc ml-5">
            <li class="font-bold text-[rgb(0,178,180)]">在本报告中，核心菌属指的是在90%人群中可被检测出，且人群平均丰度在1%以上的菌属。</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- 核心菌属表格 -->
    <div class="rounded-table">
      <!-- 主表格只包含标题 -->
      <table class="min-w-full">
        <thead>
        <tr style="background-color: #00B2B4; color: white;">
          <th
            class="py-2 px-4 text-left core-gut-bacteria-first-column"
            style="font-size: 13px;"
          >
            核心菌名称
          </th>
          <th
            class="py-2 px-4 text-center core-gut-bacteria-second-column"
            style="font-size: 13px; padding: 5px 5px;"
          >
            检测丰度%
          </th>
          <th
            class="py-2 px-4 text-center core-gut-bacteria-third-column"
            style="font-size: 13px; padding: 5px 5px;"
          >
            参考范围%
          </th>
          <th
            class="py-2 px-4 text-center core-gut-bacteria-fourth-column"
            style="font-size: 13px; padding: 5px 5px;"
          >
            有%的正常人检出
          </th>
        </tr>
        </thead>
      </table>

      <!-- 数据表格容器 -->
      <div id="core-gut-bacteria-table-body">
        <!-- 数据将通过 JavaScript 动态插入 -->
      </div>

    </div>

    <!-- Javascript code -->
    <script>
      // 常量定义
      const CORE_BACTERIA_CONSTANTS = {
        COLORS: {
          RED: '#ff4d4f',
          GREEN: '#389e0d',
          GRAY: '#808080',
          PRIMARY: '#00B2B4',
          WARNING: '#FFA500',
          BLACK: '#000000'
        }
      };

      // 读取数据
      async function loadCoreBacteriaData() {
        try {
          const response = await fetch(DATA_PATHS.DATA);
          if (!response.ok) {
            throw new Error(`Network response error: ${response.status}`);
          }
          const data = await response.json();
          renderCoreBacteriaTable(data["核心菌属"] || []);
        } catch (error) {
          console.error('Error loading core bacteria data:', error);
          document.getElementById('core-gut-bacteria-table-body').innerHTML =
            '<div class="error-message">数据加载失败，请稍后再试</div>';
        }
      }

      // 格式化数字 - 保留2位有效数字
      function formatCoreBacteriaNumber(value) {
        // 处理特殊值"ND"
        if (typeof value === "string" && value === "ND") return value;

        // 确保转换为数字类型
        const num = Number(value);

        // 保留2位有效数字
        return num.toPrecision(2);
      }

      // 从名称中提取中文名和拉丁名
      function extractNameParts(fullName) {
        if (!fullName) return { chinese: '', latin: '' };

        const parts = fullName.split(' ');

        // 单个词的情况
        if (parts.length === 1) {
          const singlePart = parts[0];
          // 检查是否为拉丁文/英文（非中文）
          if (!/[\u4e00-\u9fa5]/.test(singlePart)) {
            return { chinese: singlePart, latin: singlePart };
          } else {
            return { chinese: singlePart, latin: '' };
          }
        }

        // 多个词的情况
        if (/[\u4e00-\u9fa5]/.test(parts[0])) {
          return {
            chinese: parts[0],
            latin: parts.slice(1).join(' ')
          };
        } else {
          return {
            chinese: parts[0],
            latin: parts[0]
          };
        }
      }

      // 解析正常范围
      function parseNormalRange(rangeStr) {
        if (!rangeStr || typeof rangeStr !== 'string') {
          return { min: 0, max: 0 };
        }

        const parts = rangeStr.split('-');
        return {
          min: parseFloat(parts[0] || 0),
          max: parseFloat(parts[1] || 0)
        };
      }

      // 获取状态信息
      function getCoreBacteriaStatus(detected, normalRange) {
        const { min, max } = normalRange;

        // 默认为正常状态
        let status = {
          color: CORE_BACTERIA_CONSTANTS.COLORS.BLACK, // 正常为黑色文字
          text: '正常',
          icon: '',
          isNormal: true
        };

        // 未检出的情况
        if (detected === "ND") {
          if (min > 0) {
            // 未检出但参考范围最小值大于0，视为偏低
            status.color = CORE_BACTERIA_CONSTANTS.COLORS.RED;
            status.text = '偏低';
            status.icon = '<i class="fas fa-arrow-down ml-1" style="color: ' + CORE_BACTERIA_CONSTANTS.COLORS.RED + ';"></i>';
            status.isNormal = false;
          }
          return status;
        }

        // 数值型检测值
        const detectedNum = parseFloat(detected);

        // 低于参考范围
        if (detectedNum < min) {
          status.color = CORE_BACTERIA_CONSTANTS.COLORS.RED;
          status.text = '偏低';
          status.icon = '<i class="fas fa-arrow-down ml-1" style="color: ' + CORE_BACTERIA_CONSTANTS.COLORS.RED + ';"></i>';
          status.isNormal = false;
        }
        // 高于参考范围
        else if (detectedNum > max) {
          status.color = CORE_BACTERIA_CONSTANTS.COLORS.RED;
          status.text = '超标';
          status.icon = '<i class="fas fa-arrow-up ml-1" style="color: ' + CORE_BACTERIA_CONSTANTS.COLORS.RED + ';"></i>';
          status.isNormal = false;
        }
        // 正常范围内，默认状态，无需修改

        return status;
      }

      // 创建描述行
      function createCoreBacteriaDescriptionRow(bacteria, status) {
        let descriptionContent = '';

        // 首先添加常规简介
        if (bacteria["说明"] && bacteria["说明"].trim()) {
          descriptionContent += `
          <div class="flex items-start mb-0">
            <div class="ml-1">
              <p>
                <i class="fas fa-info-circle" style="color: ${CORE_BACTERIA_CONSTANTS.COLORS.PRIMARY};"></i>
                ${bacteria["说明"]}
              </p>
            </div>
          </div>
        `;
        }

        // 如果状态不是正常，根据状态添加相应的改善建议
        if (!status.isNormal && bacteria["改善方式"] && bacteria["改善方式"].trim()) {
          descriptionContent += `
          <div class="flex items-start mt-0">
            <div class="ml-1">
              <p>
                <i class="fas fa-bell" style="color: ${CORE_BACTERIA_CONSTANTS.COLORS.WARNING};"></i>
                <strong>改善建议：</strong> ${bacteria["改善方式"]}
              </p>
            </div>
          </div>
        `;
        }

        // 如果有内容需要显示，返回完整的行
        if (descriptionContent.trim()) {
          return `
          <tr class="virus-desc-row">
            <td colspan="5" class="py-2 px-4 text-left">
              <div class="description-container text-gray-600" style="font-size: 11px;">
                ${descriptionContent}
              </div>
            </td>
          </tr>
        `;
        }

        // 如果没有描述内容，返回空字符串
        return '';
      }

      // 计算进度条百分比
      function calculateProgressPercentage(value) {
        if (value === "ND" || value === 0) {
          return 0;
        }

        const num = Number(value);

        // 使用与非核心菌属相同的进度条计算方式
        return Math.min(100, Math.max(5,
          num <= 1 ? num * 30 :
            num <= 10 ? 30 + (num - 1) * 5 :
              75 + (Math.min(num, 100) - 10) * 0.25
        ));
      }

      function renderCoreBacteriaTable(bacteriaData) {
        const container = document.getElementById('core-gut-bacteria-table-body');
        if (!container) {
          console.error('Cannot find container element');
          return;
        }

        container.innerHTML = '';

        // 如果没有数据
        if (!bacteriaData || !Array.isArray(bacteriaData) || bacteriaData.length === 0) {
          container.innerHTML = '<div class="no-data-message">暂无数据</div>';
          return;
        }

        // 使用DocumentFragment批量处理DOM操作
        const fragment = document.createDocumentFragment();

        bacteriaData.forEach(bacteria => {
          if (!bacteria) return;

          // 解析数据
          const detected = bacteria["丰度%"];
          const normalRange = parseNormalRange(bacteria["正常范围"]);
          const detectionRate = bacteria["%正常人有检出"] || "0%";
          const excessMultiple = bacteria["超标倍数"] || "0";

          // 解析名称
          const { chinese, latin } = extractNameParts(bacteria["名称"]);

          // 格式化数据
          const formattedDetectedValue = detected === "ND" ? detected : formatCoreBacteriaNumber(detected);
          const formattedMinRange = formatCoreBacteriaNumber(normalRange.min);
          const formattedMaxRange = formatCoreBacteriaNumber(normalRange.max);

          // 获取状态
          const status = getCoreBacteriaStatus(detected, normalRange);

          // 计算进度条百分比
          const progressPercentage = calculateProgressPercentage(detected === "ND" ? 0 : detected);

          // 创建菌属容器
          const bacteriaContainer = document.createElement('div');
          bacteriaContainer.className = 'bacteria-info-container';

          const table = document.createElement('table');
          table.className = 'bacteria-table min-w-full';

          // 生成数据行
          const dataRow = `
          <tr>
            <td class="py-2 pl-4 pr-2 text-left core-gut-bacteria-first-column">
              <div class="core-gut-bacteria-chinese-text"><strong>${chinese}</strong></div>
              <div class="core-gut-bacteria-latin-text">${latin}</div>
            </td>
            <td class="py-2 px-4 text-center core-gut-bacteria-column-text core-gut-bacteria-second-column">
              <div class="flex items-center justify-center">
                <span style="color: ${status.color}">
                  <strong>${detected === "ND" ? "未检出" : formattedDetectedValue}
                  ${status.icon}</strong>
                </span>
              </div>
              <div class="progress-bar w-full mt-2" style="background-color: #e9ecef; height: 8px; border-radius: 4px; overflow: hidden;">
                <div class="progress"
                     style="width: ${progressPercentage}%;
                            height: 100%;
                            background-color: ${status.isNormal ? CORE_BACTERIA_CONSTANTS.COLORS.PRIMARY : CORE_BACTERIA_CONSTANTS.COLORS.RED};
                            transition: width 0.3s ease;">
                </div>
              </div>
            </td>
            <td class="py-2 px-4 text-center core-gut-bacteria-column-text core-gut-bacteria-third-column">
              ${formattedMinRange}-${formattedMaxRange}
            </td>
            <td class="py-2 px-4 text-center core-gut-bacteria-column-text core-gut-bacteria-fourth-column">
              ${detectionRate}
            </td>
          </tr>
        `;

          // 生成描述行
          const descRow = createCoreBacteriaDescriptionRow(bacteria, status);

          table.innerHTML = `<tbody>${dataRow}${descRow}</tbody>`;
          bacteriaContainer.appendChild(table);
          fragment.appendChild(bacteriaContainer);
        });

        // 一次性添加所有元素到DOM
        container.appendChild(fragment);
      }

      // 页面加载时调用
      document.addEventListener('DOMContentLoaded', loadCoreBacteriaData);
    </script>
  </div>

  <!-- 其他非核心菌属板块 -->
  <h3 class="custom-title-third-level page-break">其他非核心菌属</h3>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">
    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            其他非核心重要菌属指的是在人群中丰度不高，但对肠道健康有重要影响的菌属。
          </p>
        </div>
      </div>
    </div>

    <!-- 其他重要菌属表格 -->
    <div class="rounded-table">
      <!-- 主表格只包含标题 -->
      <table class="min-w-full">
        <thead>
        <tr style="background-color: #00B2B4; color: white;">
          <th class="py-2 px-4 text-left beneficial-gut-bacteria-first-column" style="font-size: 13px;">
            其他重要菌属名称
          </th>
          <th class="py-2 px-4 text-center beneficial-gut-bacteria-second-column" style="font-size: 13px; padding: 5px 5px;">
            检测丰度%
          </th>
          <th class="py-2 px-4 text-center beneficial-gut-bacteria-third-column" style="font-size: 13px; padding: 5px 5px;">
            参考范围%
          </th>
        </tr>
        </thead>
      </table>

      <!-- 数据表格容器 -->
      <div id="other-important-bacteria-table-body">
        <!-- 数据将通过 JavaScript 动态插入 -->
      </div>
    </div>

    <script>
      // 常量定义
      const OTHER_IMPORTANT_CONSTANTS = {
        COLORS: {
          RED: '#ff4d4f',
          GREEN: '#389e0d',
          GRAY: '#808080',
          PRIMARY: '#00B2B4',  // rgb(0, 178, 180) 的十六进制表示
          WARNING: '#FF0000',  // rgb(255, 0, 0) 的十六进制表示
          BLACK: '#000000'
        }
      };

      // 加载数据
      async function loadOtherImportantBacteriaData() {
        try {
          const response = await fetch(DATA_PATHS.DATA);
          if (!response.ok) {
            throw new Error(`Network response error: ${response.status}`);
          }
          const data = await response.json();
          renderOtherImportantBacteriaTable(data["其他重要菌属"] || []);
        } catch (error) {
          console.error('Error loading other important bacteria data:', error);
          document.getElementById('other-important-bacteria-table-body').innerHTML =
            '<div class="error-message">数据加载失败，请稍后再试</div>';
        }
      }

      // 格式化数字 - 保留2位有效数字
      function formatOtherImportantNumber(value) {
        // 处理特殊值"ND"
        if (value === "ND") return value;

        // 确保转换为数字类型
        const num = Number(value);

        // 保留2位有效数字
        return num.toPrecision(2);
      }

      // 获取状态信息
      function getOtherImportantBacteriaStatus(detected, minRange, maxRange) {
        // 默认为正常状态
        let status = {
          color: OTHER_IMPORTANT_CONSTANTS.COLORS.BLACK, // 正常为黑色文字
          text: '正常',
          icon: '',
          isNormal: true
        };

        // 未检出的情况
        if (detected === "ND") {
          if (minRange > 0) {
            // 未检出但参考范围最小值大于0，视为偏低
            status.color = OTHER_IMPORTANT_CONSTANTS.COLORS.RED;
            status.text = '偏低';
            status.icon = '<i class="fas fa-arrow-down ml-1" style="color: ' + OTHER_IMPORTANT_CONSTANTS.COLORS.RED + ';"></i>';
            status.isNormal = false;
          }
          return status;
        }

        // 低于参考范围
        if (detected < minRange) {
          status.color = OTHER_IMPORTANT_CONSTANTS.COLORS.RED;
          status.text = '偏低';
          status.icon = '<i class="fas fa-arrow-down ml-1" style="color: ' + OTHER_IMPORTANT_CONSTANTS.COLORS.RED + ';"></i>';
          status.isNormal = false;
        }
        // 高于参考范围
        else if (detected > maxRange) {
          status.color = OTHER_IMPORTANT_CONSTANTS.COLORS.RED;
          status.text = '超标';
          status.icon = '<i class="fas fa-arrow-up ml-1" style="color: ' + OTHER_IMPORTANT_CONSTANTS.COLORS.RED + ';"></i>';
          status.isNormal = false;
        }
        // 正常范围内，默认状态，无需修改

        return status;
      }

      // 创建描述行
      function createOtherImportantDescriptionRow(bacteria, status) {
        let descriptionContent = '';

        // 首先添加常规简介
        if (bacteria["说明"] && bacteria["说明"].trim()) {
          descriptionContent += `
        <div class="flex items-start mb-0">
          <div class="ml-1">
            <p>
              <i class="fas fa-info-circle" style="color: ${OTHER_IMPORTANT_CONSTANTS.COLORS.PRIMARY};"></i>
              ${bacteria["说明"]}
            </p>
          </div>
        </div>
      `;
        }

        // 如果状态不是正常，根据状态添加相应的改善建议
        if (!status.isNormal) {
          if (status.text === '超标' && bacteria["改善方式"] && bacteria["改善方式"].trim()) {
            descriptionContent += `
          <div class="flex items-start mt-0">
            <div class="ml-1">
              <p>
                <i class="fas fa-bell" style="color: #FFA500;"></i>
                <strong>改善建议：</strong> ${bacteria["改善方式"]}
              </p>
            </div>
          </div>
        `;
          } else if (status.text === '偏低' && bacteria["改善方式"] && bacteria["改善方式"].trim()) {
            descriptionContent += `
          <div class="flex items-start mt-0">
            <div class="ml-1">
              <p>
                <i class="fas fa-bell" style="color: #FFA500;"></i>
                <strong>改善建议：</strong> ${bacteria["改善方式"]}
              </p>
            </div>
          </div>
        `;
          }
        }

        // 如果有内容需要显示，返回完整的行
        if (descriptionContent.trim()) {
          return `
        <tr class="virus-desc-row">
          <td colspan="3" class="py-2 px-4 text-left">
            <div class="description-container text-gray-600" style="font-size: 11px;">
              ${descriptionContent}
            </div>
          </td>
        </tr>
      `;
        }

        // 如果没有描述内容，返回空字符串
        return '';
      }

      // 创建表格行
      function createOtherImportantBacteriaRow(bacteria) {
        // 解析数据，添加安全检查
        const detected = bacteria["丰度%"] === "ND" ? "ND" : parseFloat(bacteria["丰度%"]) || 0;

        // 安全解析范围值
        let minRange = 0, maxRange = 0;
        if (bacteria["正常范围"] && typeof bacteria["正常范围"] === 'string') {
          const rangeParts = bacteria["正常范围"].split("-");
          minRange = parseFloat(rangeParts[0] || 0);
          maxRange = parseFloat(rangeParts[1] || 0);
        }

        // 格式化数据 - 保留2位有效数字
        const formattedDetectedValue = formatOtherImportantNumber(detected);
        const formattedMinRange = formatOtherImportantNumber(minRange);
        const formattedMaxRange = formatOtherImportantNumber(maxRange);

        // 获取状态
        const status = getOtherImportantBacteriaStatus(detected, minRange, maxRange);

        // 创建行元素
        const bacteriaContainer = document.createElement('div');
        bacteriaContainer.className = 'bacteria-info-container';

        const table = document.createElement('table');
        table.className = 'bacteria-table min-w-full';

        // 计算进度条百分比 - 对数缩放
        const progressPercentage = detected === "ND" ? 0 :
          Math.min(100, Math.max(5,
            detected <= 1 ? detected * 30 :
              detected <= 10 ? 30 + (detected - 1) * 5 :
                75 + (Math.min(detected, 100) - 10) * 0.25
          ));

        // 生成显示值的行
        const dataRow = `
      <tr>
        <td class="py-2 pl-4 pr-2 text-left beneficial-gut-bacteria-first-column">
          <div class="beneficial-gut-bacteria-chinese-text"><strong>${bacteria["名称"].split(" ")[0] || ''}</strong></div>
          <div class="beneficial-gut-bacteria-latin-text">${/^[a-zA-Z]+$/.test(bacteria["名称"].split(" ")[0]) ? bacteria["名称"].split(" ")[0] : (bacteria["名称"].split(" ")[1] || '')}</div>
        </td>
        <td class="py-2 px-4 text-center beneficial-gut-bacteria-column-text beneficial-gut-bacteria-second-column">
          <div class="flex items-center justify-center">
            <span style="color: ${status.color}">
              <strong>${detected === "ND" ? "未检出" : formattedDetectedValue}
              ${status.icon}</strong>
            </span>
          </div>
          <div class="progress-bar w-full mt-2" style="background-color: #e9ecef; height: 8px; border-radius: 4px; overflow: hidden;">
            <div class="progress"
                 style="width: ${progressPercentage}%;
                        height: 100%;
                        background-color: ${status.isNormal ? OTHER_IMPORTANT_CONSTANTS.COLORS.PRIMARY : OTHER_IMPORTANT_CONSTANTS.COLORS.RED};
                        transition: width 0.3s ease;">
            </div>
          </div>
        </td>
        <td class="py-2 px-4 text-center beneficial-gut-bacteria-column-text beneficial-gut-bacteria-third-column">
          ${formattedMinRange}-${formattedMaxRange}
        </td>
      </tr>
    `;

        // 生成描述行
        const descRow = createOtherImportantDescriptionRow(bacteria, status);

        table.innerHTML = `<tbody>${dataRow}${descRow}</tbody>`;
        bacteriaContainer.appendChild(table);

        return bacteriaContainer;
      }

      // 主渲染函数
      function renderOtherImportantBacteriaTable(bacteriaData) {
        const container = document.getElementById('other-important-bacteria-table-body');
        if (!container) {
          console.error('Cannot find container element');
          return;
        }

        container.innerHTML = '';

        // 如果没有数据
        if (!bacteriaData || !Array.isArray(bacteriaData) || bacteriaData.length === 0) {
          container.innerHTML = '<div class="no-data-message">暂无数据</div>';
          return;
        }

        // 使用DocumentFragment批量处理DOM操作
        const fragment = document.createDocumentFragment();

        bacteriaData.forEach(bacteria => {
          if (bacteria) {  // 确保bacteria存在
            const bacteriaElement = createOtherImportantBacteriaRow(bacteria);
            fragment.appendChild(bacteriaElement);
          }
        });

        // 一次性添加所有元素到DOM
        container.appendChild(fragment);
      }

      // 页面加载时调用
      document.addEventListener('DOMContentLoaded', loadOtherImportantBacteriaData);
    </script>

  </div>

  <!-- 常见有益菌版块 -->
  <h3 class="custom-title-1 page-break">常见有益菌</h3>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">

    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            有益菌是指对宿主健康有积极影响的微生物，特别是在肠道内，有助于维持菌群平衡、促进消化和增强免疫力。下列是常见有益菌在您肠道中的检测情况。（中文名称后的符号表示： # 为益生菌； * 为食品可添加菌；未标注特殊符号为对人体有益微生物；）
          </p>
        </div>
      </div>
    </div>

    <!-- 问答信息框 -->
    <div class="qa-box">
      <div class="flex items-start ml-2">
        <p class="text-lg font-bold text-lightpurple">
          <i class="fas fa-question-circle icon icon-purple"></i>
          肠道有益菌是越多越好吗？
        </p>
      </div>
      <div class="flex items-start ml-2 mt-2">
        <p class="answer-text">
          <i class="fas fa-comments icon icon-orange"></i>
          肠道有益菌并不是越多越好，关键在于微生物的多样性与平衡：
          多样性: 健康的肠道微生物群依赖于多样性，不同菌种间的相互作用有助于维持肠道功能和免疫系统。
          过度生长: 虽然有益菌有助于消化和防病，但过多可能导致代谢问题或肠道不适。
          个体差异: 每个人的肠道微生物群组成不同，适宜的有益菌数量因人而异。
          总之，保持有益菌的多样性和适宜数量是促进肠道健康的关键。
        </p>
      </div>
    </div>

    <!-- 常见益生菌表格 -->
    <div class="rounded-table">
      <!-- 主表格只包含标题 -->
      <table class="min-w-full">
        <thead>
        <tr style="background-color: #00B2B4; color: white;">
          <th
            class="py-2 px-4 text-left beneficial-gut-bacteria-first-column"
            style="font-size: 13px;">
            有益菌名称
          </th>
          <th
            class="py-2 px-4 text-center beneficial-gut-bacteria-second-column"
            style="font-size: 13px; padding: 5px 5px;">
            检测丰度%
          </th>
          <th
            class="py-2 px-4 text-center beneficial-gut-bacteria-third-column"
            style="font-size: 13px; padding: 5px 5px;">
            参考范围%
          </th>
        </tr>
        </thead>
      </table>

      <!-- 数据表格容器 -->
      <div id="beneficial-bacteria-table-body">
        <!-- 数据将通过 JavaScript 动态插入 -->
      </div>
    </div>

    <script>
      // 常量定义
      const CONSTANTS = {
        COLORS: {
          RED: '#ff4d4f',
          GREEN: '#389e0d',
          GRAY: '#808080',
          PRIMARY: '#00B2B4',  // rgb(0, 178, 180) 的十六进制表示
          WARNING: '#FF0000',  // rgb(255, 0, 0) 的十六进制表示
          BLACK: '#000000'
        }
      };

      // 加载数据
      async function loadBeneficialBacteriaData() {
        try {
          const response = await fetch(DATA_PATHS.DATA);
          if (!response.ok) {
            throw new Error(`Network response error: ${response.status}`);
          }
          const data = await response.json();
          renderBeneficialBacteriaTable(data["有益菌"] || []);
        } catch (error) {
          console.error('Error loading beneficial bacteria data:', error);
          document.getElementById('beneficial-bacteria-table-body').innerHTML =
            '<div class="error-message">数据加载失败，请稍后再试</div>';
        }
      }

      // 格式化数字 - 保留2位有效数字
      function formatNumber(value) {
        // 处理特殊值"ND"
        if (value === "ND") return value;

        // 确保转换为数字类型
        const num = Number(value);

        // 保留2位有效数字
        return num.toPrecision(2);
      }

      // 获取状态信息
      function getBacteriaStatus(detected, minRange, maxRange) {
        // 默认为正常状态
        let status = {
          color: CONSTANTS.COLORS.BLACK, // 正常为黑色文字
          text: '正常',
          icon: '',
          isNormal: true
        };

        // 未检出的情况
        if (detected === "ND") {
          if (minRange > 0) {
            // 未检出但参考范围最小值大于0，视为偏低
            status.color = CONSTANTS.COLORS.RED;
            status.text = '偏低';
            status.icon = '<i class="fas fa-arrow-down ml-1" style="color: ' + CONSTANTS.COLORS.RED + ';"></i>';
            status.isNormal = false;
          }
          return status;
        }

        // 低于参考范围
        if (detected < minRange) {
          status.color = CONSTANTS.COLORS.RED;
          status.text = '偏低';
          status.icon = '<i class="fas fa-arrow-down ml-1" style="color: ' + CONSTANTS.COLORS.RED + ';"></i>';
          status.isNormal = false;
        }
        // 高于参考范围
        else if (detected > maxRange) {
          status.color = CONSTANTS.COLORS.RED;
          status.text = '超标';
          status.icon = '<i class="fas fa-arrow-up ml-1" style="color: ' + CONSTANTS.COLORS.RED + ';"></i>';
          status.isNormal = false;
        }
        // 正常范围内，默认状态，无需修改

        return status;
      }

      // 创建描述行 - 更新为新的数据结构和逻辑
      function createDescriptionRow(bacteria, status) {
        let descriptionContent = '';

        // 首先添加常规简介
        if (bacteria["简介"] && bacteria["简介"].trim()) {
          descriptionContent += `
      <div class="flex items-start mb-0">
        <div class="ml-1">
          <p>
            <i class="fas fa-info-circle" style="color: ${CONSTANTS.COLORS.PRIMARY};"></i>
            ${bacteria["简介"]}
          </p>
        </div>
      </div>
    `;
        }

        // 如果状态不是正常，根据状态添加相应的改善建议
        if (!status.isNormal) {
          if (status.text === '超标' && bacteria["超标改善"] && bacteria["超标改善"].trim()) {
            descriptionContent += `
        <div class="flex items-start mt-0">
          <div class="ml-1">
            <p>
              <i class="fas fa-bell" style="color: #FFA500;"></i>
              <strong>改善建议：</strong> ${bacteria["超标改善"]}
            </p>
          </div>
        </div>
      `;
          } else if (status.text === '偏低' && bacteria["偏低改善"] && bacteria["偏低改善"].trim()) {
            descriptionContent += `
        <div class="flex items-start mt-0">
          <div class="ml-1">
            <p>
              <i class="fas fa-bell" style="color: #FFA500;"></i>
              <strong>改善建议：</strong> ${bacteria["偏低改善"]}
            </p>
          </div>
        </div>
      `;
          }
        }

        // 如果有内容需要显示，返回完整的行
        if (descriptionContent.trim()) {
          return `
      <tr class="virus-desc-row">
        <td colspan="6" class="py-2 px-4 text-left">
          <div class="description-container text-gray-600" style="font-size: 11px;">
            ${descriptionContent}
          </div>
        </td>
      </tr>
    `;
        }

        // 如果没有描述内容，返回空字符串
        return '';
      }

      // 创建表格行
      function createBacteriaRow(bacteria) {
        // 解析数据，添加安全检查
        const detected = bacteria["丰度%"] === "ND" ? "ND" : parseFloat(bacteria["丰度%"] || 0);

        // 安全解析范围值
        let minRange = 0, maxRange = 0;
        if (bacteria["正常范围"] && typeof bacteria["正常范围"] === 'string') {
          const rangeParts = bacteria["正常范围"].split("-");
          minRange = parseFloat(rangeParts[0] || 0);
          maxRange = parseFloat(rangeParts[1] || 0);
        }

        // 格式化数据 - 保留2位有效数字
        const formattedDetectedValue = formatNumber(detected);
        const formattedMinRange = formatNumber(minRange);
        const formattedMaxRange = formatNumber(maxRange);

        // 获取状态
        const status = getBacteriaStatus(detected, minRange, maxRange);

        // 创建行元素
        const bacteriaContainer = document.createElement('div');
        bacteriaContainer.className = 'bacteria-info-container';

        const table = document.createElement('table');
        table.className = 'bacteria-table min-w-full';

        // 生成显示值的行
        const dataRow = `
    <tr>
      <td class="py-2 pl-4 pr-2 text-left beneficial-gut-bacteria-first-column">
        <div class="beneficial-gut-bacteria-chinese-text"><strong>${bacteria["中文名"] || ''}</strong></div>
        <div class="beneficial-gut-bacteria-latin-text">${bacteria["名称"] || ''}</div>
      </td>
      <td class="py-2 px-4 text-center beneficial-gut-bacteria-column-text beneficial-gut-bacteria-second-column">
        <div class="flex items-center justify-center">
          <span style="color: ${status.color}">
            <strong>${detected === "ND" ? "未检出" : formattedDetectedValue}
            ${status.icon}</strong>
          </span>
        </div>
        <!-- 使用直接内联的进度条宽度逻辑 -->
        <div class="progress-bar w-full mt-2" style="background-color: #e9ecef; height: 8px; border-radius: 4px; overflow: hidden;">
          <div class="progress"
               style="width: ${bacteria["丰度%"] === "ND" ? 0 : parseFloat(bacteria["丰度%"])}%;
                      height: 100%;
                      background-color: ${CONSTANTS.COLORS.PRIMARY};
                      transition: width 0.3s ease;">
          </div>
        </div>
      </td>
      <td class="py-2 px-4 text-center beneficial-gut-bacteria-column-text beneficial-gut-bacteria-third-column">
        ${formattedMinRange}-${formattedMaxRange}
      </td>
    </tr>
  `;

        // 生成描述行 - 传递整个bacteria对象和status
        const descRow = createDescriptionRow(bacteria, status);

        table.innerHTML = `<tbody>${dataRow}${descRow}</tbody>`;
        bacteriaContainer.appendChild(table);

        return bacteriaContainer;
      }

      // 主渲染函数
      function renderBeneficialBacteriaTable(bacteriaData) {
        const container = document.getElementById('beneficial-bacteria-table-body');
        if (!container) {
          console.error('Cannot find container element');
          return;
        }

        container.innerHTML = '';

        // 如果没有数据
        if (!bacteriaData || !Array.isArray(bacteriaData) || bacteriaData.length === 0) {
          container.innerHTML = '<div class="no-data-message">暂无数据</div>';
          return;
        }

        // 使用DocumentFragment批量处理DOM操作
        const fragment = document.createDocumentFragment();

        bacteriaData.forEach(bacteria => {
          if (bacteria) {  // 确保bacteria存在
            const bacteriaElement = createBacteriaRow(bacteria);
            fragment.appendChild(bacteriaElement);
          }
        });

        // 一次性添加所有元素到DOM
        container.appendChild(fragment);
      }

      // 页面加载时调用
      document.addEventListener('DOMContentLoaded', loadBeneficialBacteriaData);
    </script>

  </div>

  <!-- 常见有害菌版块 -->
  <h3 class="custom-title-1 page-break">常见有害菌</h3>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">

    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            肠道有害菌能够破坏肠道内生态平衡，引起肠道功能紊乱等，损害人体健康。下列是17种常见肠道有害菌在您的肠道中的检测情况。（可以优先关注异常菌和其对应的改善方法）
          </p>
        </div>
      </div>
    </div>

    <!-- 有害菌检测情况总结圆环 -->
    <div class="harmful-gut-bacteria-container mt-10 mb-5">
      <div class="harmful-gut-bacteria-donut-chart-container">
        <div class="harmful-gut-bacteria-donut-chart"></div>
        <div class="harmful-gut-bacteria-center-hole">
          <div class="harmful-gut-bacteria-center-value">3/17</div>
          <div class="harmful-gut-bacteria-center-label">异常</div>
          <div class="harmful-gut-bacteria-center-sublabel">常见有害菌检测结果</div>
        </div>
      </div>

      <div class="harmful-gut-bacteria-legend">
        <div class="harmful-gut-bacteria-legend-item">
          <div class="harmful-gut-bacteria-legend-color harmful-gut-bacteria-exceeded"></div>
          <span>异常 (3项)</span>
        </div>
        <div class="harmful-gut-bacteria-legend-item">
          <div class="harmful-gut-bacteria-legend-color harmful-gut-bacteria-normal"></div>
          <span>参考范围内 (8项)</span>
        </div>
        <div class="harmful-gut-bacteria-legend-item">
          <div class="harmful-gut-bacteria-legend-color harmful-gut-bacteria-not-detected"></div>
          <span>未检出 (6项)</span>
        </div>
      </div>
    </div>

    <!-- 问答信息框 -->
    <div class="qa-box">
      <div class="flex items-start ml-2">
        <p class="text-lg font-bold text-lightpurple">
          <i class="fas fa-question-circle icon icon-purple"></i>
          肠道有害菌是越少越好吗？
        </p>
      </div>
      <div class="flex items-start ml-2 mt-2">
        <p class="answer-text">
          <i class="fas fa-comments icon icon-orange"></i>
          肠道有害菌并不是越少越好。关键在于维持肠道微生物的平衡：
          适度存在: 有害菌在一定数量下可以与有益菌竞争，并促进微生物生态的平衡。
          过度抑制风险: 过度抑制有害菌可能会导致有益菌失衡，破坏微生物群落。
          健康维持: 健康饮食和生活方式有助于控制有害菌的数量，保持整体肠道健康。
          总之，重要的是保持有益菌占主导，有害菌在可控范围内。
        </p>
      </div>
    </div>

    <!-- 常见有害菌表格 -->
    <div class="rounded-table">
      <!-- 主表格只包含标题 -->
      <table class="min-w-full">
        <thead>
        <tr style="background-color: #00B2B4; color: white;">
          <th
            class="py-2 px-4 text-left harmful-gut-bacteria-first-column"
            style="font-size: 13px;">
            有害菌名称
          </th>
          <th
            class="py-2 px-4 text-center harmful-gut-bacteria-second-column"
            style="font-size: 13px; padding: 5px 5px;">
            检测丰度%
          </th>
          <th
            class="py-2 px-4 text-center harmful-gut-bacteria-third-column"
            style="font-size: 13px; padding: 5px 5px;">
            参考范围%
          </th>
          <th
            class="py-2 px-4 text-center harmful-gut-bacteria-fourth-column"
            style="font-size: 13px; padding: 5px 5px;">
            %正常人有检出
          </th>
        </tr>
        </thead>
      </table>

      <!-- 数据表格容器 -->
      <div id="harmful-bacteria-table-body">
        <!-- 数据将通过 JavaScript 动态插入 -->
      </div>
    </div>

    <script>
      // 常量定义
      const HARMFUL_CONSTANTS = {
        COLORS: {
          RED: '#ff4d4f',
          GREEN: '#389e0d',
          GRAY: '#808080',
          PRIMARY: '#00B2B4',
          WARNING: '#FFA500',
          BLACK: '#000000'
        }
      };

      // 加载数据
      async function loadHarmfulBacteriaData() {
        try {
          const response = await fetch(DATA_PATHS.DATA);
          if (!response.ok) {
            throw new Error(`Network response error: ${response.status}`);
          }
          const data = await response.json();
          renderHarmfulBacteriaTable(data["有害菌属"] || []);
        } catch (error) {
          console.error('Error loading harmful bacteria data:', error);
          document.getElementById('harmful-bacteria-table-body').innerHTML =
            '<div class="error-message">数据加载失败，请稍后再试</div>';
        }
      }

      // 格式化数字
      function formatHarmfulNumber(value) {
        // 处理特殊值"ND"
        if (value === "ND") return value;

        // 确保转换为数字类型
        const num = Number(value);

        // 保留2位有效数字
        return num.toPrecision(2);
      }

      // 获取状态信息
      function getHarmfulBacteriaStatus(detected, minRange, maxRange) {
        // 默认为正常状态
        let status = {
          color: HARMFUL_CONSTANTS.COLORS.BLACK,
          text: '正常',
          icon: '',
          isNormal: true
        };

        // 未检出的情况
        if (detected === "ND") {
          if (minRange > 0) {
            status.color = HARMFUL_CONSTANTS.COLORS.RED;
            status.text = '偏低';
            status.icon = '<i class="fas fa-arrow-down ml-1" style="color: ' + HARMFUL_CONSTANTS.COLORS.RED + ';"></i>';
            status.isNormal = false;
          }
          return status;
        }

        // 低于参考范围
        if (detected < minRange) {
          status.color = HARMFUL_CONSTANTS.COLORS.RED;
          status.text = '偏低';
          status.icon = '<i class="fas fa-arrow-down ml-1" style="color: ' + HARMFUL_CONSTANTS.COLORS.RED + ';"></i>';
          status.isNormal = false;
        }
        // 高于参考范围
        else if (detected > maxRange) {
          status.color = HARMFUL_CONSTANTS.COLORS.RED;
          status.text = '超标';
          status.icon = '<i class="fas fa-arrow-up ml-1" style="color: ' + HARMFUL_CONSTANTS.COLORS.RED + ';"></i>';
          status.isNormal = false;
        }

        return status;
      }

      // 检查字符串是否为空
      function isEmptyString(str) {
        return !str || typeof str !== 'string' || str.trim() === '';
      }

      // 计算进度条百分比
      function calculateProgressPercentage(value) {
        if (value === "ND" || value === 0) {
          return 0;
        }

        const num = Number(value);
        const logValue = Math.log10(num);
        const minLog = -1; // log10(0.0001)
        const maxLog = 3;  // log10(100)

        const percentage = ((logValue - minLog) / (maxLog - minLog)) * 45 + 5;
        return Math.max(5, Math.min(50, percentage));
      }

      // 创建描述行 - 修复处理"说明"字段的逻辑
      function createHarmfulDescriptionRow(bacteria, status) {
        // 确保"说明"字段存在且不为空
        if (isEmptyString(bacteria["说明"])) {
          return ''; // 如果没有描述，返回空字符串
        }

        let descriptionContent = `
          <div class="flex items-start mb-0">
            <div class="ml-1">
              <p>
                <i class="fas fa-info-circle" style="color: ${HARMFUL_CONSTANTS.COLORS.PRIMARY};"></i>
                ${bacteria["说明"]}
              </p>
            </div>
          </div>
        `;

        // 如果状态不正常且有改善方式，显示改善建议
        // 明确检查改善方式是否为空字符串
        const hasImprovement = !isEmptyString(bacteria["改善方式"]);
        if (!status.isNormal && hasImprovement) {
          descriptionContent += `
            <div class="flex items-start mt-0">
              <div class="ml-1">
                <p>
                  <i class="fas fa-bell" style="color: ${HARMFUL_CONSTANTS.COLORS.WARNING};"></i>
                  <strong>改善建议：</strong> ${bacteria["改善方式"]}
                </p>
              </div>
            </div>
          `;
        }

        return `
          <tr class="virus-desc-row">
            <td colspan="4" class="py-2 px-4 text-left">
              <div class="description-container text-gray-600" style="font-size: 11px;">
                ${descriptionContent}
              </div>
            </td>
          </tr>
        `;
      }

      // 创建表格行
      function createHarmfulBacteriaRow(bacteria) {
        // 解析数据
        const detected = bacteria["丰度%"] === "ND" ? "ND" : parseFloat(bacteria["丰度%"] || 0);

        // 解析范围（格式为"0-3.83"）
        let minRange = 0, maxRange = 0;
        if (bacteria["正常范围"] && typeof bacteria["正常范围"] === 'string') {
          const rangeParts = bacteria["正常范围"].split("-");
          minRange = parseFloat(rangeParts[0] || 0);
          maxRange = parseFloat(rangeParts[1] || 0);
        }

        // 格式化数据
        const formattedDetectedValue = formatHarmfulNumber(detected);
        const formattedMinRange = formatHarmfulNumber(minRange);
        const formattedMaxRange = formatHarmfulNumber(maxRange);

        // 获取状态
        const status = getHarmfulBacteriaStatus(detected, minRange, maxRange);

        // 创建行元素
        const bacteriaContainer = document.createElement('div');
        bacteriaContainer.className = 'bacteria-info-container';

        const table = document.createElement('table');
        table.className = 'bacteria-table min-w-full';

        // 从名称中提取中文名和拉丁文名（假设格式为"中文名 拉丁名"）
        const nameParts = bacteria["名称"].split(" ");
        const chineseName = nameParts[0] || '';
        const latinName = nameParts.slice(1).join(" ") || ''; // 防止拉丁名有空格

        // 计算进度条百分比
        const progressPercentage = calculateProgressPercentage(detected);

        // 生成显示值的行
        const dataRow = `
        <tr>
          <td class="py-2 pl-4 pr-2 text-left harmful-gut-bacteria-first-column">
            <div class="harmful-gut-bacteria-chinese-text"><strong>${chineseName}</strong></div>
            <div class="harmful-gut-bacteria-latin-text">${latinName}</div>
          </td>
          <td class="py-2 px-4 text-center harmful-gut-bacteria-column-text harmful-gut-bacteria-second-column">
            <div class="flex items-center justify-center">
              <span style="color: ${status.color}">
                <strong>${detected === "ND" ? "未检出" : formattedDetectedValue}
                ${status.icon}</strong>
              </span>
            </div>
            <!-- 进度条 -->
            <div class="progress-bar w-full mt-2" style="background-color: #e9ecef; height: 8px; border-radius: 4px; overflow: hidden;">
              <div class="progress"
                   style="width: ${progressPercentage}%;
                          height: 100%;
                          background-color: ${HARMFUL_CONSTANTS.COLORS.PRIMARY};
                          transition: width 0.3s ease;">
              </div>
            </div>
          </td>
          <td class="py-2 px-4 text-center harmful-gut-bacteria-column-text harmful-gut-bacteria-third-column">
            ${formattedMinRange}-${formattedMaxRange}
          </td>
          <td class="py-2 px-4 text-center harmful-gut-bacteria-column-text harmful-gut-bacteria-fourth-column">
            ${bacteria["%正常人有检出"] || "0%"}
          </td>
        </tr>
      `;

        // 生成描述行
        const descRow = createHarmfulDescriptionRow(bacteria, status);

        table.innerHTML = `<tbody>${dataRow}${descRow}</tbody>`;
        bacteriaContainer.appendChild(table);

        return bacteriaContainer;
      }

      // 主渲染函数
      function renderHarmfulBacteriaTable(bacteriaData) {
        const container = document.getElementById('harmful-bacteria-table-body');
        if (!container) {
          console.error('Cannot find container element: harmful-bacteria-table-body');
          return;
        }

        container.innerHTML = '';

        // 如果没有数据
        if (!bacteriaData || !Array.isArray(bacteriaData) || bacteriaData.length === 0) {
          container.innerHTML = '<div class="no-data-message">暂无数据</div>';
          return;
        }

        // 使用DocumentFragment批量处理DOM操作
        const fragment = document.createDocumentFragment();

        bacteriaData.forEach(bacteria => {
          if (bacteria) {  // 确保bacteria存在
            try {
              const bacteriaElement = createHarmfulBacteriaRow(bacteria);
              fragment.appendChild(bacteriaElement);
            } catch (error) {
              console.error('Error creating row for bacteria:', bacteria, error);
            }
          }
        });

        // 一次性添加所有元素到DOM
        container.appendChild(fragment);
      }

      // 页面加载时调用
      document.addEventListener('DOMContentLoaded', loadHarmfulBacteriaData);
    </script>

  </div>

  <!-- 常见机会致病菌版块 -->
  <h3 class="custom-title-1 page-break">常见机会致病菌</h3>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">
    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            常见的机会致病菌是那些通常不致病，但在特定条件下（例如宿主免疫力降低、伤口感染等）可以引起疾病的微生物。以下是一些常见的机会致病菌：
          </p>
        </div>
      </div>
    </div>

    <!-- 常见机会致病菌表格 -->
    <div class="rounded-table">
      <!-- 主表格只包含标题 -->
      <table class="min-w-full">
        <thead>
        <tr style="background-color: #00B2B4; color: white;">
          <th class="py-2 px-4 text-left opportunistic-pathogen-first-column" style="font-size: 13px;">
            机会致病菌名称
          </th>
          <th class="py-2 px-4 text-center opportunistic-pathogen-second-column" style="font-size: 13px; padding: 5px 5px;">
            检测丰度%
          </th>
          <th class="py-2 px-4 text-center opportunistic-pathogen-third-column" style="font-size: 13px; padding: 5px 5px;">
            参考范围%
          </th>
        </tr>
        </thead>
      </table>

      <!-- 数据表格容器 -->
      <div id="opportunistic-pathogen-table-body">
        <!-- 数据将通过 JavaScript 动态插入 -->
      </div>
    </div>

    <script>
      // 使用命名空间封装机会致病菌相关代码
      const OpportunisticPathogen = {
        // 常量定义
        CONSTANTS: {
          COLORS: {
            RED: '#ff4d4f',
            GREEN: '#389e0d',
            GRAY: '#808080',
            PRIMARY: '#00B2B4',
            WARNING: '#FFA500',
            BLACK: '#000000'
          }
        },

        // 格式化数字
        formatNumber(value) {
          if (typeof value === "string" && value === "ND") return value;
          const num = Number(value);
          return num.toPrecision(2);
        },

        // 解析正常范围
        parseRange(rangeStr) {
          if (!rangeStr || typeof rangeStr !== 'string') {
            return { min: 0, max: 0 };
          }
          const parts = rangeStr.split('-');
          return {
            min: parseFloat(parts[0] || 0),
            max: parseFloat(parts[1] || 0)
          };
        },

        // 获取状态信息
        getStatus(detected, normalRange) {
          const { min, max } = normalRange;

          let status = {
            color: this.CONSTANTS.COLORS.BLACK,
            text: '正常',
            icon: '',
            isNormal: true
          };

          if (detected === "ND") {
            if (min > 0) {
              status.color = this.CONSTANTS.COLORS.RED;
              status.text = '偏低';
              status.icon = '<i class="fas fa-arrow-down ml-1" style="color: ' + this.CONSTANTS.COLORS.RED + ';"></i>';
              status.isNormal = false;
            }
            return status;
          }

          const detectedNum = parseFloat(detected);

          if (detectedNum < min) {
            status.color = this.CONSTANTS.COLORS.RED;
            status.text = '偏低';
            status.icon = '<i class="fas fa-arrow-down ml-1" style="color: ' + this.CONSTANTS.COLORS.RED + ';"></i>';
            status.isNormal = false;
          }
          else if (detectedNum > max) {
            status.color = this.CONSTANTS.COLORS.RED;
            status.text = '超标';
            status.icon = '<i class="fas fa-arrow-up ml-1" style="color: ' + this.CONSTANTS.COLORS.RED + ';"></i>';
            status.isNormal = false;
          }

          return status;
        },

        // 创建描述行
        createDescriptionRow(bacteria, status) {
          let descriptionContent = '';

          if (bacteria["说明"] && bacteria["说明"].trim()) {
            descriptionContent += `
            <div class="flex items-start mb-0">
              <div class="ml-1">
                <p>
                  <i class="fas fa-info-circle" style="color: ${this.CONSTANTS.COLORS.PRIMARY};"></i>
                  ${bacteria["说明"]}
                </p>
              </div>
            </div>
          `;
          }

          if (descriptionContent.trim()) {
            return `
            <tr class="virus-desc-row">
              <td colspan="5" class="py-2 px-4 text-left">
                <div class="description-container text-gray-600" style="font-size: 11px;">
                  ${descriptionContent}
                </div>
              </td>
            </tr>
          `;
          }

          return '';
        },

        // 计算进度条百分比
        calculateProgress(value) {
          if (value === "ND" || value === 0) {
            return 0;
          }

          const num = Number(value);
          return Math.min(100, Math.max(5,
            num <= 1 ? num * 30 :
              num <= 10 ? 30 + (num - 1) * 5 :
                75 + (Math.min(num, 100) - 10) * 0.25
          ));
        },

        // 渲染表格
        renderTable(bacteriaData) {
          const container = document.getElementById('opportunistic-pathogen-table-body');
          if (!container) {
            console.error('Cannot find container element');
            return;
          }

          container.innerHTML = '';

          if (!bacteriaData || !Array.isArray(bacteriaData) || bacteriaData.length === 0) {
            container.innerHTML = '<div class="no-data-message">暂无数据</div>';
            return;
          }

          const fragment = document.createDocumentFragment();

          bacteriaData.forEach(bacteria => {
            if (!bacteria) return;

            const detected = bacteria["丰度%"];
            const normalRange = this.parseRange(bacteria["正常范围"]);
            const latinName = bacteria["名称"] || "";
            const chineseName = bacteria["中文名"] || "";

            const formattedDetectedValue = detected === "ND" ? detected : this.formatNumber(detected);
            const formattedMinRange = this.formatNumber(normalRange.min);
            const formattedMaxRange = this.formatNumber(normalRange.max);

            const status = this.getStatus(detected, normalRange);
            const progressPercentage = this.calculateProgress(detected === "ND" ? 0 : detected);

            const bacteriaContainer = document.createElement('div');
            bacteriaContainer.className = 'bacteria-info-container';

            const table = document.createElement('table');
            table.className = 'bacteria-table min-w-full';

            const dataRow = `
            <tr>
              <td class="py-2 pl-4 pr-2 text-left opportunistic-pathogen-first-column">
                <div class="opportunistic-pathogen-chinese-text"><strong>${chineseName}</strong></div>
                <div class="opportunistic-pathogen-latin-text">${latinName}</div>
              </td>
              <td class="py-2 px-4 text-center opportunistic-pathogen-column-text opportunistic-pathogen-second-column">
                <div class="flex items-center justify-center">
                  <span style="color: ${status.color}">
                    <strong>${detected === "ND" ? "未检出" : formattedDetectedValue}
                    ${status.icon}</strong>
                  </span>
                </div>
                <div class="progress-bar w-full mt-2" style="background-color: #e9ecef; height: 8px; border-radius: 4px; overflow: hidden;">
                  <div class="progress"
                       style="width: ${progressPercentage}%;
                              height: 100%;
                              background-color: ${status.isNormal ? this.CONSTANTS.COLORS.PRIMARY : this.CONSTANTS.COLORS.RED};
                              transition: width 0.3s ease;">
                  </div>
                </div>
              </td>
              <td class="py-2 px-4 text-center opportunistic-pathogen-column-text opportunistic-pathogen-third-column">
                ${formattedMinRange}-${formattedMaxRange}
              </td>
            </tr>
          `;

            const descRow = this.createDescriptionRow(bacteria, status);

            table.innerHTML = `<tbody>${dataRow}${descRow}</tbody>`;
            bacteriaContainer.appendChild(table);
            fragment.appendChild(bacteriaContainer);
          });

          container.appendChild(fragment);
        },

        // 加载数据
        async loadData() {
          try {
            const response = await fetch(DATA_PATHS.DATA);
            if (!response.ok) {
              throw new Error(`Network response error: ${response.status}`);
            }
            const data = await response.json();
            this.renderTable(data["机会致病菌"] || []);
          } catch (error) {
            console.error('Error loading opportunistic pathogen data:', error);
            document.getElementById('opportunistic-pathogen-table-body').innerHTML =
              '<div class="no-data-message">暂无数据</div>';
          }
        },

        // 初始化
        init() {
          document.addEventListener('DOMContentLoaded', () => this.loadData());
        }
      };

      // 初始化机会致病菌模块
      OpportunisticPathogen.init();
    </script>
  </div>

  <!-- 常见致病菌版块 -->
  <h3 class="custom-title-1 page-break">常见致病菌</h3>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">
    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            肠道致病菌是指能直接引起疾病的肠道病原微生物，它们具有明确的致病性，一旦在肠道中检出就可能对健康造成威胁。这类细菌通常具有特定的致病机制，如产生毒素、侵犯宿主细胞、触发炎症反应等。
          </p>
        </div>
      </div>
    </div>

    <!-- 常见致病菌表格 -->
    <div class="rounded-table">
      <!-- 主表格只包含标题 -->
      <table class="min-w-full">
        <thead>
        <tr style="background-color: #00B2B4; color: white;">
          <th class="py-2 px-4 text-left pathogenic-bacteria-first-column" style="font-size: 13px;">
            致病菌名称
          </th>
          <th class="py-2 px-4 text-center pathogenic-bacteria-second-column" style="font-size: 13px; padding: 5px 5px;">
            检测丰度%
          </th>
          <th class="py-2 px-4 text-center pathogenic-bacteria-third-column" style="font-size: 13px; padding: 5px 5px;">
            参考范围%
          </th>
        </tr>
        </thead>
      </table>

      <!-- 数据表格容器 -->
      <div id="pathogenic-bacteria-table-body">
        <!-- 数据将通过 JavaScript 动态插入 -->
      </div>
    </div>

    <script>
      // 致病菌命名空间
      const PathogenicBacteria = {
        // 常量定义
        CONSTANTS: {
          COLORS: {
            RED: '#ff4d4f',
            GREEN: '#389e0d',
            GRAY: '#808080',
            PRIMARY: '#00B2B4',
            WARNING: '#FFA500',
            BLACK: '#000000'
          }
        },

        // 格式化数字
        formatNumber(value) {
          if (typeof value === "string" && value === "ND") return value;
          const num = Number(value);
          return num.toPrecision(2);
        },

        // 解析正常范围
        parseRange(rangeStr) {
          if (!rangeStr || typeof rangeStr !== 'string') {
            return { min: 0, max: 0 };
          }
          const parts = rangeStr.split('-');
          return {
            min: parseFloat(parts[0] || 0),
            max: parseFloat(parts[1] || 0)
          };
        },

        // 获取状态信息
        getStatus(detected, normalRange) {
          const { min, max } = normalRange;

          let status = {
            color: this.CONSTANTS.COLORS.BLACK,
            text: '正常',
            icon: '',
            isNormal: true
          };

          if (detected === "ND") {
            if (min > 0) {
              status.color = this.CONSTANTS.COLORS.RED;
              status.text = '偏低';
              status.icon = '<i class="fas fa-arrow-down ml-1" style="color: ' + this.CONSTANTS.COLORS.RED + ';"></i>';
              status.isNormal = false;
            }
            return status;
          }

          const detectedNum = parseFloat(detected);

          if (detectedNum < min) {
            status.color = this.CONSTANTS.COLORS.RED;
            status.text = '偏低';
            status.icon = '<i class="fas fa-arrow-down ml-1" style="color: ' + this.CONSTANTS.COLORS.RED + ';"></i>';
            status.isNormal = false;
          }
          else if (detectedNum > max) {
            status.color = this.CONSTANTS.COLORS.RED;
            status.text = '超标';
            status.icon = '<i class="fas fa-arrow-up ml-1" style="color: ' + this.CONSTANTS.COLORS.RED + ';"></i>';
            status.isNormal = false;
          }

          return status;
        },

        // 创建描述行
        createDescriptionRow(bacteria, status) {
          let descriptionContent = '';

          if (bacteria["说明"] && bacteria["说明"].trim()) {
            descriptionContent += `
            <div class="flex items-start mb-0">
              <div class="ml-1">
                <p>
                  <i class="fas fa-info-circle" style="color: ${this.CONSTANTS.COLORS.PRIMARY};"></i>
                  ${bacteria["说明"]}
                </p>
              </div>
            </div>
          `;
          }

          if (descriptionContent.trim()) {
            return `
            <tr class="virus-desc-row">
              <td colspan="5" class="py-2 px-4 text-left">
                <div class="description-container text-gray-600" style="font-size: 11px;">
                  ${descriptionContent}
                </div>
              </td>
            </tr>
          `;
          }

          return '';
        },

        // 计算进度条百分比
        calculateProgress(value) {
          if (value === "ND" || value === 0) {
            return 0;
          }

          const num = Number(value);
          return Math.min(100, Math.max(5,
            num <= 1 ? num * 30 :
              num <= 10 ? 30 + (num - 1) * 5 :
                75 + (Math.min(num, 100) - 10) * 0.25
          ));
        },

        // 渲染表格
        renderTable(bacteriaData) {
          const container = document.getElementById('pathogenic-bacteria-table-body');
          if (!container) {
            console.error('Cannot find container element');
            return;
          }

          container.innerHTML = '';

          if (!bacteriaData || !Array.isArray(bacteriaData) || bacteriaData.length === 0) {
            container.innerHTML = '<div class="no-data-message">暂无数据</div>';
            return;
          }

          const fragment = document.createDocumentFragment();

          bacteriaData.forEach(bacteria => {
            if (!bacteria) return;

            const detected = bacteria["丰度%"];
            const normalRange = this.parseRange(bacteria["正常范围"]);
            const latinName = bacteria["名称"] || "";
            const chineseName = bacteria["中文名"] || "";

            const formattedDetectedValue = detected === "ND" ? detected : this.formatNumber(detected);
            const formattedMinRange = this.formatNumber(normalRange.min);
            const formattedMaxRange = this.formatNumber(normalRange.max);

            const status = this.getStatus(detected, normalRange);
            const progressPercentage = this.calculateProgress(detected === "ND" ? 0 : detected);

            const bacteriaContainer = document.createElement('div');
            bacteriaContainer.className = 'bacteria-info-container';

            const table = document.createElement('table');
            table.className = 'bacteria-table min-w-full';

            const dataRow = `
            <tr>
              <td class="py-2 pl-4 pr-2 text-left pathogenic-bacteria-first-column">
                <div class="pathogenic-bacteria-chinese-text"><strong>${chineseName}</strong></div>
                <div class="pathogenic-bacteria-latin-text">${latinName}</div>
              </td>
              <td class="py-2 px-4 text-center pathogenic-bacteria-column-text pathogenic-bacteria-second-column">
                <div class="flex items-center justify-center">
                  <span style="color: ${status.color}">
                    <strong>${detected === "ND" ? "未检出" : formattedDetectedValue}
                    ${status.icon}</strong>
                  </span>
                </div>
                <div class="progress-bar w-full mt-2" style="background-color: #e9ecef; height: 8px; border-radius: 4px; overflow: hidden;">
                  <div class="progress"
                       style="width: ${progressPercentage}%;
                              height: 100%;
                              background-color: ${status.isNormal ? this.CONSTANTS.COLORS.PRIMARY : this.CONSTANTS.COLORS.RED};
                              transition: width 0.3s ease;">
                  </div>
                </div>
              </td>
              <td class="py-2 px-4 text-center pathogenic-bacteria-column-text pathogenic-bacteria-third-column">
                ${formattedMinRange}-${formattedMaxRange}
              </td>
            </tr>
          `;

            const descRow = this.createDescriptionRow(bacteria, status);

            table.innerHTML = `<tbody>${dataRow}${descRow}</tbody>`;
            bacteriaContainer.appendChild(table);
            fragment.appendChild(bacteriaContainer);
          });

          container.appendChild(fragment);
        },

        // 加载数据
        async loadData() {
          try {
            const response = await fetch(DATA_PATHS.DATA);
            if (!response.ok) {
              throw new Error(`Network response error: ${response.status}`);
            }
            const data = await response.json();
            this.renderTable(data["致病菌"] || []);
          } catch (error) {
            console.error('Error loading pathogenic bacteria data:', error);
            document.getElementById('pathogenic-bacteria-table-body').innerHTML =
              '<div class="no-data-message">暂无数据</div>';
          }
        },

        // 初始化
        init() {
          document.addEventListener('DOMContentLoaded', () => this.loadData());
        }
      };

      // 初始化致病菌模块
      PathogenicBacteria.init();
    </script>
  </div>

  <!-- 常见真菌版块 -->
  <h3 class="custom-title-1 page-break">常见真菌</h3>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">
    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            真菌检测对于评估免疫状态和潜在感染风险非常重要。尽管一些真菌在正常情况下不会引起健康问题，但对于免疫系统较弱的人群来说，持续监测是预防真菌感染的关键。下列是一些常见肠道真菌在您肠道中的检测情况。
          </p>
        </div>
      </div>
    </div>

    <!-- 常见真菌表格 -->
    <div class="rounded-table">
      <table class="min-w-full">
        <thead>
        <tr style="background-color: #00B2B4; color: white;">
          <th
            class="py-2 px-4 text-left fungi-first-column"
            style="font-size: 13px;">
            真菌名称
          </th>
          <th
            class="py-2 px-4 text-center fungi-second-column"
            style="font-size: 13px; padding: 5px 5px;">
            检测丰度%
          </th>
          <th
            class="py-2 px-4 text-center fungi-third-column"
            style="font-size: 13px; padding: 5px 5px;">
            参考范围%
          </th>
        </tr>
        </thead>
      </table>

      <div id="gut-fungi-data-table-body">
        <!-- 数据将通过 JavaScript 动态插入 -->
      </div>
    </div>

    <script>
      // 真菌数据展示模块
      const GutFungi = {
        // 常量定义
        CONSTANTS: {
          COLORS: {
            RED: '#ff4d4f',
            GREEN: '#389e0d',
            GRAY: '#808080',
            PRIMARY: '#00B2B4'
          }
        },

        // 格式化数字
        formatNumber(value) {
          if (typeof value === "string" && value === "ND") {
            return value;
          }

          const num = Number(value);
          return num.toPrecision(2);
        },

        // 解析正常范围
        parseRange(rangeStr) {
          if (!rangeStr || typeof rangeStr !== 'string') {
            return { min: 0, max: 0 };
          }
          const parts = rangeStr.split('-');
          return {
            min: parseFloat(parts[0] || 0),
            max: parseFloat(parts[1] || 0)
          };
        },

        // 获取状态信息
        getStatus(detected, normalRange) {
          const { min, max } = this.parseRange(normalRange);

          let status = {
            color: '#000000',
            text: '正常',
            icon: '',
            isNormal: true
          };

          if (detected === "ND") {
            if (min > 0) {
              status.color = this.CONSTANTS.COLORS.RED;
              status.text = '偏低';
              status.icon = '<i class="fas fa-arrow-down ml-1" style="color: ' + this.CONSTANTS.COLORS.RED + ';"></i>';
              status.isNormal = false;
            }
            return status;
          }

          const detectedNum = parseFloat(detected);

          if (detectedNum < min) {
            status.color = this.CONSTANTS.COLORS.RED;
            status.text = '偏低';
            status.icon = '<i class="fas fa-arrow-down ml-1" style="color: ' + this.CONSTANTS.COLORS.RED + ';"></i>';
            status.isNormal = false;
          }
          else if (detectedNum > max) {
            status.color = this.CONSTANTS.COLORS.RED;
            status.text = '超标';
            status.icon = '<i class="fas fa-arrow-up ml-1" style="color: ' + this.CONSTANTS.COLORS.RED + ';"></i>';
            status.isNormal = false;
          }

          return status;
        },

        // 创建描述行
        createDescriptionRow(fungi, status) {
          let descriptionContent = '';

          if (fungi["说明"] && fungi["说明"].trim()) {
            descriptionContent += `
            <div class="flex items-start mb-0">
              <div class="ml-1">
                <p>
                  <i class="fas fa-info-circle" style="color: ${this.CONSTANTS.COLORS.PRIMARY};"></i>
                  ${fungi["说明"]}
                </p>
              </div>
            </div>
          `;
          }

          if (descriptionContent.trim()) {
            return `
            <tr class="fungi-desc-row">
              <td colspan="3" class="py-2 px-4 text-left">
                <div class="description-container text-gray-600" style="font-size: 11px;">
                  ${descriptionContent}
                </div>
              </td>
            </tr>
          `;
          }

          return '';
        },

        // 计算进度条百分比
        calculateProgress(value) {
          if (value === "ND" || value === 0) {
            return 0;
          }

          const num = Number(value);
          return Math.min(100, Math.max(5,
            num <= 1 ? num * 30 :
              num <= 10 ? 30 + (num - 1) * 5 :
                75 + (Math.min(num, 100) - 10) * 0.25
          ));
        },

        // 渲染表格
        renderTable(fungiData) {
          const container = document.getElementById('gut-fungi-data-table-body');
          if (!container) {
            console.error('Cannot find container element');
            return;
          }

          container.innerHTML = '';

          if (!fungiData || !Array.isArray(fungiData) || fungiData.length === 0) {
            container.innerHTML = '<div class="no-data-message">暂无数据</div>';
            return;
          }

          const fragment = document.createDocumentFragment();

          fungiData.forEach(fungi => {
            const detected = fungi["丰度%"];
            const normalRange = fungi["正常范围"];
            const latinName = fungi["名称"];
            const chineseName = fungi["中文名"];
            const evaluation = fungi["结果评价"];
            const exceededTimes = fungi["超标倍数"];

            const status = this.getStatus(detected, normalRange);
            const progressPercentage = this.calculateProgress(detected === "ND" ? 0 : detected);

            const fungiContainer = document.createElement('div');
            fungiContainer.className = 'fungi-info-container';

            const table = document.createElement('table');
            table.className = 'fungi-table min-w-full';

            const dataRow = `
            <tr>
              <td class="py-2 px-4 text-left fungi-first-column">
                <div class="fungi-chinese-text"><strong>${chineseName}</strong></div>
                <div class="fungi-latin-text">${latinName}</div>
              </td>

              <td class="py-2 px-4 text-center fungi-column-text fungi-second-column">
                <div class="flex items-center justify-center">
                  <span style="color: ${status.color}">
                    <strong>${detected === "ND" ? "未检出" : this.formatNumber(detected)}
                    ${status.icon}</strong>
                  </span>
                </div>
                <div class="progress-bar w-full mt-2" style="background-color: #e9ecef; height: 8px; border-radius: 4px; overflow: hidden;">
                  <div class="progress"
                       style="width: ${progressPercentage}%;
                              height: 100%;
                              background-color: ${status.isNormal ? this.CONSTANTS.COLORS.PRIMARY : this.CONSTANTS.COLORS.RED};
                              transition: width 0.3s ease;">
                  </div>
                </div>
              </td>
              <td class="py-2 px-4 text-center fungi-column-text fungi-third-column">
                ${normalRange}
              </td>
            </tr>
          `;

            const descRow = this.createDescriptionRow(fungi, status);

            table.innerHTML = `<tbody>${dataRow}${descRow}</tbody>`;
            fungiContainer.appendChild(table);
            fragment.appendChild(fungiContainer);
          });

          container.appendChild(fragment);
        },

        // 加载数据
        async loadData() {
          try {
            const response = await fetch(DATA_PATHS.DATA);
            if (!response.ok) {
              throw new Error(`Network response error: ${response.status}`);
            }
            const data = await response.json();
            this.renderTable(data["真菌"] || []);
          } catch (error) {
            console.error('Error loading fungi data:', error);
            document.getElementById('gut-fungi-data-table-body').innerHTML =
              '<div class="no-data-message">暂无数据</div>';
          }
        },

        // 初始化
        init() {
          document.addEventListener('DOMContentLoaded', () => this.loadData());
        }
      };

      // 初始化真菌模块
      GutFungi.init();
    </script>
  </div>

  <!-- 肠道菌群检测 : 常见肠道寄生虫版块 -->
  <h3 class="custom-title-1 page-break">常见肠道寄生虫</h3>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">
    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            肠道常见寄生虫检测对于评估肠道健康和潜在感染风险具有重要意义。虽然部分寄生虫在低水平时可能不会造成明显症状，但持续监测对预防寄生虫相关疾病至关重要。
          </p>
        </div>
      </div>
    </div>

    <!-- 常见肠道寄生虫表格 -->
    <div class="rounded-table">
      <table class="min-w-full">
        <thead>
        <tr style="background-color: #00B2B4; color: white;">
          <th class="py-2 px-4 text-left parasite-first-column" style="font-size: 13px;">
            寄生虫名称
          </th>
          <th class="py-2 px-4 text-center parasite-second-column" style="font-size: 13px; padding: 5px 5px;">
            检测丰度%
          </th>
          <th class="py-2 px-4 text-center parasite-third-column" style="font-size: 13px; padding: 5px 5px;">
            参考范围%
          </th>
        </tr>
        </thead>
      </table>

      <div id="gut-parasites-data-table-body">
        <!-- 数据将通过 JavaScript 动态插入 -->
      </div>
    </div>

    <script>
      // 寄生虫数据展示模块
      const GutParasites = {
        // 常量定义
        CONSTANTS: {
          COLORS: {
            RED: '#ff4d4f',
            GREEN: '#389e0d',
            GRAY: '#808080',
            PRIMARY: '#00B2B4'
          }
        },

        // 格式化数字
        formatNumber(value) {
          if (typeof value === "string" && value === "ND") {
            return value;
          }

          const num = Number(value);
          return num.toPrecision(2);
        },

        // 解析正常范围
        parseRange(rangeStr) {
          if (!rangeStr || typeof rangeStr !== 'string') {
            return { min: 0, max: 0 };
          }
          const parts = rangeStr.split('-');
          return {
            min: parseFloat(parts[0] || 0),
            max: parseFloat(parts[1] || 0)
          };
        },

        // 获取状态信息
        getStatus(detected, normalRange) {
          const { min, max } = this.parseRange(normalRange);

          let status = {
            color: this.CONSTANTS.COLORS.GREEN,
            text: '正常',
            icon: '',
            isNormal: true
          };

          if (detected === "ND") {
            if (min > 0) {
              status.color = this.CONSTANTS.COLORS.RED;
              status.text = '偏低';
              status.icon = '<i class="fas fa-arrow-down ml-1" style="color: ' + this.CONSTANTS.COLORS.RED + ';"></i>';
              status.isNormal = false;
            }
            return status;
          }

          const detectedNum = parseFloat(detected);

          if (detectedNum < min) {
            status.color = this.CONSTANTS.COLORS.RED;
            status.text = '偏低';
            status.icon = '<i class="fas fa-arrow-down ml-1" style="color: ' + this.CONSTANTS.COLORS.RED + ';"></i>';
            status.isNormal = false;
          }
          else if (detectedNum > max) {
            status.color = this.CONSTANTS.COLORS.RED;
            status.text = '超标';
            status.icon = '<i class="fas fa-arrow-up ml-1" style="color: ' + this.CONSTANTS.COLORS.RED + ';"></i>';
            status.isNormal = false;
          }

          return status;
        },

        // 创建描述行
        createDescriptionRow(parasite, status) {
          let descriptionContent = '';

          // 添加"说明"字段
          if (parasite["说明"] && parasite["说明"].trim()) {
            descriptionContent += `
            <div class="flex items-start mb-0">
              <div class="ml-1">
                <p>
                  <i class="fas fa-info-circle" style="color: ${this.CONSTANTS.COLORS.PRIMARY};"></i>
                  ${parasite["说明"]}
                </p>
              </div>
            </div>
          `;
          }

          // 添加超标倍数信息
          if (parasite["超标倍数"] && parasite["超标倍数"].trim() && !status.isNormal) {
            descriptionContent += `
            <div class="flex items-start mb-0">
              <div class="ml-1">
                <p>
                  <i class="fas fa-exclamation-triangle" style="color: ${this.CONSTANTS.COLORS.RED};"></i>
                  超标${parasite["超标倍数"]}倍
                </p>
              </div>
            </div>
          `;
          }

          if (descriptionContent.trim()) {
            return `
            <tr class="parasite-desc-row">
              <td colspan="4" class="py-2 px-4 text-left">
                <div class="description-container text-gray-600" style="font-size: 11px;">
                  ${descriptionContent}
                </div>
              </td>
            </tr>
          `;
          }

          return '';
        },

        // 计算进度条百分比
        calculateProgress(value) {
          if (value === "ND" || value === 0) {
            return 0;
          }

          const num = Number(value);
          return Math.min(100, Math.max(5,
            num <= 1 ? num * 30 :
              num <= 10 ? 30 + (num - 1) * 5 :
                75 + (Math.min(num, 100) - 10) * 0.25
          ));
        },

        // 渲染表格
        renderTable(parasitesData) {
          const container = document.getElementById('gut-parasites-data-table-body');
          if (!container) {
            console.error('Cannot find container element');
            return;
          }

          container.innerHTML = '';

          if (!parasitesData || !Array.isArray(parasitesData) || parasitesData.length === 0) {
            container.innerHTML = '<div class="no-data-message">暂无数据</div>';
            return;
          }

          const fragment = document.createDocumentFragment();

          parasitesData.forEach(parasite => {
            const detected = parasite["丰度%"];
            const normalRange = parasite["正常范围"];
            const latinName = parasite["名称"];
            const chineseName = parasite["中文名"];
            const evaluation = parasite["结果评价"];
            const exceededTimes = parasite["超标倍数"];

            const status = this.getStatus(detected, normalRange);
            const progressPercentage = this.calculateProgress(detected === "ND" ? 0 : detected);

            const parasiteContainer = document.createElement('div');
            parasiteContainer.className = 'parasite-info-container';

            const table = document.createElement('table');
            table.className = 'parasite-table min-w-full';

            const dataRow = `
            <tr>
              <td class="py-2 px-4 text-left parasite-first-column">
                <div class="parasite-chinese-text"><strong>${chineseName}</strong></div>
                <div class="parasite-latin-text">${latinName}</div>
              </td>

              <td class="py-2 px-4 text-center parasite-column-text parasite-second-column">
                <div class="flex items-center justify-center">
                  <span style="color: ${status.color}">
                    <strong>${detected === "ND" ? "未检出" : this.formatNumber(detected)}
                    ${status.icon}</strong>
                  </span>
                </div>
                <div class="progress-bar w-full mt-2" style="background-color: #e9ecef; height: 8px; border-radius: 4px; overflow: hidden;">
                  <div class="progress"
                       style="width: ${progressPercentage}%;
                              height: 100%;
                              background-color: ${status.isNormal ? this.CONSTANTS.COLORS.PRIMARY : this.CONSTANTS.COLORS.RED};
                              transition: width 0.3s ease;">
                  </div>
                </div>
              </td>
              <td class="py-2 px-4 text-center parasite-column-text parasite-third-column">
                ${normalRange}
              </td>
            </tr>
          `;

            const descRow = this.createDescriptionRow(parasite, status);

            table.innerHTML = `<tbody>${dataRow}${descRow}</tbody>`;
            parasiteContainer.appendChild(table);
            fragment.appendChild(parasiteContainer);
          });

          container.appendChild(fragment);
        },

        // 加载数据
        async loadData() {
          try {
            const response = await fetch(DATA_PATHS.DATA);
            if (!response.ok) {
              throw new Error(`Network response error: ${response.status}`);
            }
            const data = await response.json();
            this.renderTable(data["寄生虫"] || []);
          } catch (error) {
            console.error('Error loading parasites data:', error);
            document.getElementById('gut-parasites-data-table-body').innerHTML =
              '<div class="no-data-message">暂无数据</div>';
          }
        },

        // 初始化
        init() {
          document.addEventListener('DOMContentLoaded', () => this.loadData());
        }
      };

      // 初始化寄生虫模块
      GutParasites.init();
    </script>
  </div>

  <!-- 肠道菌群检测 : 病毒版块 -->
  <h3 class="custom-title-1 page-break">肠道病毒</h3>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">

    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            肠道微生物除了细菌外，还包含大量病毒。研究表明，健康人的肠道中约有数万种病毒，其中超过 90% 是噬菌体。下表展示了在您肠道中检测到的病毒，按病毒的检出丰度从高到低排列了前15位（如无检出将没有显示）。
          </p>
        </div>
      </div>
    </div>

    <!-- 病毒表格 -->
    <div class="rounded-table">
      <table class="min-w-full">
        <thead>
        <tr style="background-color: #00B2B4; color: white;">
          <th class="py-2 px-4 text-left core-gut-bacteria-first-column" style="font-size: 13px;">
            病毒名称
          </th>
          <th class="py-2 px-4 text-center core-gut-bacteria-second-column" style="font-size: 13px; padding: 5px 5px;">
            参考范围%
          </th>
          <th class="py-2 px-4 text-center core-gut-bacteria-third-column" style="font-size: 13px; padding: 5px 5px;">
            检测丰度%
          </th>
          <th class="py-2 px-4 text-center core-gut-bacteria-fourth-column" style="font-size: 13px; padding: 5px 5px;">
            结果评价
          </th>
        </tr>
        </thead>
      </table>

      <div id="gut-virus-data-table-body">
        <!-- 数据将通过 JavaScript 动态插入 -->
      </div>
    </div>

    <script>
      async function loadGutVirusData() {
        try {
          const response = await fetch(DATA_PATHS.DATA);
          const data = await response.json();
          renderGutVirusTable(data.gut_virus_data);
        } catch (error) {
          console.error('Error loading virus data:', error);
        }
      }

      function formatNumber(value) {
        if (typeof value === "string" && value === "ND") {
          return value;
        }

        const num = Number(value);

        if (num >= 1) {
          const integerDigits = Math.floor(Math.log10(num)) + 1;
          const decimalPlaces = Math.max(0, 4 - integerDigits);
          return num.toFixed(decimalPlaces);
        } else {
          const str = num.toPrecision(4);
          return str.replace(/\.?0+$/, '');
        }
      }

      function formatDetectedValue(value) {
        return formatNumber(value);
      }

      function formatRangeValue(value) {
        return formatNumber(value);
      }

      function calculateProgressPercentageForThirdColumn(value) {
        if (value === "ND" || value === 0) {
          return 0;
        }

        const num = Number(value);
        const logValue = Math.log10(num);
        const minLog = -1; // log10(0.0001)
        const maxLog = 3;  // log10(100)

        const percentage = ((logValue - minLog) / (maxLog - minLog)) * 45 + 5;
        return Math.max(5, Math.min(50, percentage));
      }

      function renderGutVirusTable(bacteriaData) {
        const container = document.getElementById('gut-virus-data-table-body');
        container.innerHTML = '';

        const CUSTOM_COLORS = {
          red: '#ff4d4f',
          green: '#389e0d',
          gray: '#808080'
        };

        bacteriaData.forEach(bacteria => {
          let statusColor, statusText, statusIcon;
          const detected = bacteria.detected_abundance;
          const minRange = bacteria.normal_range.normal_range_min;
          const maxRange = bacteria.normal_range.normal_range_max;

          const formattedDetectedValue = formatDetectedValue(detected);
          const formattedMinRange = formatRangeValue(minRange);
          const formattedMaxRange = formatRangeValue(maxRange);

          let isNormal = true;

          if (detected === "ND") {
            if (minRange > 0) {
              statusColor = 'red';
              statusText = '偏低';
              statusIcon = '<i class="fas fa-arrow-down ml-1"></i>';
              isNormal = false;
            } else {
              statusColor = 'green';
              statusText = '正常';
              statusIcon = '';
            }
          } else {
            if (detected < minRange) {
              statusColor = 'red';
              statusText = '偏低';
              statusIcon = '<i class="fas fa-arrow-down ml-1"></i>';
              isNormal = false;
            } else if (detected <= maxRange) {
              statusColor = 'green';
              statusText = '正常';
              statusIcon = '';
            } else {
              statusColor = 'red';
              statusText = '超标';
              statusIcon = '<i class="fas fa-arrow-up ml-1"></i>';
              isNormal = false;
            }
          }

          const bacteriaContainer = document.createElement('div');
          bacteriaContainer.className = 'bacteria-info-container';

          const table = document.createElement('table');
          table.className = 'bacteria-table min-w-full';

          const dataRow = `
      <tr>
        <td class="py-2 px-4 text-left core-gut-bacteria-first-column">
          <div class="core-gut-bacteria-chinese-text"><strong>${bacteria.chinese_name}</strong></div>
          <div class="core-gut-bacteria-latin-text">${bacteria.latin_name}</div>
        </td>
        <td class="py-2 px-4 text-center core-gut-bacteria-column-text core-gut-bacteria-second-column">
          ${formattedMinRange}-${formattedMaxRange}
        </td>
        <td class="py-2 px-4 text-center core-gut-bacteria-column-text core-gut-bacteria-third-column">
          <div class="flex items-center justify-center">
            <span style="color: ${
            (detected === "ND" && minRange > 0) ||
            (detected !== "ND" && detected < minRange) ? '#ff4d4f' :
              (detected !== "ND" && detected > maxRange) ? '#ff4d4f' :
                '#000000'
          }">
              ${detected === "ND" ? "未检出" : formattedDetectedValue}
            </span>
            ${
            (detected === "ND" && minRange > 0) ||
            (detected !== "ND" && detected < minRange) ?
              '<i class="fas fa-arrow-down ml-1" style="color: #ff4d4f;"></i>' :
              (detected !== "ND" && detected > maxRange) ?
                '<i class="fas fa-arrow-up ml-1" style="color: #ff4d4f;"></i>' :
                ''
          }
          </div>
          <div class="progress-bar w-full mt-1">
            <div class="progress mt-2"
                 style="width: ${calculateProgressPercentageForThirdColumn(detected)}%;
                        background-color: #00B2B4;
                        transition: width 0.3s ease;">
            </div>
          </div>
        </td>
        <td class="py-2 px-4 text-center core-gut-bacteria-column-text core-gut-bacteria-fourth-column">
          <span style="color: ${CUSTOM_COLORS[statusColor]}">
            ${statusText}${statusIcon}
          </span>
        </td>
      </tr>
    `;

          const filteredDescriptions = bacteria.descriptions.filter(desc =>
            desc.type === 'info' || (!isNormal && desc.type === 'warning')
          );

          const descRow = filteredDescriptions.length > 0 ? `
      <tr class="virus-desc-row">
        <td colspan="4" class="py-2 px-4 text-left">
          <div class="description-container text-gray-600" style="font-size: 10px;">
            ${filteredDescriptions.map(desc => `
              <div class="flex items-start">
                <div class="ml-1">
                  <p>
                    <i class="fas fa-${desc.type === 'info' ? 'info-circle' : 'bell'}"
                       style="color: ${desc.color};">
                    </i>
                    ${desc.text}
                  </p>
                </div>
              </div>
            `).join('')}
          </div>
        </td>
      </tr>
    ` : '';

          table.innerHTML = `<tbody>${dataRow}${descRow}</tbody>`;
          bacteriaContainer.appendChild(table);
          container.appendChild(bacteriaContainer);
        });
      }

      // 页面加载时调用
      document.addEventListener('DOMContentLoaded', loadGutVirusData);
    </script>

  </div>


  <!-- 肠道菌群抗性和基因分布板块 -->

  <!-- 整体页面容器 -->
  <h2 class="custom-title-second-level page-break">肠道菌群抗性与基因分布</h2>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">

    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            肠道菌群抗性是指细菌在肠道环境中通过不同基因的协同作用，抵抗抗生素、重金属及其他有害物质的能力。肠道菌群中的耐药基因、金属耐受基因和外排基因共同构成了细菌应对环境压力的重要机制，保障其生存与繁殖。
          </p>
          <ul class="list-disc ml-5">
            <li>
              <strong>耐药基因</strong>：
              <ul class="list-disc ml-5">
                <li>作用机制：编码特定酶或改变靶点，减弱抗生素的效力。</li>
                <li>常见耐药基因：blaTEM (β-lactamase)、mecA (青霉素结合蛋白改变)。</li>
              </ul>
            </li>
            <li>
              <strong>金属耐受基因</strong>：
              <ul class="list-disc ml-5">
                <li>作用机制：帮助细菌在重金属环境中生存，通过排出或转化金属降低其毒性。</li>
                <li>常见金属耐受基因：czrC (锌的外排相关)。</li>
              </ul>
            </li>
            <li>
              <strong>外排基因</strong>：
              <ul class="list-disc ml-5">
                <li>作用机制：通过编码外排泵积极排除抗生素和毒素，提高耐药性。</li>
                <li>常见外排基因：AcrAB-TolC (多种抗生素外排)、MexAB-OprM (对β-lactam抗生素的外排)。</li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </div>

  </div>


  <h3 class="custom-title-third-level page-break">耐药基因分布</h3>
  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">

    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            耐药基因是指生物体内存在的一类基因，使得生物能够抵御或适应抗生素等药物的影响。这些基因广泛存在于细菌中，特别是在病原菌中，发挥着保护细胞、维持生存的重要作用。耐药基因使得肠道菌群能够在不利环境中生存，从而影响治疗效果和公共健康。
          </p>
          <ul class="list-disc ml-5">
            <li>
              <strong>作用机制</strong>：
              <ul class="list-disc ml-5">
                <li>药物排除：通过编码泵类蛋白，增强细菌细胞膜对抗生素的排出能力。</li>
                <li>药物失活：产生酶来分解或改变药物的活性，从而降低其毒性。</li>
                <li>靶点改变：通过基因突变或重组改变抗生素的靶标，从而使药物无法有效结合。</li>
              </ul>
            </li>
            <li>
              <strong>常见耐药基因</strong>：
              <ul class="list-disc ml-5">
                <li>blaTEM：编码β-lactam酶，能够分解青霉素类抗生素。</li>
                <li>mecA：与耐甲氧西林的金黄色葡萄球菌（MRSA）相关，改变青霉素结合蛋白，使其对青霉素耐受。</li>
                <li>tetM：赋予细菌对四环素的耐药能力，通过改变抗生素的靶点机制。</li>
                <li>aac(3)-IV：编码一种酰胺酶，能够失活氨基糖苷类抗生素。</li>
                <li>vanA：与万古霉素耐药相关，改变细菌对万古霉素的靶标。</li>
              </ul>
            </li>
          </ul>
          <p>下列是您肠道中检出的耐药基因，按照相关耐药基因片段reads数量递减排列。</p>
          <!-- 在这里插入相关数据 -->
        </div>
      </div>
    </div>


    <!-- 包裹三个卡片的容器 -->
<!--    <div class="card-container">-->
<!--      <div class="card">-->
<!--        <div class="title">检测菌株</div>-->
<!--        <div class="number">21株</div>-->
<!--        <div class="status green">100% 完成检测</div>-->
<!--      </div>-->
<!--      <div class="card">-->
<!--        <div class="title">耐药基因种类</div>-->
<!--        <div class="number">12种</div>-->
<!--        <div class="status blue">覆盖3大类别</div>-->
<!--      </div>-->
<!--      <div class="card">-->
<!--        <div class="title">最高reads数</div>-->
<!--        <div class="number">321,552</div>-->
<!--        <div class="status orange">四环素类耐药</div>-->
<!--      </div>-->
<!--    </div>-->

    <!-- 细菌耐药性基因表格 -->
    <div class="rounded-table">
      <table class="min-w-full">
        <thead>
        <tr style="background-color: #00B2B4; color: white;">
          <th class="py-2 px-4 text-left resistance-first-column"
              style="font-size: 11px;">
            来源菌株
          </th>
          <th class="py-2 px-4 text-center resistance-second-column"
              style="font-size: 11px; padding: 5px 5px;">
            耐药基因
          </th>
          <th class="py-2 px-4 text-right resistance-third-column"
              style="font-size: 11px;
                    padding: 5px 20px 5px 5px;"
          >
            耐药类型
          </th>
          <th class="py-2 px-4 text-center resistance-fourth-column"
              style="font-size: 11px; padding: 5px 5px;">
            reads数量
          </th>
          <th class="py-2 px-4 text-right resistance-fifth-column"
              style="font-size: 11px; padding: 5px 20px 5px 5px;">
            耐药药物
          </th>
        </tr>
        </thead>
      </table>

      <div id="antimicrobial-resistance-data-table-body">
        <!-- 数据将通过 JavaScript 动态插入 -->
      </div>

      <script>
        async function loadResistanceData() {
          try {
            const response = await fetch(DATA_PATHS.DATA);
            const data = await response.json();
            data.antimicrobial_resistance_genes_data.sort((a, b) => b.reads_count - a.reads_count);
            renderResistanceTable(data.antimicrobial_resistance_genes_data);
          } catch (error) {
            console.error('Error loading resistance data:', error);
          }
        }

        function renderResistanceTable(resistanceData) {
          const container = document.getElementById('antimicrobial-resistance-data-table-body');
          if (!container) {
            console.error('Resistance table body not found');
            return;
          }

          container.innerHTML = '';

          resistanceData.forEach(resistance => {
            const resistanceContainer = document.createElement('div');
            resistanceContainer.className = 'resistance-info-container';

            const table = document.createElement('table');
            table.className = 'resistance-table min-w-full';

            const dataRow = `
  <tr class="resistance-row">
    <td class="py-2 px-4 text-left resistance-first-column">
      <div class="chinese-text">${resistance.chinese_name}</div>
      <div class="latin-text">${resistance.latin_name}</div>
    </td>
    <td class="py-2 px-4 text-center resistance-column-text resistance-second-column">
      <span class="resistance-gene">${resistance.resistance_gene}</span>
    </td>
    <td class="py-2 px-4 text-center resistance-column-text resistance-third-column">
      <div class="stack-container">
        ${resistance.resistance_type.map(type => `
          <div class="stack-item">${type}</div>
        `).join('')}
      </div>
    </td>
    <td class="py-2 px-4 text-center resistance-column-text resistance-fourth-column">
      <span class="reads-count ${parseInt(resistance.reads_count) > 0 ? 'high' : 'low'}">
        ${resistance.reads_count}
      </span>
    </td>
    <td class="py-2 px-4 text-center resistance-column-text resistance-fifth-column">
      <div class="stack-container">
        ${resistance.resistance_drugs.map(drug => `
          <div class="stack-item">${drug}</div>
        `).join('')}
      </div>
    </td>
  </tr>
`;

            const descRow = resistance.descriptions ? `
          <tr class="resistance-desc-row">
            <td colspan="5" class="py-2 px-4 text-left">
              <div class="description-container text-gray-600" style="font-size: 10px;">
                ${resistance.descriptions.map(desc => `
                  <div class="resistance-description">
                    <i class="fas fa-${desc.type === 'info' ? 'info-circle' : 'bell'}"
                       style="color: ${desc.color};"></i>
                    ${desc.text}
                  </div>
                `).join('')}
              </div>
            </td>
          </tr>
        ` : '';

            table.innerHTML = `<tbody>${dataRow}${descRow}</tbody>`;
            resistanceContainer.appendChild(table);
            container.appendChild(resistanceContainer);
          });
        }

        // 页面加载时加载数据
        document.addEventListener('DOMContentLoaded', loadResistanceData);
      </script>

    </div>

  </div>

  <h3 class="custom-title-third-level page-break">金属耐受基因分布</h3>
  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">

    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            金属耐受基因是指生物体内存在的一类基因，使得生物能够抵御和适应环境中有毒金属离子的影响。这些基因广泛存在于微生物、植物和动物中，发挥着保护细胞、维持生存的重要作用。金属耐受基因使得肠道菌群能够在负有重金属污染的环境中生存，并帮助维持肠道生态系统的平衡。
          </p>
          <ul class="list-disc ml-5">
            <li>
              <strong>作用机制</strong>：
              <ul class="list-disc ml-5">
                <li>金属转运：通过转运蛋白将金属离子有效排出细胞或将其吸收。</li>
                <li>金属螯合：合成小分子或蛋白质与金属离子结合，形成无毒的络合物，以降低金属的毒性。</li>
                <li>去毒化反应：通过酶促反应改变金属离子的化学形态，从而减轻其对细胞的伤害。</li>
              </ul>
            </li>
            <li>
              <strong>常见金属耐受基因</strong>：
              <ul class="list-disc ml-5">
                <li>cusC：负责铜离子的耐受，促进细菌排除体内多余的铜离子。</li>
                <li>copA：参与铜离子的运输和排出，帮助细菌防止铜的毒性影响。</li>
                <li>zntA：与锌和镉的耐受相关，能够排出细胞内有害的锌和镉离子。</li>
                <li>silE：与硅化合物的耐受性相关，帮助细菌生存于含硅的环境。</li>
                <li>merA：编码汞还原酶，将有毒的二价汞还原为较不活泼的一价汞。</li>
                <li>chrB：负责铬的耐受，促进细菌在铬污染环境中的存活。</li>
              </ul>
            </li>
          </ul>
          <p>下列是您肠道中检出的肠道菌群的金属耐受基因，按照相关金属耐受基因片段reads数量递减排列。</p>
          <!-- 在这里插入相关数据 -->
        </div>
      </div>
    </div>


    <!-- 细菌耐药性基因表格 -->
    <div class="rounded-table">
      <table class="min-w-full">
        <thead>
        <tr style="background-color: #00B2B4; color: white;">
          <th class="py-2 px-4 text-left metal-tolerance-first-column"
              style="font-size: 11px;">
            来源菌株
          </th>
          <th class="py-2 px-4 text-center metal-tolerance-second-column"
              style="font-size: 11px; padding: 5px 5px;">
            相关基因
          </th>
          <th class="py-2 px-4 text-right metal-tolerance-third-column"
              style="font-size: 11px;
                    padding: 5px 20px 5px 5px;"
          >
            机制类型
          </th>
          <th class="py-2 px-4 text-center metal-tolerance-fourth-column"
              style="font-size: 11px; padding: 5px 5px;">
            reads数量
          </th>
          <th class="py-2 px-4 text-right metal-tolerance-fifth-column"
              style="font-size: 11px; padding: 5px 20px 5px 5px;">
            相关金属
          </th>
        </tr>
        </thead>
      </table>

      <div id="metal-tolerance-genes-data-table-body">
        <!-- 数据将通过 JavaScript 动态插入 -->
      </div>

      <script>
        async function loadMetalToleranceData() {
          try {
            const response = await fetch(DATA_PATHS.DATA);
            const data = await response.json();
            data.metal_tolerance_genes_data.sort((a, b) => b.reads_count - a.reads_count);
            renderMetalToleranceTable(data.metal_tolerance_genes_data);
          } catch (error) {
            console.error('Error loading resistance data:', error);
          }
        }

        function renderMetalToleranceTable(resistanceData) {
          const container = document.getElementById('metal-tolerance-genes-data-table-body');
          if (!container) {
            console.error('Resistance table body not found');
            return;
          }

          container.innerHTML = '';

          resistanceData.forEach(resistance => {
            const resistanceContainer = document.createElement('div');
            resistanceContainer.className = 'resistance-info-container';

            const table = document.createElement('table');
            table.className = 'resistance-table min-w-full';

            const dataRow = `
  <tr class="resistance-row">
    <td class="py-2 px-4 text-left metal-tolerance-first-column">
      <div class="chinese-text">${resistance.chinese_name}</div>
      <div class="latin-text">${resistance.latin_name}</div>
    </td>
    <td class="py-2 px-4 text-center resistance-column-text metal-tolerance-second-column">
      <span class="resistance-gene">${resistance.resistance_gene}</span>
    </td>
    <td class="py-2 px-4 text-center resistance-column-text metal-tolerance-third-column">
      <div class="stack-container">
        ${resistance.resistance_type.map(type => `
          <div class="stack-item">${type}</div>
        `).join('')}
      </div>
    </td>
    <td class="py-2 px-4 text-center resistance-column-text metal-tolerance-fourth-column">
      <span class="reads-count ${parseInt(resistance.reads_count) > 0 ? 'high' : 'low'}">
        ${resistance.reads_count}
      </span>
    </td>
    <td class="py-2 px-4 text-center resistance-column-text metal-tolerance-fifth-column">
      <div class="stack-container">
        ${resistance.resistance_drugs.map(drug => `
          <div class="stack-item">${drug}</div>
        `).join('')}
      </div>
    </td>
  </tr>
`;

            const descRow = resistance.descriptions ? `
          <tr class="resistance-desc-row">
            <td colspan="5" class="py-2 px-4 text-left">
              <div class="description-container text-gray-600" style="font-size: 10px;">
                ${resistance.descriptions.map(desc => `
                  <div class="resistance-description">
                    <i class="fas fa-${desc.type === 'info' ? 'info-circle' : 'bell'}"
                       style="color: ${desc.color};"></i>
                    ${desc.text}
                  </div>
                `).join('')}
              </div>
            </td>
          </tr>
        ` : '';

            table.innerHTML = `<tbody>${dataRow}${descRow}</tbody>`;
            resistanceContainer.appendChild(table);
            container.appendChild(resistanceContainer);
          });
        }

        // 页面加载时加载数据
        document.addEventListener('DOMContentLoaded', loadMetalToleranceData);
      </script>

    </div>

  </div>

  <h3 class="custom-title-third-level page-break">外排基因分布</h3>
  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">

    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            外排基因是指一类生物体内的基因，通过编码特定的蛋白质，促进细菌将有害物质，如抗生素、毒素及重金属等，从细胞内泵出。外排基因广泛存在于多种细菌中，尤其是在病原菌中，能够增强其生存能力，增加对环境压力的抵抗力。
          </p>
          <ul class="list-disc ml-5">
            <li>
              <strong>作用机制</strong>：
              <ul class="list-disc ml-5">
                <li>主动外排：通过形成外排泵，增强细菌对外界有害物质的排除能力。</li>
                <li>协同外排：与其他外排蛋白协同工作，提高细菌对多种抗生素或毒素的耐受性。</li>
                <li>膜透过性调节：调节细菌膜的通透性，以减少有害物质的内流。</li>
              </ul>
            </li>
            <li>
              <strong>常见外排基因</strong>：
              <ul class="list-disc ml-5">
                <li> AcrAB-TolC：编码一套外排泵，能够排出多种抗生素和毒素。</li>
                <li>MexAB-OprM：存在于铜绿假单胞菌中，具有对多种β-lactam抗生素的外排能力。</li>
                <li>NorA：使某些细菌对氟喹诺酮类药物具有耐受性，增强细菌抵御药物的能力。</li>
                <li>CzrC：与锌和其他金属的外排相关，帮助细菌在重金属污染环境中生存。</li>
                <li>RND家族基因：包括多种外排蛋白家族，广泛存在于革兰氏阴性细菌中，负责多种化学物质的外排。</li>
              </ul>
            </li>
          </ul>
          <p>下列是您肠道中检出的外排基因，按照相关外排基因片段reads数量递减排列。</p>
          <!-- 在这里插入相关数据 -->
        </div>
      </div>
    </div>



    <!-- 外排基因表格 -->
    <div class="rounded-table">
      <table class="min-w-full">
        <thead>
        <tr style="background-color: #00B2B4; color: white;">
          <th class="py-2 px-4 text-left metal-tolerance-first-column"
              style="font-size: 11px;">
            来源菌株
          </th>
          <th class="py-2 px-4 text-center metal-tolerance-second-column"
              style="font-size: 11px; padding: 5px 5px;">
            相关基因
          </th>
          <th class="py-2 px-4 text-right metal-tolerance-third-column"
              style="font-size: 11px;
                    padding: 5px 20px 5px 5px;"
          >
            机制类型
          </th>
          <th class="py-2 px-4 text-center metal-tolerance-fourth-column"
              style="font-size: 11px; padding: 5px 5px;">
            reads数量
          </th>
          <th class="py-2 px-4 text-right metal-tolerance-fifth-column"
              style="font-size: 11px; padding: 5px 20px 5px 5px;">
            外排物质
          </th>
        </tr>
        </thead>
      </table>

      <div id="efflux-genes-data-table-body">
        <!-- 数据将通过 JavaScript 动态插入 -->
      </div>

      <script>
        async function loadEffluxData() {
          try {
            const response = await fetch(DATA_PATHS.DATA);
            const data = await response.json();
            data.efflux_genes_data.sort((a, b) => b.reads_count - a.reads_count);
            renderEffluxTable(data.efflux_genes_data);
          } catch (error) {
            console.error('Error loading resistance data:', error);
          }
        }

        function renderEffluxTable(resistanceData) {
          const container = document.getElementById('efflux-genes-data-table-body');
          if (!container) {
            console.error('Resistance table body not found');
            return;
          }

          container.innerHTML = '';

          resistanceData.forEach(resistance => {
            const resistanceContainer = document.createElement('div');
            resistanceContainer.className = 'resistance-info-container';

            const table = document.createElement('table');
            table.className = 'resistance-table min-w-full';

            const dataRow = `
  <tr class="resistance-row">
    <td class="py-2 px-4 text-left metal-tolerance-first-column">
      <div class="chinese-text">${resistance.chinese_name}</div>
      <div class="latin-text">${resistance.latin_name}</div>
    </td>
    <td class="py-2 px-4 text-center resistance-column-text metal-tolerance-second-column">
      <span class="resistance-gene">${resistance.resistance_gene}</span>
    </td>
    <td class="py-2 px-4 text-center resistance-column-text metal-tolerance-third-column">
      <div class="stack-container">
        ${resistance.resistance_type.map(type => `
          <div class="stack-item">${type}</div>
        `).join('')}
      </div>
    </td>
    <td class="py-2 px-4 text-center resistance-column-text metal-tolerance-fourth-column">
      <span class="reads-count ${parseInt(resistance.reads_count) > 0 ? 'high' : 'low'}">
        ${resistance.reads_count}
      </span>
    </td>
    <td class="py-2 px-4 text-center resistance-column-text metal-tolerance-fifth-column">
      <div class="stack-container">
        ${resistance.resistance_drugs.map(drug => `
          <div class="stack-item">${drug}</div>
        `).join('')}
      </div>
    </td>
  </tr>
`;

            const descRow = resistance.descriptions ? `
          <tr class="resistance-desc-row">
            <td colspan="5" class="py-2 px-4 text-left">
              <div class="description-container text-gray-600" style="font-size: 10px;">
                ${resistance.descriptions.map(desc => `
                  <div class="resistance-description">
                    <i class="fas fa-${desc.type === 'info' ? 'info-circle' : 'bell'}"
                       style="color: ${desc.color};"></i>
                    ${desc.text}
                  </div>
                `).join('')}
              </div>
            </td>
          </tr>
        ` : '';

            table.innerHTML = `<tbody>${dataRow}${descRow}</tbody>`;
            resistanceContainer.appendChild(table);
            container.appendChild(resistanceContainer);
          });
        }

        // 页面加载时加载数据
        document.addEventListener('DOMContentLoaded', loadEffluxData);
      </script>

    </div>

  </div>

  <h3 class="custom-title-third-level page-break">毒力基因分布</h3>
  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">

    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            毒力基因是指一类生物体内的基因，通过编码特定的蛋白质，使病原菌能够造成宿主细胞的伤害，从而引发感染和疾病。这些基因广泛存在于各种病原菌中，例如细菌、病毒和真菌，能够增强其致病能力和生存优势。
          </p>
          <ul class="list-disc ml-5">
            <li>
              <strong>作用机制</strong>：
              <ul class="list-disc ml-5">
                <li>细胞破坏：通过产生毒素或酶破坏宿主细胞结构，从而导致宿主细胞死亡。</li>
                <li>免疫逃逸：通过抑制宿主免疫反应，帮助病原体在宿主体内存活和繁殖。</li>
                <li>定殖能力：促进病原体在宿主组织中的定殖和生长，增强感染的能力。</li>
              </ul>
            </li>
            <li>
              <strong>常见毒力基因</strong>：
              <ul class="list-disc ml-5">
                <li>shiga toxin (stx)：由志贺氏菌产生，能够抑制宿主蛋白合成，引发严重的肠道疾病。</li>
                <li>enterotoxin (eae)：由某些大肠杆菌产生，能够引发腹泻和肠炎。</li>
                <li>cholera toxin (ctx)：由霍乱弧菌产生，导致宿主细胞大量排泄水分，造成失水和电解质紊乱。</li>
                <li>pore-forming toxins (PFTs)：能够在宿主细胞膜上形成孔洞，破坏细胞完整性。</li>
                <li>adhesin genes：促进细菌与宿主细胞结合，从而增强感染能力。</li>
              </ul>
            </li>
          </ul>
          <p>下列是您肠道中检出的毒力基因，按照相关毒力基因片段reads数量递减排列。</p>
        </div>
      </div>
    </div>

    <!-- 毒力基因表格 -->
    <div class="rounded-table">
      <table class="min-w-full">
        <thead>
        <tr style="background-color: #00B2B4; color: white;">
          <th class="py-2 px-4 text-left metal-tolerance-first-column"
              style="font-size: 11px;">
            来源菌株
          </th>
          <th class="py-2 px-4 text-center metal-tolerance-second-column"
              style="font-size: 11px; padding: 5px 5px;">
            毒力基因
          </th>
          <th class="py-2 px-4 text-right metal-tolerance-third-column"
              style="font-size: 11px;
              padding: 5px 20px 5px 5px;"
          >
            机制类型
          </th>
          <th class="py-2 px-4 text-center metal-tolerance-fourth-column"
              style="font-size: 11px; padding: 5px 5px;">
            reads数量
          </th>
          <th class="py-2 px-4 text-center metal-tolerance-fifth-column"
              style="font-size: 11px; padding: 5px 5px 5px 5px;">
            检测结果
          </th>
        </tr>
        </thead>
      </table>

      <div id="virulence-genes-data-table-body">
        <!-- 数据将通过 JavaScript 动态插入 -->
      </div>

      <script>
        async function loadVirulenceData() {
          try {
            const response = await fetch(DATA_PATHS.DATA);
            const data = await response.json();
            // data.virulence_genes_data.sort((a, b) => b.reads_count - a.reads_count);
            renderVirulenceTable(data.virulence_genes_data);
          } catch (error) {
            console.error('Error loading resistance data:', error);
          }
        }

        function renderVirulenceTable(resistanceData) {
          const container = document.getElementById('virulence-genes-data-table-body');
          if (!container) {
            console.error('Resistance table body not found');
            return;
          }

          container.innerHTML = '';

          resistanceData.forEach(resistance => {
            const resistanceContainer = document.createElement('div');
            resistanceContainer.className = 'resistance-info-container';

            const table = document.createElement('table');
            table.className = 'resistance-table min-w-full';

            // 修改 renderVirulenceTable 函数中的 dataRow 模板
            const dataRow = `
              <tr class="resistance-row">
                <td class="py-2 px-4 text-left metal-tolerance-first-column">
                  <div class="chinese-text">${resistance.chinese_name}</div>
                  <div class="latin-text">${resistance.latin_name}</div>
                </td>
                <td class="py-2 px-4 text-center resistance-column-text metal-tolerance-second-column">
                  <div class="genes-and-reads-stack-container">
                    ${resistance.resistance_gene.map(gene => `
                      <div class="stack-item">
                        <span class="resistance-gene">${gene}</span>
                      </div>
                    `).join('')}
                  </div>
                </td>
                <td class="py-2 px-4 text-center resistance-column-text metal-tolerance-third-column">
                  <div class="stack-container text-center">
                    ${resistance.resistance_type.map(type => `
                      <div class="stack-item text-center">${type}</div>
                    `).join('')}
                  </div>
                </td>
                <td class="py-2 px-4 text-center resistance-column-text metal-tolerance-fourth-column">
                  <div class="genes-and-reads-stack-container">
                    ${resistance.reads_count.map(count => `
                      <div class="stack-item">
                        <span class="reads-count ${parseInt(count) > 0 ? 'high' : 'low'}">
                          ${count}
                        </span>
                      </div>
                    `).join('')}
                  </div>
                </td>
                <td class="py-2 px-4 text-center resistance-column-text metal-tolerance-fifth-column">
                  <div class="genes-and-reads-stack-container">
                    ${resistance.resistance_drugs.map((drug, index) => `
                      <div class="stack-item">
                        <span class="reads-count ${parseInt(resistance.reads_count[index]) > 0 ? 'high' : 'low'}">
                          ${drug}
                        </span>
                      </div>
                    `).join('')}
                  </div>
                </td>
              </tr>
            `;

            table.innerHTML = `<tbody>${dataRow}</tbody>`;
            resistanceContainer.appendChild(table);
            container.appendChild(resistanceContainer);
          });
        }

        // 页面加载时加载数据
        document.addEventListener('DOMContentLoaded', loadVirulenceData);
      </script>

    </div>

  </div>

  <!-- 菌群代谢物及神经递质评估板块 ： 首页 -->

  <h1 class="custom-title-1 page-break">菌群代谢物及神经递质评估</h1>

  <div
    class="bg-white rounded-lg p-5 mb-5 mx-auto"
    style="width: 100%;"
  >

    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            菌群代谢物和神经递质是肠道微生物与宿主相互作用的重要媒介，已发现数百种不同的活性分子。这些代谢物在维持肠道健康和影响宿主生理功能方面发挥着关键作用。健康成年人肠道中的主要代谢产物包括短链脂肪酸（SCFAs）、胆汁酸、色氨酸代谢物和神经递质等。以下是对这些代谢物的详细介绍。
          </p>
        </div>
      </div>
    </div>

    <!--  免疫指标总结信息模块化图表 -->
    <div class="metabolism-card">
      <div class="metabolism-icon-box organic-acid">
        <i class="fas fa-flask"></i>
        短链脂肪酸
      </div>
      <div class="metabolism-content-box">
        短链脂肪酸（Short-Chain Fatty Acids，SCFAs）是指由2到6个碳原子组成的脂肪酸，主要在大肠内由肠道益生菌对可发酵纤维素和碳水化合物进行发酵而产生。最常见的短链脂肪酸包括乙酸、丙酸和丁酸。
      </div>
    </div>

    <div class="metabolism-card">
      <div class="metabolism-icon-box neuroactive">
        <i class="fas fa-brain"></i>
        神经活性物质
      </div>
      <div class="metabolism-content-box">
        神经活性物质包括包括神经递质（如GABA、5-HT）等，影响神经系统功能和行为调节。
      </div>
    </div>

<!--    <div class="metabolism-card">-->
<!--      <div class="metabolism-icon-box nitrogen-sulfur">-->
<!--        <i class="fas fa-atom"></i>-->
<!--        含氮含硫化合物-->
<!--      </div>-->
<!--      <div class="metabolism-content-box">-->
<!--        含氮含硫化合物包括氨基酸代谢物和含硫化合物，参与多种生理过程和代谢调节。-->
<!--      </div>-->
<!--    </div>-->

    <div class="metabolism-card">
      <div class="metabolism-icon-box other-metabolites">
        <i class="fas fa-vial"></i>
        其他代谢物
      </div>
      <div class="metabolism-content-box">
        其他代谢物包括各类次级代谢产物，在机体代谢网络中发挥多样化的调节作用。
      </div>
    </div>

  </div>

  <!-- 菌群代谢物及神经递质评估板块 : 有机酸评估 -->

  <h2 class="custom-title-1 page-break">短链脂肪酸评估</h2>
  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">
    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <i class="fas fa-info-circle icon"></i>
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            有机酸类代谢物是由肠道微生物发酵碳水化合物和蛋白质产生的重要中间产物。这些物质参与能量代谢、神经传导和免疫调节等多个生理过程。通过检测这些指标，可以评估肠道微生物的代谢活性和宿主健康状况。
          </p>
        </div>
      </div>
    </div>


    <div class="rounded-table">
      <table class="min-w-full">
        <thead>
        <tr class="bg-teal-600 text-white">
          <th class="py-2 px-4 text-left microbial-metabolites-first-column">短链脂肪酸名称</th>
          <th class="py-2 px-4 text-center microbial-metabolites-second-column">正常范围</th>
          <th class="py-2 px-4 text-center microbial-metabolites-third-column">检测丰度</th>
          <th class="py-2 px-4 text-center microbial-metabolites-fourth-column">结果评价</th>
        </tr>
        </thead>
        <tbody id="organic-acids-data-table-body">
        <!-- 数据将通过 JavaScript 动态插入 -->
        </tbody>
      </table>

      <script>
        async function loadOrganicAcidsData() {
          try {
            const response = await fetch(DATA_PATHS.DATA);
            const data = await response.json();
            renderOrganicAcidsTable(data.organic_acids_data);
          } catch (error) {
            console.error('Error loading organic acids data:', error);
          }
        }

        function renderOrganicAcidsTable(organicacidsData) {
          const tableBody = document.getElementById('organic-acids-data-table-body');
          if (!tableBody) {
            console.error('Organic acids table body not found');
            return;
          }

          tableBody.innerHTML = '';

          organicacidsData.forEach(acid => {
            // 创建数据行
            const dataRow = document.createElement('tr');
            dataRow.classList.add('organic-acids-row');
            dataRow.innerHTML = `
              <td class="py-2 px-4 text-left first-column">
                <div class="chinese-text">${acid.chinese_name}</div>
                <div class="latin-text">${acid.latin_name}</div>
              </td>
              <td class="py-2 px-4 text-center column-text">${acid.normal_range}</td>
              <td class="py-2 px-4 text-center column-text">
                ${acid.detected_abundance}
                <div class="progress-bar w-full mt-1">
                  <div class="progress" style="width: ${acid.progress_percentage}%;"></div>
                </div>
              </td>
              <td class="py-2 px-4 text-center bold-text text-${acid.evaluation.color}-600 column-text">
                ${acid.evaluation.status}
              </td>
            `;

            // 创建描述行
            const descRow = document.createElement('tr');
            descRow.classList.add('organic-acids-row');
            descRow.innerHTML = `
              <td colspan="6" class="py-2 px-4 text-left">
                <div class="description-container text-gray-600">
                  ${acid.descriptions.map(desc => `
                    <div class="organic-acids-description">
                      <i class="fas fa-${desc.type === 'info' ? 'info-circle' : 'exclamation-triangle'}"
                         style="color: ${desc.color};"></i>
                      ${desc.text}
                    </div>
                  `).join('')}
                </div>
              </td>
            `;

            // 添加到表格
            tableBody.appendChild(dataRow);
            tableBody.appendChild(descRow);
          });
        }

        // 页面加载时加载有机酸数据
        document.addEventListener('DOMContentLoaded', loadOrganicAcidsData);
      </script>

    </div>
  </div>

  <!-- 菌群代谢物及神经递质评估板块 : 神经活性物质评估 -->

  <h2 class="custom-title-1 page-break">神经活性物质评估</h2>
  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">
    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <i class="fas fa-info-circle icon"></i>
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            神经活性物质是一类在神经系统中发挥重要作用的化学物质，包括神经递质和激素。这些物质参与调节情绪、认知、行为和内分泌功能。通过检测这些指标，可以评估神经系统功能状态和神经内分泌平衡。
          </p>
        </div>
      </div>
    </div>

    <div class="rounded-table">
      <table class="min-w-full">
        <thead>
        <tr class="bg-teal-600 text-white">
          <th class="py-2 px-4 text-left microbial-metabolites-first-column">神经活性物质名称</th>
          <th class="py-2 px-4 text-center microbial-metabolites-second-column">正常范围</th>
          <th class="py-2 px-4 text-center microbial-metabolites-third-column">评估数值</th>
          <th class="py-2 px-4 text-center microbial-metabolites-fourth-column">评估结果</th>
        </tr>
        </thead>
        <tbody id="neuroactive-substances-data-table-body">
        <!-- 数据将通过 JavaScript 动态插入 -->
        </tbody>
      </table>

      <script>
        async function loadNeuroActiveData() {
          try {
            const response = await fetch(DATA_PATHS.DATA);
            const data = await response.json();
            renderNeuroActiveTable(data.neuroactive_substances_data);
          } catch (error) {
            console.error('Error loading neuroactive-substances data:', error);
          }
        }

        function renderNeuroActiveTable(organicacidsData) {
          const tableBody = document.getElementById('neuroactive-substances-data-table-body');
          if (!tableBody) {
            console.error('Neuroactive-substances table body not found');
            return;
          }

          tableBody.innerHTML = '';

          organicacidsData.forEach(neuroactive => {
            // 创建数据行
            const dataRow = document.createElement('tr');
            dataRow.classList.add('neuroactive-substances-data-row');
            dataRow.innerHTML = `
              <td class="py-2 px-4 text-left first-column">
                <div class="chinese-text">${neuroactive.chinese_name}</div>
                <div class="latin-text">${neuroactive.latin_name}</div>
              </td>
              <td class="py-2 px-4 text-center column-text">${neuroactive.normal_range}</td>
              <td class="py-2 px-4 text-center column-text">
                ${neuroactive.detected_abundance}
                <div class="progress-bar w-full mt-1">
                  <div class="progress" style="width: ${neuroactive.progress_percentage}%;"></div>
                </div>
              </td>
              <td class="py-2 px-4 text-center bold-text text-${neuroactive.evaluation.color}-600 column-text">
                ${neuroactive.evaluation.status}
              </td>
            `;

            // 创建描述行
            const descRow = document.createElement('tr');
            descRow.classList.add('neuroactive-substances-data-row');
            descRow.innerHTML = `
              <td colspan="6" class="py-2 px-4 text-left">
                <div class="description-container text-gray-600">
                  ${neuroactive.descriptions.map(desc => `
                    <div class="organic-acids-description">
                      <i class="fas fa-${desc.type === 'info' ? 'info-circle' : 'exclamation-triangle'}"
                         style="color: ${desc.color};"></i>
                      ${desc.text}
                    </div>
                  `).join('')}
                </div>
              </td>
            `;

            // 添加到表格
            tableBody.appendChild(dataRow);
            tableBody.appendChild(descRow);
          });
        }

        // 页面加载时加载有机酸数据
        document.addEventListener('DOMContentLoaded', loadNeuroActiveData);
      </script>

    </div>
  </div>

  <!-- 菌群代谢物及神经递质评估板块 : 含氮/含硫化合物评估物质 -->

<!--  <h2 class="custom-title-1 page-break">含氮/含硫化合物评估</h2>-->
<!--  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">-->
<!--    &lt;!&ndash; 信息框 &ndash;&gt;-->
<!--    <div class="info-box">-->
<!--      <div class="flex items-start">-->
<!--        <i class="fas fa-info-circle icon"></i>-->
<!--        <div class="ml-2">-->
<!--          <p class="text-lg text-custom-teal">-->
<!--            神经活性物质是一类在神经系统中发挥重要作用的化学物质，包括神经递质和激素。这些物质参与调节情绪、认知、行为和内分泌功能。通过检测这些指标，可以评估神经系统功能状态和神经内分泌平衡。-->
<!--          </p>-->
<!--        </div>-->
<!--      </div>-->
<!--    </div>-->

<!--    <div class="rounded-table">-->
<!--      <table class="min-w-full">-->
<!--        <thead>-->
<!--        <tr class="bg-teal-600 text-white">-->
<!--          <th class="py-2 px-4 text-left microbial-metabolites-first-column">化合物名称</th>-->
<!--          <th class="py-2 px-4 text-center microbial-metabolites-second-column">正常范围</th>-->
<!--          <th class="py-2 px-4 text-center microbial-metabolites-third-column">评估数值</th>-->
<!--          <th class="py-2 px-4 text-center microbial-metabolites-fourth-column">评估结果</th>-->
<!--        </tr>-->
<!--        </thead>-->
<!--        <tbody id="compounds-data-table-body">-->
<!--        &lt;!&ndash; 数据将通过 JavaScript 动态插入 &ndash;&gt;-->
<!--        </tbody>-->
<!--      </table>-->

<!--      <script>-->
<!--        async function loadCompoundsData() {-->
<!--          try {-->
<!--            const response = await fetch(DATA_PATHS.DATA);-->
<!--            const data = await response.json();-->
<!--            renderCompoundsTable(data.compounds_data);-->
<!--          } catch (error) {-->
<!--            console.error('Error loading compounds data:', error);-->
<!--          }-->
<!--        }-->

<!--        function renderCompoundsTable(organicacidsData) {-->
<!--          const tableBody = document.getElementById('compounds-data-table-body');-->
<!--          if (!tableBody) {-->
<!--            console.error('Compounds table body not found');-->
<!--            return;-->
<!--          }-->

<!--          tableBody.innerHTML = '';-->

<!--          organicacidsData.forEach(compounds => {-->
<!--            // 创建数据行-->
<!--            const dataRow = document.createElement('tr');-->
<!--            dataRow.classList.add('compounds-data-row');-->
<!--            dataRow.innerHTML = `-->
<!--              <td class="py-2 px-4 text-left first-column">-->
<!--                <div class="chinese-text">${compounds.chinese_name}</div>-->
<!--                <div class="latin-text">${compounds.latin_name}</div>-->
<!--              </td>-->
<!--              <td class="py-2 px-4 text-center column-text">${compounds.normal_range}</td>-->
<!--              <td class="py-2 px-4 text-center column-text">-->
<!--                ${compounds.detected_abundance}-->
<!--                <div class="progress-bar w-full mt-1">-->
<!--                  <div class="progress" style="width: ${compounds.progress_percentage}%;"></div>-->
<!--                </div>-->
<!--              </td>-->
<!--              <td class="py-2 px-4 text-center bold-text text-${compounds.evaluation.color}-600 column-text">-->
<!--                ${compounds.evaluation.status}-->
<!--              </td>-->
<!--            `;-->

<!--            // 创建描述行-->
<!--            const descRow = document.createElement('tr');-->
<!--            descRow.classList.add('compounds-data-row');-->
<!--            descRow.innerHTML = `-->
<!--              <td colspan="6" class="py-2 px-4 text-left">-->
<!--                <div class="description-container text-gray-600">-->
<!--                  ${compounds.descriptions.map(desc => `-->
<!--                    <div class="organic-acids-description">-->
<!--                      <i class="fas fa-${desc.type === 'info' ? 'info-circle' : 'exclamation-triangle'}"-->
<!--                         style="color: ${desc.color};"></i>-->
<!--                      ${desc.text}-->
<!--                    </div>-->
<!--                  `).join('')}-->
<!--                </div>-->
<!--              </td>-->
<!--            `;-->

<!--            // 添加到表格-->
<!--            tableBody.appendChild(dataRow);-->
<!--            tableBody.appendChild(descRow);-->
<!--          });-->
<!--        }-->

<!--        // 页面加载时加载有机酸数据-->
<!--        document.addEventListener('DOMContentLoaded', loadCompoundsData);-->
<!--      </script>-->

<!--    </div>-->
<!--  </div>-->

  <!-- 菌群代谢物及神经递质评估板块 : 其他代谢物评估 -->

  <h2 class="custom-title-1 page-break">其他代谢物评估</h2>
  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">
    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <i class="fas fa-info-circle icon"></i>
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            其他代谢物包含了以下的这些指标。
          </p>
        </div>
      </div>
    </div>

    <!-- 其他代谢物表格 -->
    <div class="rounded-table">
      <table class="min-w-full">
        <thead>
        <tr style="background-color: #00B2B4; color: white;">
          <th class="py-2 px-4 text-left other-microbial-metabolites-first-column"
              style="font-size: 13px;">
            其他代谢物名称
          </th>
          <th class="py-2 px-4 text-center other-microbial-metabolites-second-column"
              style="font-size: 13px; padding: 5px 5px;">
            参考范围
          </th>
          <th class="py-2 px-4 text-center other-microbial-metabolites-third-column"
              style="font-size: 13px; padding: 5px 5px;">
            评估数值
          </th>
          <th class="py-2 px-4 text-center other-microbial-metabolites-fourth-column"
              style="font-size: 13px; padding: 5px 5px;">
            评估结果
          </th>
        </tr>
        </thead>
      </table>

      <div id="other-metabolites-data-table-body">
        <!-- Data rows will be generated by Javascript code dynamically -->
      </div>
    </div>

    <script>
      async function loadOtherMetabolitesData() {
        try {
          const response = await fetch(DATA_PATHS.DATA);
          const data = await response.json();
          renderOtherMetabolitesTable(data.other_metabolites_data);
        } catch (error) {
          console.error('Error loading other metabolites data:', error);
        }
      }

      function getStatusColor(detected, min, max) {
        const CUSTOM_COLORS = {
          red: '#ff4d4f',
          green: '#389e0d',
          gray: '#808080'
        };

        if (detected < min) return CUSTOM_COLORS.red;
        if (detected > max) return CUSTOM_COLORS.red;
        return CUSTOM_COLORS.green;
      }

      function getStatusText(detected, min, max) {
        if (detected < min) return '偏低';
        if (detected > max) return '超标';
        return '正常';
      }

      function getStatusIcon(status) {
        if (status === '偏低') {
          return '<i class="fas fa-arrow-down ml-1"></i>';
        } else if (status === '超标') {
          return '<i class="fas fa-arrow-up ml-1"></i>';
        }
        return '';
      }

      function formatNumber(value) {
        if (value === "ND" || value === "未检出" || value === 0) {
          return "未检出";
        }

        const num = Number(value);

        if (num >= 1) {
          const integerDigits = Math.floor(Math.log10(num)) + 1;
          const decimalPlaces = Math.max(0, 4 - integerDigits);
          return num.toFixed(decimalPlaces);
        } else {
          const str = num.toPrecision(4);
          return str.replace(/\.?0+$/, '');
        }
      }

      function calculateProgressPercentage(value, maxValue) {
        if (value === "ND" || value === 0) {
          return 0;
        }
        const percentage = (value / maxValue) * 50; // 最大宽度设为50%
        return Math.max(5, Math.min(50, percentage));
      }

      function renderOtherMetabolitesTable(organicacidsData) {
        const container = document.getElementById('other-metabolites-data-table-body');
        if (!container) {
          console.error('Metabolites table body not found');
          return;
        }

        container.innerHTML = '';

        organicacidsData.forEach(other => {
          const metabolitesContainer = document.createElement('div');
          metabolitesContainer.className = 'bacteria-info-container';

          const table = document.createElement('table');
          table.className = 'bacteria-table min-w-full';

          const min = other.normal_range.normal_range_min;
          const max = other.normal_range.normal_range_max;
          const detected = other.detected_abundance;
          const status = getStatusText(detected, min, max);
          const isNormal = status === '正常';

          const dataRow = `
        <tr class="metabolites-row">
          <td class="py-2 px-4 text-left other-microbial-metabolites-first-column">
            <div class="chinese-text">${other.chinese_name}</div>
            <div class="latin-text">${other.latin_name}</div>
          </td>
          <td class="py-2 px-4 text-center column-text other-microbial-metabolites-second-column" style="font-size: 0.65rem;">
            ${min}-${max}
          </td>
          <td class="py-2 px-4 text-center column-text other-microbial-metabolites-third-column" style="font-size: 0.65rem;">
            ${formatNumber(detected)}
            <div class="progress-bar w-full mt-2">
              <div class="progress"
                   style="width: ${calculateProgressPercentage(detected, max)}%;
                          background-color: #00B2B4;
                          transition: width 0.3s ease;">
              </div>
            </div>
          </td>
          <td class="py-2 px-4 text-center bold-text column-text other-microbial-metabolites-fourth-column" style="font-size: 0.65rem;">
            <span style="color: ${getStatusColor(detected, min, max)}">
              ${status}${getStatusIcon(status)}
            </span>
          </td>
        </tr>
      `;

          const filteredDescriptions = other.descriptions.filter(desc =>
            desc.type === 'info' || (!isNormal && desc.type === 'warning')
          );

          const descRow = filteredDescriptions.length > 0 ? `
    <tr class="virus-desc-row">
        <td colspan="4" class="py-2 px-4 text-left">
            <div class="description-container text-gray-600" style="font-size: 10px;">
                ${filteredDescriptions.map(desc => `
                    <div class="flex items-start">
                        <div class="ml-1">
                            <p>
                                <i class="fas fa-${desc.type === 'info' ? 'info-circle' : 'bell'}"
                                   style="color: ${desc.color};">
                                </i>
                                ${desc.text}
                                ${!desc.hideImpacts ? `
                                    <div class="ml-1 mt-1">
                                        • <strong>超标的影响：</strong> 超标可能导致健康风险，包括但不限于心脏病、高血压及其他代谢性疾病。<br>
                                        • <strong>偏低的影响：</strong> 偏低的水平可能导致营养不足、免疫力下降以及其他相关健康问题。
                                    </div>
                                ` : ''}
                            </p>
                        </div>
                    </div>
                `).join('')}
            </div>
        </td>
    </tr>
` : '';

          table.innerHTML = `<tbody>${dataRow}${descRow}</tbody>`;
          metabolitesContainer.appendChild(table);
          container.appendChild(metabolitesContainer);
        });
      }

      // 页面加载时加载数据
      document.addEventListener('DOMContentLoaded', loadOtherMetabolitesData);
    </script>
  </div>

  <!-- 免疫指标评估板块 : 首页 -->

  <h1 class="custom-title-1 page-break">免疫指标评估</h1>
  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">

    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            <strong>免疫指标</strong>是评估免疫系统的核心参数，涵盖体液免疫（IgG/IgA/IgM、补体系统）、细胞免疫（T/B/NK细胞及IL-6/TNF-α等因子）及免疫代谢网络，其中免疫球蛋白与免疫细胞承担80%以上的特异性防御功能。研究揭示肠道菌群通过短链脂肪酸等代谢产物，直接激活树突状细胞促进IgA分泌，并调控Th17/Treg平衡影响IL-10/IL-17表达，形成菌群-免疫互作网络。这种协同作用既维持免疫活性（吞噬指数、补体效价），又保障免疫特异性（抗体亲和力、TCR多样性），其代谢产物丁酸盐可同步提升NK细胞活性并抑制过度炎症反应，构成免疫稳态的双向调节枢纽。
          </p>
        </div>
      </div>
    </div>

    <!--  免疫指标总结信息模块化图表 -->
    <div class="immunity-card">
      <div class="immunity-icon-box immune">
        <i class="fas fa-shield-virus"></i>
        体液免疫
      </div>
      <div class="immunity-content-box">
        体液免疫是机体重要的防御系统，主要由免疫球蛋白（IgA、IgG、IgM 等）和补体系统（C3、C4 等）构成。其中，免疫球蛋白能特异性识别和中和病原体，而补体系统则通过级联反应增强免疫应答，共同构成体液免疫防御网络。
      </div>
    </div>

    <div class="immunity-card">
      <div class="immunity-icon-box inflammation">
        <i class="fas fa-fire"></i>
        炎症感染
      </div>
      <div class="immunity-content-box">
        炎症指标是反映机体炎症状态的重要生物标志物，主要包括急性时相蛋白（如 CRP、SAA）、促炎因子（IL-1β、IL-6、TNF-α 等）和抗炎因子（IL-10、TGF-β 等）。这些指标能够及时反映机体的炎症水平和免疫状态，是疾病诊断和预后评估的重要依据。
      </div>
    </div>

    <div class="immunity-card">
      <div class="immunity-icon-box metabolism">
        <i class="fas fa-flask"></i>
        菌群代谢
      </div>
      <div class="immunity-content-box">
        代谢物质是肠道菌群与宿主互作的关键媒介，主要包括短链脂肪酸（乙酸盐、丙酸盐、丁酸盐）、胆汁酸代谢物、色氨酸代谢物和神经递质（GABA、5-HT 等）。这些代谢产物不仅参与能量代谢，还具有调节免疫、影响神经功能等多重生物学作用。
      </div>
    </div>

    <div class="immunity-card">
      <div class="immunity-icon-box cytokine">
        <i class="fas fa-dna"></i>
        细胞因子
      </div>
      <div class="immunity-content-box">
        细胞因子是一类调节免疫和炎症反应的小分子蛋白，主要包括白介素家族（IL-1β、IL-6、IL-10 等）、肿瘤坏死因子（TNF-α）和转化生长因子（TGF-β）等。它们作为免疫细胞间的信使分子，在免疫应答、炎症调控和组织修复中发挥关键作用。
      </div>
    </div>

    <div class="immunity-card">
      <div class="immunity-icon-box cancer">
        <i class="fas fa-microscope"></i>
        免疫肿瘤
      </div>
      <div class="immunity-content-box">
        免疫系统是机体抵抗肿瘤的重要防线，通过免疫监视、免疫编辑和免疫清除等机制识别和消灭肿瘤细胞。肿瘤免疫涉及天然免疫和适应性免疫多个组分，包括 NK 细胞、T 细胞、树突状细胞等免疫细胞以及细胞因子网络。
      </div>
    </div>


  </div>

  <!-- 免疫指标评估板块 : 体液免疫评估 -->

  <h2 class="custom-title-1 page-break">体液免疫评估</h2>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">

    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            体液免疫是机体重要的防御系统，通过产生多种免疫活性物质来识别和清除病原体。通过检测这些指标，可以评估机体的免疫防御能力和炎症状态。
          </p>
        </div>
      </div>
    </div>

    <!-- 体液免疫评估 -->
    <div class="rounded-table">
      <table class="min-w-full">
        <thead>
        <tr style="background-color: #00B2B4; color: white;">
          <th class="py-2 px-4 text-left immunity-first-column" style="font-size: 11px;">神经活性物质名称</th>
          <th class="py-2 px-4 text-center immunity-second-column" style="font-size: 11px; padding: 5px 5px;">正常范围</th>
          <th class="py-2 px-4 text-center immunity-third-column" style="font-size: 11px; padding: 5px 5px;">评估数值</th>
          <th class="py-2 px-4 text-center immunity-fourth-column" style="font-size: 11px; padding: 5px 5px;">评估结果</th>
        </tr>
        </thead>
      </table>

      <div id="humoral-immunity-data-table-body">
        <!-- 数据将通过 JavaScript 动态插入 -->
      </div>
    </div>

    <script>
      async function loadHumoralImmunityData() {
        try {
          const response = await fetch(DATA_PATHS.DATA);
          const data = await response.json();
          renderHumoralImmunityTable(data.humoral_immunity_data);
        } catch (error) {
          console.error('Error loading humoral immunity data:', error);
        }
      }

      // 添加测试函数
      // 更新测试函数，添加更多测试用例
      function runTests() {
        console.log('%c=== 开始进行计算测试 ===', 'background: #222; color: #bada55; padding: 5px;');

        const testCases = [
          { detected: 62, maxRange: 98, expected: 63.27 },
          { detected: 7, maxRange: 98, expected: 7.14 },
          { detected: 11, maxRange: 98, expected: 11.22 },
          { detected: "ND", maxRange: 98, expected: 0 },
          { detected: 0, maxRange: 98, expected: 0 },
          { detected: "62", maxRange: "98", expected: 63.27 }, // 字符串输入测试
          { detected: 62.5, maxRange: 98, expected: 63.78 }    // 小数测试
        ];

        let passedTests = 0;
        const totalTests = testCases.length;

        testCases.forEach((testCase, index) => {
          console.log(`\n%c测试用例 ${index + 1}`, 'color: #4CAF50; font-weight: bold;');

          const result = calculateProgressPercentage(testCase.detected, testCase.maxRange);
          const isClose = Math.abs(result - testCase.expected) < 0.1;

          console.log('测试结果:', {
            输入值: { detected: testCase.detected, maxRange: testCase.maxRange },
            预期结果: testCase.expected,
            实际结果: result,
            是否通过: isClose ? '✅ 通过' : '❌ 失败',
            误差: Math.abs(result - testCase.expected).toFixed(2)
          });

          if (isClose) passedTests++;
        });

        console.log(`\n%c测试总结: ${passedTests}/${totalTests} 通过`,
          `color: ${passedTests === totalTests ? '#4CAF50' : '#f44336'}; font-weight: bold;`);
      }

      function calculateProgressPercentage(detected, maxRange) {
        // 1. 特殊值处理
        if (detected === "ND" || detected === 0 || detected === "0") {
          return 0;
        }

        // 2. 确保输入值为数字
        const detectedValue = parseFloat(detected);
        const maxRangeValue = parseFloat(maxRange);

        // 3. 检查输入值是否有效
        if (isNaN(detectedValue) || isNaN(maxRangeValue) || maxRangeValue <= 0) {
          console.error('无效的输入值:', { detected, maxRange });
          return 0;
        }

        // 4. 计算百分比
        const percentage = (detectedValue) * 100;

        // 5. 返回结果（保留两位小数）
        return parseFloat(percentage.toFixed(2));
      }

      function getProgressBarColor(detected, minRange, maxRange) {
        if (detected >= minRange && detected <= maxRange) {
          return '#389e0d'; // 绿色
        }
        return '#ff4d4f'; // 红色
      }

      function renderHumoralImmunityTable(humoralData) {
        const container = document.getElementById('humoral-immunity-data-table-body');
        if (!container) {
          console.error('Humoral immunity table body not found');
          return;
        }

        container.innerHTML = '';

        const CUSTOM_COLORS = {
          red: '#ff4d4f',
          green: '#389e0d',
          gray: '#808080'
        };

        humoralData.forEach(humoral => {
          console.group(`处理: ${humoral.chinese_name}`);
          console.log('原始数据:', {
            名称: humoral.chinese_name,
            检测值: humoral.detected_abundance,
            范围: `${humoral.normal_range.normal_range_min}-${humoral.normal_range.normal_range_max}`
          });

          let statusColor, statusText, statusIcon;
          const detected = humoral.detected_abundance;
          const minRange = humoral.normal_range.normal_range_min;
          const maxRange = humoral.normal_range.normal_range_max;

          const formattedDetectedValue = detected === "ND" ? "未检出" : detected;
          const formattedMinRange = minRange;
          const formattedMaxRange = maxRange;

          let isNormal = true;

          if (detected === "ND") {
            if (minRange > 0) {
              statusColor = 'red';
              statusText = '偏低';
              statusIcon = '<i class="fas fa-arrow-down ml-1"></i>';
              isNormal = false;
            } else {
              statusColor = 'green';
              statusText = '正常';
              statusIcon = '';
            }
          } else if (detected < minRange) {
            statusColor = 'red';
            statusText = '偏低';
            statusIcon = '<i class="fas fa-arrow-down ml-1"></i>';
            isNormal = false;
          } else if (detected <= maxRange) {
            statusColor = 'green';
            statusText = '正常';
            statusIcon = '';
          } else {
            statusColor = 'red';
            statusText = '超标';
            statusIcon = '<i class="fas fa-arrow-up ml-1"></i>';
            isNormal = false;
          }

          const progressPercentage = calculateProgressPercentage(detected, maxRange);
          const progressBarColor = getProgressBarColor(detected, minRange, maxRange);

          console.log('进度条计算:', {
            检测值: detected,
            最大值: maxRange,
            计算结果: progressPercentage,
            预期结果: (Number(detected) / Number(maxRange)) * 100,
            进度条颜色: progressBarColor
          });

          const humoralContainer = document.createElement('div');
          humoralContainer.className = 'bacteria-info-container';

          const table = document.createElement('table');
          table.className = 'humoral-table min-w-full';

          const dataRow = `
                    <tr class="humoral-row">
                        <td class="py-2 px-4 text-left immunity-first-column">
                            <div class="chinese-text">${humoral.chinese_name}</div>
                            <div class="latin-text">${humoral.latin_name}</div>
                        </td>
                        <td class="py-2 px-4 text-center immunity-column-text immunity-second-column">
                            ${formattedMinRange}-${formattedMaxRange}
                        </td>
                        <td class="py-2 px-4 text-center immunity-column-text immunity-third-column">
                            ${formattedDetectedValue}
                            <div class="progress-bar w-full mt-2">
    <div class="progress"
         style="width: ${!humoral.detected_abundance || humoral.detected_abundance === 'ND' || humoral.detected_abundance === 0
            ? 0
            : (humoral.detected_abundance / humoral.normal_range.normal_range_max * 100)}%;
                background-color: ${progressBarColor};
                transition: width 0.3s ease;">
    </div>
</div>

                        </td>
                        <td class="py-2 px-4 text-center bold-text immunity-fourth-column immunity-column-text">
                            <span style="color: ${CUSTOM_COLORS[statusColor]}">
                                ${statusText}${statusIcon}
                            </span>
                        </td>
                    </tr>
                `;

          const filteredDescriptions = humoral.descriptions.filter(desc =>
            desc.type === 'info' || (!isNormal && desc.type === 'warning')
          );

          const descRow = filteredDescriptions.length > 0 ? `
                    <tr class="humoral-desc-row">
                        <td colspan="4" class="py-2 px-4 text-left">
                            <div class="description-container text-gray-600" style="font-size: 10px;">
                                ${filteredDescriptions.map(desc => `
                                    <div class="humoral-description">
                                        <i class="fas fa-${desc.type === 'info' ? 'info-circle' : 'bell'}"
                                           style="color: ${desc.color};"></i>
                                        ${desc.text}
                                    </div>
                                `).join('')}
                            </div>
                        </td>
                    </tr>
                ` : '';

          table.innerHTML = `<tbody>${dataRow}${descRow}</tbody>`;
          humoralContainer.appendChild(table);
          container.appendChild(humoralContainer);

          console.groupEnd();
        });
      }

      // 页面加载时运行测试和主程序
      document.addEventListener('DOMContentLoaded', () => {
        console.clear(); // 清除之前的控制台输出
        runTests(); // 先运行测试
        console.log('\n%c=== 开始加载实际数据 ===', 'background: #222; color: #bada55; padding: 5px;');
        loadHumoralImmunityData(); // 然后加载实际数据
      });
    </script>
  </div>

  <!-- 免疫指标评估板块 : 炎症感染评估 -->

  <h2 class="custom-title-1 page-break">炎症感染指标评估</h2>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">

    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            炎症标志物是评估机体炎症状态的重要指标。通过检测不同的炎症标志物，可以了解系统的炎症程度。
          </p>
        </div>
      </div>
    </div>

    <!-- 炎症感染评估表格 -->
    <div class="rounded-table">
      <table class="min-w-full">
        <thead>
        <tr style="background-color: #00B2B4; color: white;">
          <th
            class="py-2 px-4 text-left immunity-first-column"
            style="font-size: 11px;">
            炎症感染指标
          </th>
          <th
            class="py-2 px-4 text-center immunity-second-column"
            style="font-size: 11px;
                  padding: 5px 5px;">
            正常范围
          </th>
          <th
            class="py-2 px-4 text-center immunity-third-column"
            style="font-size: 11px;
                  padding: 5px 5px;">
            评估数值
          </th>
          <th
            class="py-2 px-4 text-center immunity-fourth-column"
            style="font-size: 11px;
                  padding: 5px 5px;">
            评估结果
          </th>
        </tr>
        </thead>
      </table>

      <div id="inflammatory-infection-data-table-body">
        <!-- 数据将通过 JavaScript 动态插入 -->
      </div>
    </div>

    <script>
      async function loadInflammatoryInfectionData() {
        try {
          const response = await fetch(DATA_PATHS.DATA);
          const data = await response.json();
          renderInflammatoryInfectionTable(data.inflammatory_infection_data);
        } catch (error) {
          console.error('Error loading inflammatory infection data:', error);
        }
      }

      function calculateProgressPercentage(detected, maxRange) {
        if (detected === "ND" || detected === 0 || detected === "0") {
          return 0;
        }

        const detectedValue = parseFloat(detected);
        const maxRangeValue = parseFloat(maxRange);

        if (isNaN(detectedValue) || isNaN(maxRangeValue) || maxRangeValue <= 0) {
          console.error('无效的输入值:', { detected, maxRange });
          return 0;
        }

        const percentage = (detectedValue / maxRangeValue) * 100;
        return parseFloat(percentage.toFixed(2));
      }

      function getProgressBarColor(detected, minRange, maxRange) {
        if (detected >= minRange && detected <= maxRange) {
          return '#389e0d'; // 绿色
        }
        return '#ff4d4f'; // 红色
      }

      function renderInflammatoryInfectionTable(inflammatoryData) {
        const container = document.getElementById('inflammatory-infection-data-table-body');
        if (!container) {
          console.error('Inflammatory infection table body not found');
          return;
        }

        container.innerHTML = '';

        const CUSTOM_COLORS = {
          red: '#ff4d4f',
          green: '#389e0d',
          gray: '#808080'
        };

        inflammatoryData.forEach(inflammatory => {
          console.group(`处理: ${inflammatory.chinese_name}`);

          let statusColor, statusText, statusIcon;
          const detected = inflammatory.detected_abundance;
          const minRange = inflammatory.normal_range.normal_range_min;
          const maxRange = inflammatory.normal_range.normal_range_max;

          const formattedDetectedValue = detected === "ND" ? "未检出" : detected;
          const formattedMinRange = minRange;
          const formattedMaxRange = maxRange;

          let isNormal = true;

          if (detected === "ND") {
            if (minRange > 0) {
              statusColor = 'red';
              statusText = '偏低';
              statusIcon = '<i class="fas fa-arrow-down ml-1"></i>';
              isNormal = false;
            } else {
              statusColor = 'green';
              statusText = '正常';
              statusIcon = '';
            }
          } else if (detected < minRange) {
            statusColor = 'red';
            statusText = '偏低';
            statusIcon = '<i class="fas fa-arrow-down ml-1"></i>';
            isNormal = false;
          } else if (detected <= maxRange) {
            statusColor = 'green';
            statusText = '正常';
            statusIcon = '';
          } else {
            statusColor = 'red';
            statusText = '超标';
            statusIcon = '<i class="fas fa-arrow-up ml-1"></i>';
            isNormal = false;
          }

          const progressPercentage = calculateProgressPercentage(detected, maxRange);
          const progressBarColor = getProgressBarColor(detected, minRange, maxRange);

          const inflammatoryContainer = document.createElement('div');
          inflammatoryContainer.className = 'inflammatory-info-container';

          const table = document.createElement('table');
          table.className = 'inflammatory-table min-w-full';

          const dataRow = `
          <tr class="inflammatory-row">
            <td class="py-2 px-4 text-left immunity-first-columnn">
              <div class="chinese-text">${inflammatory.chinese_name}</div>
              <div class="latin-text">${inflammatory.latin_name}</div>
            </td>
            <td class="py-2 px-4 text-center immunity-column-text immunity-second-column">
              ${formattedMinRange}-${formattedMaxRange}
            </td>
            <td class="py-2 px-4 text-center immunity-column-text immunity-third-column">
              ${formattedDetectedValue}
              <div class="progress-bar w-full mt-2">
                <div class="progress"
     style="width: ${!inflammatory.detected_abundance || inflammatory.detected_abundance === 'ND' || inflammatory.detected_abundance === 0
            ? 0
            : (inflammatory.detected_abundance / inflammatory.normal_range.normal_range_max * 100)}%;
            background-color: ${progressBarColor};
            transition: width 0.3s ease;">
</div>

              </div>
            </td>
            <td class="py-2 px-4 text-center bold-text immunity-fourth-column immunity-column-text">
              <span style="color: ${CUSTOM_COLORS[statusColor]}">
                ${statusText}${statusIcon}
              </span>
            </td>
          </tr>
        `;

          const filteredDescriptions = inflammatory.descriptions.filter(desc =>
            desc.type === 'info' || (!isNormal && desc.type === 'warning')
          );

          const descRow = filteredDescriptions.length > 0 ? `
          <tr class="inflammatory-desc-row">
            <td colspan="6" class="py-2 px-4 text-left">
              <div class="description-container text-gray-600" style="font-size: 10px;">
                ${filteredDescriptions.map(desc => `
                  <div class="inflammatory-description">
                    <i class="fas fa-${desc.type === 'info' ? 'info-circle' : 'bell'}"
                       style="color: ${desc.color};"></i>
                    ${desc.text}
                  </div>
                `).join('')}
              </div>
            </td>
          </tr>
        ` : '';

          table.innerHTML = `<tbody>${dataRow}${descRow}</tbody>`;
          inflammatoryContainer.appendChild(table);
          container.appendChild(inflammatoryContainer);

          console.groupEnd();
        });
      }

      // 页面加载时加载数据
      document.addEventListener('DOMContentLoaded', loadInflammatoryInfectionData);
    </script>

  </div>

  <!-- 免疫指标评估板块 : 菌群代谢物评估 -->

  <h2 class="custom-title-1 page-break">菌群代谢物指标评估</h2>
  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">
    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            肠道菌群代谢物是评估肠道健康和免疫功能的重要指标。这些指标可以反应肠道微生态平衡状况和炎症反应水平。
          </p>
        </div>
      </div>
    </div>

    <div class="rounded-table">
      <table class="min-w-full">
        <thead>
        <tr style="background-color: #00B2B4; color: white;">
          <th class="py-2 px-4 text-left immunity-first-column"
              style="font-size: 11px;">
            菌群代谢物指标
          </th>
          <th class="py-2 px-4 text-center immunity-second-column"
              style="font-size: 11px; padding: 5px 5px;">
            正常范围
          </th>
          <th class="py-2 px-4 text-center immunity-third-column"
              style="font-size: 11px; padding: 5px 5px;">
            评估数值
          </th>
          <th class="py-2 px-4 text-center immunity-fourth-column"
              style="font-size: 11px; padding: 5px 5px;">
            评估结果
          </th>
        </tr>
        </thead>
      </table>

      <div id="microbial-metabolites-data-table-body">
        <!-- 数据将通过 JavaScript 动态插入 -->
      </div>

      <script>
        async function loadMicrobialMetabolitesData() {
          try {
            const response = await fetch(DATA_PATHS.DATA);
            const data = await response.json();
            renderMicrobialMetabolitesTable(data.microbial_metabolites_data);
          } catch (error) {
            console.error('Error loading microbial metabolites data:', error);
          }
        }

        function calculateProgressPercentage(detected, maxRange) {
          if (detected === "ND" || detected === 0 || detected === "0") {
            return 0;
          }

          const detectedValue = parseFloat(detected);
          const maxRangeValue = parseFloat(maxRange);

          if (isNaN(detectedValue) || isNaN(maxRangeValue) || maxRangeValue <= 0) {
            console.error('无效的输入值:', { detected, maxRange });
            return 0;
          }

          const percentage = (detectedValue / maxRangeValue) * 100;
          return parseFloat(percentage.toFixed(2));
        }

        function getProgressBarColor(detected, minRange, maxRange) {
          if (detected >= minRange && detected <= maxRange) {
            return '#389e0d'; // 绿色
          }
          return '#ff4d4f'; // 红色
        }

        function renderMicrobialMetabolitesTable(metabolitesData) {
          const container = document.getElementById('microbial-metabolites-data-table-body');
          if (!container) {
            console.error('Microbial metabolites table body not found');
            return;
          }

          container.innerHTML = '';

          const CUSTOM_COLORS = {
            red: '#ff4d4f',
            green: '#389e0d',
            gray: '#808080'
          };

          metabolitesData.forEach(metabolite => {
            console.group(`处理: ${metabolite.chinese_name}`);

            let statusColor, statusText, statusIcon;
            const detected = metabolite.detected_abundance;
            const minRange = metabolite.normal_range.normal_range_min;
            const maxRange = metabolite.normal_range.normal_range_max;

            const formattedDetectedValue = detected === "ND" ? "未检出" : detected;
            const formattedMinRange = minRange;
            const formattedMaxRange = maxRange;

            let isNormal = true;

            if (detected === "ND") {
              if (minRange > 0) {
                statusColor = 'red';
                statusText = '偏低';
                statusIcon = '<i class="fas fa-arrow-down ml-1"></i>';
                isNormal = false;
              } else {
                statusColor = 'green';
                statusText = '正常';
                statusIcon = '';
              }
            } else if (detected < minRange) {
              statusColor = 'red';
              statusText = '偏低';
              statusIcon = '<i class="fas fa-arrow-down ml-1"></i>';
              isNormal = false;
            } else if (detected <= maxRange) {
              statusColor = 'green';
              statusText = '正常';
              statusIcon = '';
            } else {
              statusColor = 'red';
              statusText = '超标';
              statusIcon = '<i class="fas fa-arrow-up ml-1"></i>';
              isNormal = false;
            }

            const progressPercentage = calculateProgressPercentage(detected, maxRange);
            const progressBarColor = getProgressBarColor(detected, minRange, maxRange);

            const metaboliteContainer = document.createElement('div');
            metaboliteContainer.className = 'metabolite-info-container';

            const table = document.createElement('table');
            table.className = 'metabolite-table min-w-full';

            const dataRow = `
          <tr class="metabolite-row">
            <td class="py-2 px-4 text-left immunity-first-column">
              <div class="chinese-text">${metabolite.chinese_name}</div>
              <div class="latin-text">${metabolite.latin_name}</div>
            </td>
            <td class="py-2 px-4 text-center immunity-column-text immunity-second-column">
              ${formattedMinRange}-${formattedMaxRange}
            </td>
            <td class="py-2 px-4 text-center immunity-column-text immunity-third-column">
              ${formattedDetectedValue}
              <div class="progress-bar w-full mt-2">
                <div class="progress"
                     style="width: ${!metabolite.detected_abundance || metabolite.detected_abundance === 'ND' || metabolite.detected_abundance === 0
              ? 0
              : (metabolite.detected_abundance / metabolite.normal_range.normal_range_max * 100)}%;
                            background-color: ${progressBarColor};
                            transition: width 0.3s ease;">
                </div>
              </div>
            </td>
            <td class="py-2 px-4 text-center bold-text immunity-fourth-column immunity-column-text">
              <span style="color: ${CUSTOM_COLORS[statusColor]}">
                ${statusText}${statusIcon}
              </span>
            </td>
          </tr>
        `;

            const filteredDescriptions = metabolite.descriptions.filter(desc =>
              desc.type === 'info' || (!isNormal && desc.type === 'warning')
            );

            const descRow = filteredDescriptions.length > 0 ? `
          <tr class="metabolite-desc-row">
            <td colspan="6" class="py-2 px-4 text-left">
              <div class="description-container text-gray-600" style="font-size: 10px;">
                ${filteredDescriptions.map(desc => `
                  <div class="metabolite-description">
                    <i class="fas fa-${desc.type === 'info' ? 'info-circle' : 'bell'}"
                       style="color: ${desc.color};"></i>
                    ${desc.text}
                  </div>
                `).join('')}
              </div>
            </td>
          </tr>
        ` : '';

            table.innerHTML = `<tbody>${dataRow}${descRow}</tbody>`;
            metaboliteContainer.appendChild(table);
            container.appendChild(metaboliteContainer);

            console.groupEnd();
          });
        }

        // 页面加载时加载数据
        document.addEventListener('DOMContentLoaded', loadMicrobialMetabolitesData);
      </script>
    </div>

  </div>

  <!-- 免疫指标评估板块 : 细胞因子指标评估 -->

  <h2
    class="custom-title-1 page-break">
    细胞因子指标评估
  </h2>

  <div
    class="bg-white rounded-lg p-5 mb-5 mx-auto"
    style="width: 100%;"
  >

    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            细胞因子是免疫系统中重要的信号分子，通过检测不同的细胞因子水平，可以了解机体的免疫状态和炎症程度。
          </p>
        </div>
      </div>
    </div>

    <div class="rounded-table">
      <table class="min-w-full">
        <thead>
        <tr style="background-color: #00B2B4; color: white;">
          <th class="py-2 px-4 text-left immunity-first-column"
              style="font-size: 11px;">
            细胞因子
          </th>
          <th class="py-2 px-4 text-center immunity-second-column"
              style="font-size: 11px; padding: 5px 5px;">
            正常范围
          </th>
          <th class="py-2 px-4 text-center immunity-third-column"
              style="font-size: 11px; padding: 5px 5px;">
            评估数值
          </th>
          <th class="py-2 px-4 text-center immunity-fourth-column"
              style="font-size: 11px; padding: 5px 5px;">
            评估结果
          </th>
        </tr>
        </thead>
      </table>

      <div id="cytokines-data-table-body">
        <!-- 数据将通过 JavaScript 动态插入 -->
      </div>

      <script>
        async function loadCytokinesData() {
          try {
            const response = await fetch(DATA_PATHS.DATA);
            const data = await response.json();
            renderCytokinesTable(data.cytokines_data);
          } catch (error) {
            console.error('Error loading cytokines data:', error);
          }
        }

        function calculateProgressPercentage(detected, maxRange) {
          if (detected === "ND" || detected === 0 || detected === "0") {
            return 0;
          }

          const detectedValue = parseFloat(detected);
          const maxRangeValue = parseFloat(maxRange);

          if (isNaN(detectedValue) || isNaN(maxRangeValue) || maxRangeValue <= 0) {
            console.error('无效的输入值:', { detected, maxRange });
            return 0;
          }

          const percentage = (detectedValue / maxRangeValue) * 100;
          return parseFloat(percentage.toFixed(2));
        }

        function getProgressBarColor(detected, minRange, maxRange) {
          if (detected >= minRange && detected <= maxRange) {
            return '#389e0d'; // 绿色
          }
          return '#ff4d4f'; // 红色
        }

        function renderCytokinesTable(cytokinesData) {
          const container = document.getElementById('cytokines-data-table-body');
          if (!container) {
            console.error('Cytokines table body not found');
            return;
          }

          container.innerHTML = '';

          const CUSTOM_COLORS = {
            red: '#ff4d4f',
            green: '#389e0d',
            gray: '#808080'
          };

          cytokinesData.forEach(cytokine => {
            console.group(`处理: ${cytokine.chinese_name}`);

            let statusColor, statusText, statusIcon;
            const detected = cytokine.detected_abundance;
            const minRange = cytokine.normal_range.normal_range_min;
            const maxRange = cytokine.normal_range.normal_range_max;

            const formattedDetectedValue = detected === "ND" ? "未检出" : detected;
            const formattedMinRange = minRange;
            const formattedMaxRange = maxRange;

            let isNormal = true;

            if (detected === "ND") {
              if (minRange > 0) {
                statusColor = 'red';
                statusText = '偏低';
                statusIcon = '<i class="fas fa-arrow-down ml-1"></i>';
                isNormal = false;
              } else {
                statusColor = 'green';
                statusText = '正常';
                statusIcon = '';
              }
            } else if (detected < minRange) {
              statusColor = 'red';
              statusText = '偏低';
              statusIcon = '<i class="fas fa-arrow-down ml-1"></i>';
              isNormal = false;
            } else if (detected <= maxRange) {
              statusColor = 'green';
              statusText = '正常';
              statusIcon = '';
            } else {
              statusColor = 'red';
              statusText = '超标';
              statusIcon = '<i class="fas fa-arrow-up ml-1"></i>';
              isNormal = false;
            }

            const progressPercentage = calculateProgressPercentage(detected, maxRange);
            const progressBarColor = getProgressBarColor(detected, minRange, maxRange);

            const cytokineContainer = document.createElement('div');
            cytokineContainer.className = 'cytokine-info-container';

            const table = document.createElement('table');
            table.className = 'cytokine-table min-w-full';

            const dataRow = `
          <tr class="cytokine-row">
            <td class="py-2 px-4 text-left immunity-first-column">
              <div class="chinese-text">${cytokine.chinese_name}</div>
              <div class="latin-text">${cytokine.latin_name}</div>
            </td>
            <td class="py-2 px-4 text-center immunity-column-text immunity-second-column">
              ${formattedMinRange}-${formattedMaxRange}
            </td>
            <td class="py-2 px-4 text-center immunity-column-text immunity-third-column">
              ${formattedDetectedValue}
              <div class="progress-bar w-full mt-2">
                <div class="progress"
                     style="width: ${!cytokine.detected_abundance || cytokine.detected_abundance === 'ND' || cytokine.detected_abundance === 0
              ? 0
              : (cytokine.detected_abundance / cytokine.normal_range.normal_range_max * 100)}%;
                            background-color: ${progressBarColor};
                            transition: width 0.3s ease;">
                </div>
              </div>
            </td>
            <td class="py-2 px-4 text-center bold-text immunity-fourth-column immunity-column-text">
              <span style="color: ${CUSTOM_COLORS[statusColor]}">
                ${statusText}${statusIcon}
              </span>
            </td>
          </tr>
        `;

            const filteredDescriptions = cytokine.descriptions.filter(desc =>
              desc.type === 'info' || (!isNormal && desc.type === 'warning')
            );

            const descRow = filteredDescriptions.length > 0 ? `
          <tr class="cytokine-desc-row">
            <td colspan="6" class="py-2 px-4 text-left">
              <div class="description-container text-gray-600" style="font-size: 10px;">
                ${filteredDescriptions.map(desc => `
                  <div class="cytokine-description">
                    <i class="fas fa-${desc.type === 'info' ? 'info-circle' : 'bell'}"
                       style="color: ${desc.color};"></i>
                    ${desc.text}
                  </div>
                `).join('')}
              </div>
            </td>
          </tr>
        ` : '';

            table.innerHTML = `<tbody>${dataRow}${descRow}</tbody>`;
            cytokineContainer.appendChild(table);
            container.appendChild(cytokineContainer);

            console.groupEnd();
          });
        }

        // 页面加载时加载数据
        document.addEventListener('DOMContentLoaded', loadCytokinesData);
      </script>
    </div>
  </div>

  <!-- 免疫指标评估板块 : 免疫肿瘤指标评估 -->

  <h2
    class="custom-title-1 page-break">
    免疫肿瘤指标评估
  </h2>

  <div
    class="bg-white rounded-lg p-5 mb-5 mx-auto"
    style="width: 100%;"
  >

    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            肿瘤免疫指标是评估机体抗肿瘤免疫功能的重要标志物，通过检测这些指标可以了解机体的免疫监视和抗肿瘤能力。这些指标的变化可以反映肿瘤的发生发展，也可用于免疫治疗的疗效评估和预后判断。
          </p>
        </div>
      </div>
    </div>

    <div class="rounded-table">
      <table class="min-w-full">
        <thead>
        <tr style="background-color: #00B2B4; color: white;">
          <th class="py-2 px-4 text-left immunity-first-column"
              style="font-size: 11px;">
            免疫肿瘤指标
          </th>
          <th class="py-2 px-4 text-center immunity-second-column"
              style="font-size: 11px; padding: 5px 5px;">
            正常范围
          </th>
          <th class="py-2 px-4 text-center immunity-third-column"
              style="font-size: 11px; padding: 5px 5px;">
            评估数值
          </th>
          <th class="py-2 px-4 text-center immunity-fourth-column"
              style="font-size: 11px; padding: 5px 5px;">
            评估结果
          </th>
        </tr>
        </thead>
      </table>

      <div id="immune-oncology-markers-data-table-body">
        <!-- 数据将通过 JavaScript 动态插入 -->
      </div>

      <script>
        async function loadImmuneOncologyData() {
          try {
            const response = await fetch(DATA_PATHS.DATA);
            const data = await response.json();
            renderImmuneOncologyTable(data.immune_oncology_markers_data);
          } catch (error) {
            console.error('Error loading immune oncology data:', error);
          }
        }

        function calculateProgressPercentage(detected, maxRange) {
          if (detected === "ND" || detected === 0 || detected === "0") {
            return 0;
          }

          const detectedValue = parseFloat(detected);
          const maxRangeValue = parseFloat(maxRange);

          if (isNaN(detectedValue) || isNaN(maxRangeValue) || maxRangeValue <= 0) {
            console.error('无效的输入值:', { detected, maxRange });
            return 0;
          }

          const percentage = (detectedValue / maxRangeValue) * 100;
          return parseFloat(percentage.toFixed(2));
        }

        function getProgressBarColor(detected, minRange, maxRange) {
          if (detected >= minRange && detected <= maxRange) {
            return '#389e0d'; // 绿色
          }
          return '#ff4d4f'; // 红色
        }

        function renderImmuneOncologyTable(immuneData) {
          const container = document.getElementById('immune-oncology-markers-data-table-body');
          if (!container) {
            console.error('Immune oncology table body not found');
            return;
          }

          container.innerHTML = '';

          const CUSTOM_COLORS = {
            red: '#ff4d4f',
            green: '#389e0d',
            gray: '#808080'
          };

          immuneData.forEach(immune => {
            console.group(`处理: ${immune.chinese_name}`);

            let statusColor, statusText, statusIcon;
            const detected = immune.detected_abundance;
            const minRange = immune.normal_range.normal_range_min;
            const maxRange = immune.normal_range.normal_range_max;

            const formattedDetectedValue = detected === "ND" ? "未检出" : detected;
            const formattedMinRange = minRange;
            const formattedMaxRange = maxRange;

            let isNormal = true;

            if (detected === "ND") {
              if (minRange > 0) {
                statusColor = 'red';
                statusText = '偏低';
                statusIcon = '<i class="fas fa-arrow-down ml-1"></i>';
                isNormal = false;
              } else {
                statusColor = 'green';
                statusText = '正常';
                statusIcon = '';
              }
            } else if (detected < minRange) {
              statusColor = 'red';
              statusText = '偏低';
              statusIcon = '<i class="fas fa-arrow-down ml-1"></i>';
              isNormal = false;
            } else if (detected <= maxRange) {
              statusColor = 'green';
              statusText = '正常';
              statusIcon = '';
            } else {
              statusColor = 'red';
              statusText = '超标';
              statusIcon = '<i class="fas fa-arrow-up ml-1"></i>';
              isNormal = false;
            }

            const progressPercentage = calculateProgressPercentage(detected, maxRange);
            const progressBarColor = getProgressBarColor(detected, minRange, maxRange);

            const immuneContainer = document.createElement('div');
            immuneContainer.className = 'immune-info-container';

            const table = document.createElement('table');
            table.className = 'immune-table min-w-full';

            const dataRow = `
          <tr class="immune-row">
            <td class="py-2 px-4 text-left immunity-first-column">
              <div class="chinese-text">${immune.chinese_name}</div>
              <div class="latin-text">${immune.latin_name}</div>
            </td>
            <td class="py-2 px-4 text-center immunity-column-text immunity-second-column">
              ${formattedMinRange}-${formattedMaxRange}
            </td>
            <td class="py-2 px-4 text-center immunity-column-text immunity-third-column">
              ${formattedDetectedValue}
              <div class="progress-bar w-full mt-2">
                <div class="progress"
                     style="width: ${!immune.detected_abundance || immune.detected_abundance === 'ND' || immune.detected_abundance === 0
              ? 0
              : (immune.detected_abundance / immune.normal_range.normal_range_max * 100)}%;
                            background-color: ${progressBarColor};
                            transition: width 0.3s ease;">
                </div>
              </div>
            </td>
            <td class="py-2 px-4 text-center bold-text immunity-fourth-column immunity-column-text">
              <span style="color: ${CUSTOM_COLORS[statusColor]}">
                ${statusText}${statusIcon}
              </span>
            </td>
          </tr>
        `;

            const filteredDescriptions = immune.descriptions.filter(desc =>
              desc.type === 'info' || (!isNormal && desc.type === 'warning')
            );

            const descRow = filteredDescriptions.length > 0 ? `
          <tr class="immune-desc-row">
            <td colspan="6" class="py-2 px-4 text-left">
              <div class="description-container text-gray-600" style="font-size: 10px;">
                ${filteredDescriptions.map(desc => `
                  <div class="immune-description">
                    <i class="fas fa-${desc.type === 'info' ? 'info-circle' : 'bell'}"
                       style="color: ${desc.color};"></i>
                    ${desc.text}
                  </div>
                `).join('')}
              </div>
            </td>
          </tr>
        ` : '';

            table.innerHTML = `<tbody>${dataRow}${descRow}</tbody>`;
            immuneContainer.appendChild(table);
            container.appendChild(immuneContainer);

            console.groupEnd();
          });
        }

        // 页面加载时加载数据
        document.addEventListener('DOMContentLoaded', loadImmuneOncologyData);
      </script>
    </div>

  </div>

  <!-- 营养评估板块 -->
  <h1 class="custom-title-1 page-break">营养饮食指标评估</h1>
  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">
    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            营养饮食评估模块旨在分析个体的饮食习惯与营养摄入情况，评估其对健康的影响。该模块重点关注宏观营养素（如碳水化合物、蛋白质、脂肪）和微观营养素（如维生素、矿物质）的摄入量，以及膳食纤维和水分的摄入。
          </p>
          <ul class="list-disc ml-5">
            <li>
              <strong>日常饮食</strong>：
              <ul class="list-disc ml-5">
                <li>作用机制：通过分析日常饮食的种类和数量，评估其对健康的影响。</li>
                <li>关键指标：饮食多样性、均衡性、摄入频率等。</li>
              </ul>
            </li>
            <li>
              <strong>微量矿物质元素</strong>：
              <ul class="list-disc ml-5">
                <li>作用机制：微量矿物质对身体的正常功能至关重要，参与多种生理过程。</li>
                <li>常见元素：锌、铁、硒等。</li>
              </ul>
            </li>
            <li>
              <strong>短链脂肪酸</strong>：
              <ul class="list-disc ml-5">
                <li>作用机制：短链脂肪酸是肠道细菌发酵膳食纤维的产物，具有抗炎和保护肠道健康的作用。</li>
                <li>主要来源：富含纤维的食物，如全谷物、豆类和蔬菜。</li>
              </ul>
            </li>
            <li>
              <strong>维生素</strong>：
              <ul class="list-disc ml-5">
                <li>作用机制：维生素在能量代谢、免疫功能和细胞修复中发挥重要作用。</li>
                <li>常见维生素：维生素A、维生素C、维生素D等。</li>
              </ul>
            </li>
            <li>
              <strong>氨基酸</strong>：
              <ul class="list-disc ml-5">
                <li>作用机制：氨基酸是蛋白质的构成单位，参与体内多种生物合成过程。</li>
                <li>关键氨基酸：赖氨酸、蛋氨酸、苏氨酸等。</li>
              </ul>
            </li>
          </ul>
          <p>通过对饮食数据的综合分析，我们能够识别出潜在的营养缺乏或过量问题，并为制定个性化的饮食干预方案提供科学依据。这些因素对维持身体健康和预防慢性疾病至关重要。</p>
        </div>
      </div>
    </div>

    <!--    <div class="nutrition-container">-->
<!--      &lt;!&ndash; 左侧圆环图 &ndash;&gt;-->
<!--      &lt;!&ndash; 左侧圆环图 &ndash;&gt;-->
<!--      <div class="nutrition-donut-chart-container">-->
<!--        <div class="nutrition-donut-chart">-->
<!--          <svg width="300" height="300" viewBox="0 0 300 300">-->
<!--            <defs>-->
<!--              <filter id="nutrition-shadow" x="-20%" y="-20%" width="140%" height="140%">-->
<!--                <feGaussianBlur in="SourceAlpha" stdDeviation="3"/>-->
<!--                <feOffset dx="2" dy="2"/>-->
<!--                <feComponentTransfer>-->
<!--                  <feFuncA type="linear" slope="0.2"/>-->
<!--                </feComponentTransfer>-->
<!--                <feMerge>-->
<!--                  <feMergeNode/>-->
<!--                  <feMergeNode in="SourceGraphic"/>-->
<!--                </feMerge>-->
<!--              </filter>-->
<!--            </defs>-->

<!--            &lt;!&ndash; 圆环背景 &ndash;&gt;-->
<!--            <circle cx="150" cy="150" r="120" fill="none" stroke="#f0f0f0" stroke-width="30"/>-->

<!--            &lt;!&ndash; 正常 48.4% &ndash;&gt;-->
<!--            <path d="M150,30 A120,120 0 0,1 150,270 A120,120 0 0,1 150,30"-->
<!--                  fill="none"-->
<!--                  stroke="#98E089"-->
<!--                  stroke-width="30"-->
<!--                  stroke-dasharray="377 754"-->
<!--                  transform="rotate(-90 150 150)"-->
<!--                  filter="url(#nutrition-shadow)"/>-->

<!--            &lt;!&ndash; 缺乏 29.0% &ndash;&gt;-->
<!--            <path d="M150,30 A120,120 0 0,1 150,270 A120,120 0 0,1 150,30"-->
<!--                  fill="none"-->
<!--                  stroke="#FF8989"-->
<!--                  stroke-width="30"-->
<!--                  stroke-dasharray="226 754"-->
<!--                  stroke-dashoffset="-377"-->
<!--                  transform="rotate(-90 150 150)"-->
<!--                  filter="url(#nutrition-shadow)"/>-->

<!--            &lt;!&ndash; 不足 16.1% &ndash;&gt;-->
<!--            <path d="M150,30 A120,120 0 0,1 150,270 A120,120 0 0,1 150,30"-->
<!--                  fill="none"-->
<!--                  stroke="#FFB489"-->
<!--                  stroke-width="30"-->
<!--                  stroke-dasharray="121 754"-->
<!--                  stroke-dashoffset="-603"-->
<!--                  transform="rotate(-90 150 150)"-->
<!--                  filter="url(#nutrition-shadow)"/>-->

<!--            &lt;!&ndash; 过量 6.5% &ndash;&gt;-->
<!--            <path d="M150,30 A120,120 0 0,1 150,270 A120,120 0 0,1 150,30"-->
<!--                  fill="none"-->
<!--                  stroke="#89C3FF"-->
<!--                  stroke-width="30"-->
<!--                  stroke-dasharray="30 754"-->
<!--                  stroke-dashoffset="-724"-->
<!--                  transform="rotate(-90 150 150)"-->
<!--                  filter="url(#nutrition-shadow)"/>-->
<!--          </svg>-->
<!--          &lt;!&ndash; 修改后的中心文字结构 &ndash;&gt;-->
<!--          <div class="nutrition-donut-hole">-->
<!--            <div class="nutrition-center-text">-->
<!--              <div>营养指标</div>-->
<!--              <div>总计 31 项</div>-->
<!--            </div>-->
<!--          </div>-->
<!--        </div>-->
<!--      </div>-->

<!--      &lt;!&ndash; 右侧卡片列表 &ndash;&gt;-->
<!--      <div class="nutrition-status-cards">-->
<!--        &lt;!&ndash; 正常状态卡片 &ndash;&gt;-->
<!--        <div class="nutrition-status-card normal">-->
<!--          <div class="nutrition-card-header">-->
<!--            <div class="nutrition-status-dot"></div>-->
<!--            <div class="nutrition-status-title">正常</div>-->
<!--            <div class="nutrition-status-percentage">48.4%</div>-->
<!--          </div>-->
<!--          <div class="nutrition-card-content">15 项指标达标</div>-->
<!--        </div>-->

<!--        &lt;!&ndash; 缺乏状态卡片 &ndash;&gt;-->
<!--        <div class="nutrition-status-card lack">-->
<!--          <div class="nutrition-card-header">-->
<!--            <div class="nutrition-status-dot"></div>-->
<!--            <div class="nutrition-status-title">缺乏</div>-->
<!--            <div class="nutrition-status-percentage">29.0%</div>-->
<!--          </div>-->
<!--          <div class="nutrition-card-content">纤维、乳制品、乙酸、维生素 A/B1/E</div>-->
<!--          <div class="nutrition-card-content">叶酸、甘氨酸、色氨酸</div>-->
<!--        </div>-->

<!--        &lt;!&ndash; 不足状态卡片 &ndash;&gt;-->
<!--        <div class="nutrition-status-card insufficient">-->
<!--          <div class="nutrition-card-header">-->
<!--            <div class="nutrition-status-dot"></div>-->
<!--            <div class="nutrition-status-title">不足</div>-->
<!--            <div class="nutrition-status-percentage">16.1%</div>-->
<!--          </div>-->
<!--          <div class="nutrition-card-content">铁、锌、维生素 B6/C/K</div>-->
<!--        </div>-->

<!--        &lt;!&ndash; 过量状态卡片 &ndash;&gt;-->
<!--        <div class="nutrition-status-card excess">-->
<!--          <div class="nutrition-card-header">-->
<!--            <div class="nutrition-status-dot"></div>-->
<!--            <div class="nutrition-status-title">过量</div>-->
<!--            <div class="nutrition-status-percentage">6.5%</div>-->
<!--          </div>-->
<!--          <div class="nutrition-card-content">糖、苏氨酸</div>-->
<!--        </div>-->
<!--      </div>-->
<!--    </div>-->

  </div>

  <!-- 日常饮食和矿物质微量元素评估板块 -->
  <h3 class="custom-title-1 page-break">日常饮食和微量元素评估</h3>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">
    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            糖、盐、膳食纤维和乳制品是人体日常饮食中重要的营养成分，对维持人体基本生理功能和健康发挥着关键作用。本报告将通过肠道菌群等检测指标，全面评估这些营养成分在人体中的代谢水平和整体状况。
          </p>
        </div>
      </div>
    </div>

    <!-- 日常饮食表格 -->
    <div class="rounded-table">
      <table class="min-w-full">
        <thead>
        <!-- 标题行 -->
        <tr style="background-color: #00B2B4; color: white;">
          <th class="py-2 px-4 text-left nutrition-first-column" style="font-size: 10px;">饮食指标</th>
          <th class="py-2 px-4 text-center nutrition-second-column" style="font-size: 10px; padding: 5px 5px;">正常范围（缺乏-不足-过量）</th>
          <th class="py-2 px-4 text-center nutrition-third-column" style="font-size: 10px; padding: 5px 5px;">评估数值</th>
          <th class="py-2 px-4 text-center nutrition-fourth-column" style="font-size: 10px; padding: 5px 5px;">评估结果</th>
        </tr>
        </thead>
        <tbody id="daily-food-data-table-body">
        <!-- 数据将通过 JavaScript 动态插入 -->
        </tbody>
      </table>

      <script>
        async function loadDailyFoodData() {
          try {
            const response = await fetch(DATA_PATHS.DATA);
            const data = await response.json();
            renderDailyFoodTable(data.daily_food_data);
          } catch (error) {
            console.error('Error loading daily food data:', error);
          }
        }

        function renderDailyFoodTable(dailyfoodData) {
          const tableBody = document.getElementById('daily-food-data-table-body');
          if (!tableBody) {
            console.error('Daily food data table body not found');
            return;
          }

          tableBody.innerHTML = '';

          dailyfoodData.forEach(food => {
            // 创建数据行
            const dataRow = document.createElement('tr');
            dataRow.classList.add('cytokines-data-row');
            dataRow.innerHTML = `
              <td class="py-2 px-4 text-left first-column">
                <div class="chinese-text">${food.chinese_name}</div>
                <div class="latin-text">${food.english_name}</div>
              </td>
              <td class="py-2 px-4 text-center column-text">
                  ${[
                    food.normal_range.Deficiency ?? 0,
                    food.normal_range.Insufficiency ?? 0,
                    food.normal_range.Excess ?? 0
                  ].join('-')}
              </td>
              <td class="py-2 px-4 text-center column-text">
                ${food.Evaluation_value}
                <div class="progress-bar w-full mt-1">
                  <div class="progress" style="
                    width: ${Math.min(100, Math.round((food.Evaluation_value / food.normal_range.Excess) * 100))}%;
                    background-color: #00B2B4;
                  "></div>
                </div>
              </td>
              <td class="py-2 px-4 text-center column-text" style="
                color: ${
                  food.Evaluation_value < food.normal_range.Deficiency ? '#ff4d4f' :
                  food.Evaluation_value < food.normal_range.Insufficiency ? '#fadb14' :
                  food.Evaluation_value < food.normal_range.Excess ? '#52c41a' : '#1890ff'
                };
                font-weight : bold;">
                ${
                  food.Evaluation_value < food.normal_range.Deficiency ? '缺乏' :
                  food.Evaluation_value < food.normal_range.Insufficiency ? '不足' :
                  food.Evaluation_value < food.normal_range.Excess ? '正常' : '过量'
                }
              </td>
            `;

            // 创建描述行
            const descRow = document.createElement('tr');
            descRow.classList.add('cytokines-data-row');
            descRow.innerHTML = `
              <td colspan="6" class="py-2 px-4 text-left">
                <div class="description-container">
                  ${food.descriptions.map(desc => `
                    <div class="microbial-metabolites-description">
                      <i class="fas fa-${desc.type === 'info' ? 'info-circle' : 'bell'}"
                         style="color: ${desc.color};"></i>
                      ${desc.text}
                    </div>
                  `).join('')}
                </div>
              </td>
            `;

            // 添加到表格
            tableBody.appendChild(dataRow);
            tableBody.appendChild(descRow);
          });
        }

        // 页面加载时加载有机酸数据
        document.addEventListener('DOMContentLoaded', loadDailyFoodData);
      </script>

    </div>

  </div>

  <!-- 短链脂肪酸评估板块 -->
  <h3 class="custom-title-1 page-break">短链脂肪酸评估</h3>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">
    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            矿物质微量元素和有机酸是人体代谢过程中的重要组成部分，它们通过不同的机制参与人体生理功能的调节。本报告将通过肠道菌群等检测指标，全面评估其在人体中的代谢水平和整体状况。
          </p>
        </div>
      </div>
    </div>

    <!-- 短链脂肪酸表格 -->
    <div class="rounded-table">
      <table class="min-w-full">
        <thead>
        <!-- 标题行 -->
        <tr style="background-color: #00B2B4; color: white;">
          <th class="py-2 px-4 text-left nutrition-first-column" style="font-size: 10px;">评估指标</th>
          <th class="py-2 px-4 text-center nutrition-second-column" style="font-size: 10px; padding: 5px 5px;">正常范围</th>
          <th class="py-2 px-4 text-center nutrition-third-column" style="font-size: 10px; padding: 5px 5px;">评估数值</th>
          <th class="py-2 px-4 text-center nutrition-fourth-column" style="font-size: 10px; padding: 5px 5px;">评估结果</th>
        </tr>
        </thead>
        <tbody id="short-chain-fatty-acids-data-table-body">
        <!-- 数据行 -->
        </tbody>
      </table>

      <script>
        <!-- SCFAs is an abbreviation for short chain fatty acids -->
        async function loadSCFAsData() {
          try {
            const response = await fetch(DATA_PATHS.DATA);
            const data = await response.json();
            renderSCFAsTable(data.short_chain_fatty_acids_data);
          } catch (error) {
            console.error('Error loading Short-Chain Fatty Acids data:', error);
          }
        }

        function renderSCFAsTable(scfasData) {
          const tableBody = document.getElementById('short-chain-fatty-acids-data-table-body');
          if (!tableBody) {
            console.error('Short-Chain Fatty Acids data table body not found');
            return;
          }

          tableBody.innerHTML = '';

          scfasData.forEach(scfas => {
            // 创建数据行
            const dataRow = document.createElement('tr');
            dataRow.classList.add('short-chain-fatty-acids-data-row');
            dataRow.innerHTML = `
              <td class="py-2 px-4 text-left first-column">
                <div class="chinese-text">${scfas.chinese_name}</div>
                <div class="latin-text">${scfas.english_name}</div>
              </td>
              <td class="py-2 px-4 text-center column-text">
                  ${[
              scfas.normal_range.Deficiency ?? 0,
              scfas.normal_range.Insufficiency ?? 0,
              scfas.normal_range.Excess ?? 0
            ].join('-')}
              </td>
              <td class="py-2 px-4 text-center column-text">
                ${scfas.Evaluation_value}
                <div class="progress-bar w-full mt-1">
                  <div class="progress" style="
                    width: ${Math.min(100, Math.round((scfas.Evaluation_value / scfas.normal_range.Excess) * 100))}%;
                    background-color: #00B2B4;
                  "></div>
                </div>
              </td>
              <td class="py-2 px-4 text-center column-text" style="
                color: ${
              scfas.Evaluation_value < scfas.normal_range.Deficiency ? '#ff4d4f' :
                scfas.Evaluation_value < scfas.normal_range.Insufficiency ? '#fadb14' :
                  scfas.Evaluation_value < scfas.normal_range.Excess ? '#52c41a' : '#1890ff'
            };
                font-weight : bold;">
                ${
              scfas.Evaluation_value < scfas.normal_range.Deficiency ? '缺乏' :
                scfas.Evaluation_value < scfas.normal_range.Insufficiency ? '不足' :
                  scfas.Evaluation_value < scfas.normal_range.Excess ? '正常' : '过量'
            }
              </td>
            `;

            // 创建描述行
            const descRow = document.createElement('tr');
            descRow.classList.add('short-chain-fatty-acids-data-row');
            descRow.innerHTML = `
              <td colspan="6" class="py-2 px-4 text-left">
                <div class="description-container">
                  ${scfas.descriptions.map(desc => `
                    <div class="microbial-metabolites-description">
                      <i class="fas fa-${desc.type === 'info' ? 'info-circle' : 'bell'}"
                         style="color: ${desc.color};"></i>
                      ${desc.text}
                    </div>
                  `).join('')}
                </div>
              </td>
            `;

            // 添加到表格
            tableBody.appendChild(dataRow);
            tableBody.appendChild(descRow);
          });
        }

        // 页面加载时加载有机酸数据
        document.addEventListener('DOMContentLoaded', loadSCFAsData);
      </script>

    </div>

  </div>

  <!-- 维生素评估板块 -->
  <h3 class="custom-title-1 page-break">维生素评估</h3>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">
    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            维生素是人体必需的微量营养素，本报告通过肠道菌群等检测指标来评估下列各项维生素的水平。
          </p>
        </div>
      </div>
    </div>

    <!-- 维生素表格 -->
    <div class="rounded-table">
      <table class="min-w-full">
        <thead>
        <!-- 标题行 -->
        <tr style="background-color: #00B2B4; color: white;">
          <th class="py-2 px-4 text-left first-column" style="font-size: 10px;">评估指标</th>
          <th class="py-2 px-4 text-center second-column" style="font-size: 10px; padding: 5px 5px;">正常范围</th>
          <th class="py-2 px-4 text-center third-column" style="font-size: 10px; padding: 5px 5px;">评估数值</th>
          <th class="py-2 px-4 text-center fourth-column" style="font-size: 10px; padding: 5px 5px;">评估结果</th>
        </tr>
        </thead>
        <tbody id="vitamins-data-table-body">
        <!-- 数据行 -->
        </tbody>
      </table>

      <script>
        async function loadVitaminsData() {
          try {
            const response = await fetch(DATA_PATHS.DATA);
            const data = await response.json();
            renderVitaminsTable(data.vitamins_data);
          } catch (error) {
            console.error('Error loading vitamins data:', error);
          }
        }

        function renderVitaminsTable(vitaminsData) {
          const tableBody = document.getElementById('vitamins-data-table-body');
          if (!tableBody) {
            console.error('Vitamins data table body not found');
            return;
          }

          tableBody.innerHTML = '';

          vitaminsData.forEach(vitamins => {
            // 创建数据行
            const dataRow = document.createElement('tr');
            dataRow.classList.add('vitamins-data-row');
            dataRow.innerHTML = `
              <td class="py-2 px-4 text-left first-column">
                <div class="chinese-text">${vitamins.chinese_name}</div>
                <div class="latin-text">${vitamins.english_name}</div>
              </td>
              <td class="py-2 px-4 text-center column-text">
                  ${[
              vitamins.normal_range.Deficiency ?? 0,
              vitamins.normal_range.Insufficiency ?? 0,
              vitamins.normal_range.Excess ?? 0
            ].join('-')}
              </td>
              <td class="py-2 px-4 text-center column-text">
                ${vitamins.Evaluation_value}
                <div class="progress-bar w-full mt-1">
                  <div class="progress" style="
                    width: ${Math.min(100, Math.round((vitamins.Evaluation_value / vitamins.normal_range.Excess) * 100))}%;
                    background-color: #00B2B4;
                  "></div>
                </div>
              </td>
              <td class="py-2 px-4 text-center column-text" style="
                color: ${
                  vitamins.Evaluation_value < vitamins.normal_range.Deficiency ? '#ff4d4f' :
                  vitamins.Evaluation_value < vitamins.normal_range.Insufficiency ? '#fadb14' :
                  vitamins.Evaluation_value < vitamins.normal_range.Excess ? '#52c41a' : '#1890ff'
                };
                font-weight : bold;
              ">
                ${
                  vitamins.Evaluation_value < vitamins.normal_range.Deficiency ? '缺乏' :
                  vitamins.Evaluation_value < vitamins.normal_range.Insufficiency ? '不足' :
                  vitamins.Evaluation_value < vitamins.normal_range.Excess ? '正常' : '过量'
                }
              </td>
            `;

            // 创建描述行
            const descRow = document.createElement('tr');
            descRow.classList.add('vitamins-data-row');
            descRow.innerHTML = `
              <td colspan="6" class="py-2 px-4 text-left">
                <div class="description-container">
                  ${vitamins.descriptions.map(desc => `
                    <div class="vitamins-description">
                      <i class="fas fa-${desc.type === 'info' ? 'info-circle' : 'bell'}"
                         style="color: ${desc.color};"></i>
                      ${desc.text}
                    </div>
                  `).join('')}
                </div>
              </td>
            `;

            // 添加到表格
            tableBody.appendChild(dataRow);
            tableBody.appendChild(descRow);
          });
        }

        // 页面加载时加载有机酸数据
        document.addEventListener('DOMContentLoaded', loadVitaminsData);
      </script>

    </div>

  </div>

  <!-- 氨基酸评估板块 -->
  <h3 class="custom-title-1 page-break">氨基酸评估</h3>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">
    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            氨基酸是蛋白质的基本构建单位，在人体内参与多种重要的生理功能。人体所需的 20 种氨基酸中，9 种必需氨基酸需要从食物中获取，其余可由人体自身合成。氨基酸评估可以反映蛋白质营养状况以及代谢功能等。
          </p>
        </div>
      </div>
    </div>

    <!-- 氨基酸表格 -->
    <div class="rounded-table">
      <table class="min-w-full">
        <thead>
        <tr style="background-color: #00B2B4; color: white;">
          <th class="py-2 px-4 text-left first-column"
              style="font-size: 11px;">
            氨基酸名称
          </th>
          <th class="py-2 px-4 text-center second-column"
              style="font-size: 11px; padding: 5px 5px;">
            正常范围
          </th>
          <th class="py-2 px-4 text-center third-column"
              style="font-size: 11px; padding: 5px 5px;">
            评估数值
          </th>
          <th class="py-2 px-4 text-center fourth-column"
              style="font-size: 11px; padding: 5px 5px;">
            评估结果
          </th>
        </tr>
        </thead>
      </table>

      <div id="amino-acids-data-table-body">
        <!-- Data rows will be generated by Javascript code dynamically -->
      </div>
    </div>

    <script>
      async function loadAminoAcidsData() {
        try {
          const response = await fetch(DATA_PATHS.DATA);
          const data = await response.json();
          renderAminoAcidsTable(data.amino_acids_data);
        } catch (error) {
          console.error('Error loading amino acids data:', error);
        }
      }

      function getStatusColor(value, deficiency, insufficiency, excess) {
        const CUSTOM_COLORS = {
          red: '#ff4d4f',
          yellow: '#fadb14',
          green: '#389e0d',
          blue: '#1890ff'
        };

        if (value < deficiency) return CUSTOM_COLORS.red;
        if (value < insufficiency) return CUSTOM_COLORS.yellow;
        if (value < excess) return CUSTOM_COLORS.green;
        return CUSTOM_COLORS.blue;
      }

      function getStatusText(value, deficiency, insufficiency, excess) {
        if (value < deficiency) return '缺乏';
        if (value < insufficiency) return '不足';
        if (value < excess) return '正常';
        return '过量';
      }

      function getStatusIcon(status) {
        if (status === '缺乏' || status === '不足') {
          return '<i class="fas fa-arrow-down ml-1"></i>';
        } else if (status === '过量') {
          return '<i class="fas fa-arrow-up ml-1"></i>';
        }
        return '';
      }

      function calculateProgressPercentage(value, excess) {
        if (value === "ND" || value === 0) {
          return 0;
        }
        const percentage = (value / excess) * 50; // 最大宽度设为50%
        return Math.max(5, Math.min(50, percentage));
      }

      function renderAminoAcidsTable(aminoacidsData) {
        const container = document.getElementById('amino-acids-data-table-body');
        if (!container) {
          console.error('Amino acids table body not found');
          return;
        }

        container.innerHTML = '';

        aminoacidsData.forEach(aminoacids => {
          const aminoAcidsContainer = document.createElement('div');
          aminoAcidsContainer.className = 'bacteria-info-container';

          const table = document.createElement('table');
          table.className = 'bacteria-table min-w-full';

          const status = getStatusText(
            aminoacids.Evaluation_value,
            aminoacids.normal_range.Deficiency,
            aminoacids.normal_range.Insufficiency,
            aminoacids.normal_range.Excess
          );
          const isNormal = status === '正常';

          const dataRow = `
        <tr class="amino-acids-data-row">
          <td class="py-2 px-4 text-left first-column">
            <div class="chinese-text">${aminoacids.chinese_name}</div>
            <div class="latin-text">${aminoacids.english_name}</div>
          </td>
          <td class="py-2 px-4 text-center column-text" style="font-size: 0.65rem;">
            ${[
            aminoacids.normal_range.Deficiency ?? 0,
            aminoacids.normal_range.Insufficiency ?? 0,
            aminoacids.normal_range.Excess ?? 0
          ].join('-')}
          </td>
          <td class="py-2 px-4 text-center column-text" style="font-size: 0.65rem;">
            ${aminoacids.Evaluation_value}
            <div class="progress-bar w-full mt-1">
              <div class="progress"
                   style="width: ${calculateProgressPercentage(aminoacids.Evaluation_value, aminoacids.normal_range.Excess)}%;
                          background-color: #00B2B4;
                          transition: width 0.3s ease;">
              </div>
            </div>
          </td>
          <td class="py-2 px-4 text-center column-text" style="font-size: 0.65rem;">
            <span style="color: ${getStatusColor(
            aminoacids.Evaluation_value,
            aminoacids.normal_range.Deficiency,
            aminoacids.normal_range.Insufficiency,
            aminoacids.normal_range.Excess
          )}; font-weight: bold;">
              ${status}${getStatusIcon(status)}
            </span>
          </td>
        </tr>
      `;

          const filteredDescriptions = aminoacids.descriptions.filter(desc =>
            desc.type === 'info' || (!isNormal && desc.type === 'warning')
          );

          const descRow = filteredDescriptions.length > 0 ? `
        <tr class="amino-acids-data-row">
          <td colspan="6" class="py-2 px-4 text-left">
            <div class="description-container text-gray-600 mt-0.5" style="font-size: 10px;">
              ${filteredDescriptions.map(desc => `
                <div class="flex items-start">
                  <div class="ml-1">
                    <p>
                      <i class="fas fa-${desc.type === 'info' ? 'info-circle' : 'exclamation-triangle'}"
                         style="color: ${desc.color};">
                      </i>
                      ${desc.text}
                      <ul class="list-disc ml-5" style="margin-top: 10px; margin-bottom: -5px;">
                        <li><strong>超标的影响：</strong> 超标可能导致健康风险，包括但不限于心脏病、高血压及其他代谢性疾病。</li>
                        <li><strong>偏低的影响：</strong> 偏低的水平可能导致营养不足、免疫力下降以及其他相关健康问题。</li>
                      </ul>
                    </p>
                  </div>
                </div>
              `).join('')}
            </div>
          </td>
        </tr>
      ` : '';

          table.innerHTML = `<tbody>${dataRow}${descRow}</tbody>`;
          aminoAcidsContainer.appendChild(table);
          container.appendChild(aminoAcidsContainer);
        });
      }

      // 页面加载时加载数据
      document.addEventListener('DOMContentLoaded', loadAminoAcidsData);
    </script>

  </div>

  <!-- 慢病整体对比图示 -->
  <h2 class="custom-title-second-level page-break">慢病风险评估</h2>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">

    <!-- 信息框 -->
    <div class="info-box mb-10">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            肠道菌群是人体最大的微生物群落，在维持人体健康中发挥着关键作用。大量研究表明，肠道菌群的失衡与多种慢性疾病（包括但不限于消化系统疾病，免疫系统疾病，代谢性疾病，心脑血管疾病，神经系统疾病等）的发生发展密切相关。通过对肠道菌群的分析，我们可以及早发现疾病风险，实现疾病的预防和干预。下列图式是您整体的慢病风险评估汇总与对比。
          </p>
        </div>
      </div>
    </div>

    <div id="slow-disease-summary-container" class="flex flex-col gap-4 w-full">
      <!-- 内容将通过JavaScript动态生成 -->
    </div>

    <script>
      // 确保 DATA_PATHS 已定义
      if (typeof DATA_PATHS === 'undefined') {
        var DATA_PATHS = {
          DATA: './data.json' // 默认路径，请确保这个路径是正确的
        };
      }

      // 慢病风险评估汇总图示模块
      const SlowDiseaseSummary = {
        // 常量定义
        CONSTANTS: {
          COLORS: {
            GREEN: '#4ade80',   // 低风险 (绿色)
            YELLOW: '#facc15',  // 注意 (黄色)
            ORANGE: '#fb923c',  // 中高风险 (橙色)
            RED: '#f87171',     // 高风险 (红色)
            GRAY: '#e5e7eb'     // 背景色 (灰色)
          },
          CATEGORIES: {
            INTESTINAL: {
              name: "肠道疾病",
              diseases: ["炎症性肠炎", "肠易激综合征", "感染型腹泻", "肠道病毒感染", "过敏性腹泻"]
            },
            ORGAN: {
              name: "器官性疾病",
              diseases: ["肝病", "心脑血管疾病", "甲状腺疾病", "肺部疾病"]
            },
            NEURO: {
              name: "神经系统",
              diseases: ["神经行为发育异常"]
            }
          }
        },

        // 获取风险颜色
        getRiskColor(value) {
          if (value < 0.3) return this.CONSTANTS.COLORS.GREEN;
          if (value < 0.5) return this.CONSTANTS.COLORS.YELLOW;
          if (value < 0.7) return this.CONSTANTS.COLORS.ORANGE;
          return this.CONSTANTS.COLORS.RED;
        },

        // 创建标准风险进度条
        createRiskStandardRow() {
          return `
          <!-- 第一行 -->
          <div class="flex gap-2">
            <!-- 风险评估参考标准 -->
            <div class="w-[410px] slow-disease-summary-info-card py-2 flex justify-center items-center">
              <div class="text-base font-bold">风险评估参考标准</div>
            </div>

            <!-- 风险进度条 -->
            <div class="w-[600px] summary-info-card p-4 flex flex-col justify-center gap-1">
              <!-- 风险标签 -->
              <div class="flex w-full">
                <div class="w-[30%] text-center">
                  <span class="text-sm text-gray-600">低风险</span>
                </div>
                <div class="w-[20%] text-center">
                  <span class="text-sm text-gray-600">注意</span>
                </div>
                <div class="w-[20%] text-center">
                  <span class="text-sm text-gray-600">中高风险</span>
                </div>
                <div class="w-[30%] text-center">
                  <span class="text-sm text-gray-600">高风险</span>
                </div>
              </div>

              <!-- 分段进度条 -->
              <div class="flex w-full h-3 rounded-full overflow-hidden">
                <div class="bg-green-400" style="width: 30%"></div>
                <div class="bg-yellow-400" style="width: 20%"></div>
                <div class="bg-orange-400" style="width: 20%"></div>
                <div class="bg-red-400" style="width: 30%"></div>
              </div>

              <!-- 刻度值 -->
              <div class="flex w-full h-4 relative">
                <div class="absolute w-full flex">
                  <span class="absolute left-0 -translate-x-1/2 text-xs text-gray-500">0</span>
                  <span class="absolute left-[30%] -translate-x-1/2 text-xs text-gray-500">0.3</span>
                  <span class="absolute left-[50%] -translate-x-1/2 text-xs text-gray-500">0.5</span>
                  <span class="absolute left-[70%] -translate-x-1/2 text-xs text-gray-500">0.7</span>
                  <span class="absolute right-0 -translate-x-1/2 text-xs text-gray-500">1</span>
                </div>
              </div>
            </div>
          </div>
        `;
        },

        // 创建疾病名称列表HTML
        createDiseaseNamesList(diseases) {
          return diseases.map(disease => `
          <div class="slow-disease-summary-info-card py-1 px-4 flex-1 flex justify-end items-center"
               style="background: linear-gradient(135deg, #F5F8FF, #FAFBFF);">
            <div class="text-base font-bold">${disease.name}</div>
          </div>
        `).join('');
        },

        // 创建进度条HTML
        createProgressBars(diseases) {
          return diseases.map(disease => {
            const percentage = (disease.value * 100).toFixed(0);
            const color = this.getRiskColor(disease.value);

            return `
            <div class="summary-info-card py-1 px-4 flex-1 flex items-center">
              <div class="flex-1">
                <div class="w-full bg-gray-200 rounded-full h-6 relative">
                  <div class="${this.getColorClass(color)} h-6 rounded-full flex items-center justify-end pr-2"
                       style="width: ${percentage}%">
                    <span class="text-white font-medium" style="font-size: 0.5rem;"><strong>${percentage}%</strong></span>
                  </div>
                </div>
              </div>
            </div>
          `;
          }).join('');
        },

        // 获取颜色类
        getColorClass(color) {
          const colorMap = {
            [this.CONSTANTS.COLORS.GREEN]: 'bg-green-400',
            [this.CONSTANTS.COLORS.YELLOW]: 'bg-yellow-400',
            [this.CONSTANTS.COLORS.ORANGE]: 'bg-orange-400',
            [this.CONSTANTS.COLORS.RED]: 'bg-red-400'
          };
          return colorMap[color] || 'bg-gray-400';
        },

        // 创建分类行
        createCategoryRow(categoryKey, categoryData, diseaseDataMap) {
          const category = this.CONSTANTS.CATEGORIES[categoryKey];
          const rowHeight = category.diseases.length * 50; // 每个疾病50px高度

          // 找出此分类中的所有疾病数据
          const diseasesInCategory = category.diseases
            .map(diseaseName => {
              const diseaseData = diseaseDataMap[diseaseName];
              return diseaseData ? {
                name: diseaseName,
                value: diseaseData.评估值
              } : null;
            })
            .filter(data => data !== null);

          // 如果没有此分类的疾病数据，则不生成此行
          if (diseasesInCategory.length === 0) return '';

          return `
          <div class="flex gap-2" style="height: ${rowHeight}px">
            <!-- 左侧区域（包含标题和疾病列表） -->
            <div class="w-[400px] flex gap-2">
              <!-- 分类标题 -->
              <div class="w-[80px] slow-disease-summary-info-card py-2 flex justify-center items-center"
                   style="background: linear-gradient(135deg, #E6F4F1, #F0F7F7);">
                <div class="${categoryKey === 'INTESTINAL' || categoryKey === 'ORGAN' ? 'writing-vertical' : ''} text-base font-bold">
                  ${category.name}
                </div>
              </div>

              <!-- 疾病名称列表 -->
              <div class="flex-1 flex flex-col gap-2">
                ${this.createDiseaseNamesList(diseasesInCategory)}
              </div>
            </div>

            <!-- 右侧进度条列表 -->
            <div class="w-[600px] flex flex-col gap-2">
              ${this.createProgressBars(diseasesInCategory)}
            </div>
          </div>
        `;
        },

        // 处理数据并生成HTML
        generateHTML(data) {
          if (!data || !data.慢病风险 || !Array.isArray(data.慢病风险)) {
            return '<div class="text-center p-4 text-red-500">暂无慢病风险数据</div>';
          }

          // 创建疾病名称到数据的映射
          const diseaseDataMap = {};
          data.慢病风险.forEach(disease => {
            if (disease && disease.检测项目) {
              diseaseDataMap[disease.检测项目] = disease;
            }
          });

          // 生成HTML
          let html = this.createRiskStandardRow();

          // 生成每个分类的行
          for (const categoryKey in this.CONSTANTS.CATEGORIES) {
            html += this.createCategoryRow(categoryKey, this.CONSTANTS.CATEGORIES[categoryKey], diseaseDataMap);
          }

          return html;
        },

        // 渲染图表
        render(data) {
          const container = document.getElementById('slow-disease-summary-container');
          if (!container) {
            console.error('找不到慢病风险汇总容器元素');
            return;
          }

          container.innerHTML = this.generateHTML(data);
        },

        // 加载数据
        async loadData() {
          try {
            const response = await fetch(DATA_PATHS.DATA);
            if (!response.ok) {
              throw new Error(`网络响应错误: ${response.status}`);
            }

            const data = await response.json();
            this.render(data);
          } catch (error) {
            console.error('加载慢病风险数据时出错:', error);
            document.getElementById('slow-disease-summary-container').innerHTML =
              '<div class="text-center p-4 text-red-500">数据加载失败，请稍后再试</div>';
          }
        },

        // 初始化
        init() {
          if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => this.loadData());
          } else {
            this.loadData();
          }
        }
      };

      // 初始化慢病风险汇总模块
      SlowDiseaseSummary.init();
    </script>
  </div>

  <h3 class="custom-title-third-level page-break">阅读指南</h3>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">
    <!-- 问答信息框 -->
    <div class="qa-box">
      <div class="flex items-start ml-2">
        <p class="text-lg font-bold text-lightpurple">
          <i class="fas fa-question-circle icon icon-purple"></i>
          如何阅读慢病风险评估的表格？
        </p>
      </div>
      <div class="flex items-start ml-2 mt-2">
        <p class="answer-text">
          <i class="fas fa-comments icon icon-orange"></i>
          以下是对慢病风险评估的表格中的各部分信息进行的说明解释：
        </p>
      </div>
      <div class="flex items-start ml-2 mt-2">
        <ul style="margin-left: 50px; list-style-type: disc;">
          <li class="answer-text">
            <strong>慢病名称：</strong>
            这一列列出进行风险评估的慢病名称。
          </li>
          <li class="answer-text">
            <strong>风险评估数值：</strong>
            此列显示该慢病的具体风险评估数值，以0-1之间的小数和进度条显示（进度条中的刻度代表了四个风险等级所对应的区间）。
          </li>
          <li class="answer-text">
            <strong>风险评估结果：</strong>
            这一列显示该慢病的风险评估值经过预设的4个风险等级区间比较后所得到的对应的风险评估等级，4个预设的风险等级区间定义如下：
            <ul style="margin-left: 30px; margin-top: 8px; list-style-type: none; display: flex; gap: 20px; padding: 0; margin-bottom: -10px;">
              <li class="text-green-500">
                <strong>0-0.3：低风险</strong>
              </li>
              <li class="text-yellow-500">
                | <strong>0.3-0.5：注意</strong>
              </li>
              <li class="text-orange-500">
                | <strong>0.5-0.7：中高风险</strong>
              </li>
              <li class="text-red-500">
                | <strong>0.7-1.0：高风险</strong>
              </li>
            </ul>
          </li>
          <li class="answer-text">
            <strong>疾病分类：</strong>
            这一列展示了该慢病属于的具体疾病大类，目前涉及到的有：
            <ul style="margin-left: 30px; margin-top:5px; list-style-type: disc;">
              <li>
                肠道疾病：肠道疾病大类包含了一些常见的消化系统慢性疾病
                <ul style="margin-left: 30px; margin-top:5px; list-style-type: disc;">
                  <li>
                    炎症性肠病 (IBD)：如克罗恩病、溃疡性结肠炎。
                  </li>
                  <li>
                    肠易激综合征 (IBS)：由于肠道功能失调导致的腹痛、腹泻或便秘等症状。
                  </li>
                  <li>
                    肠道病毒感染：属于由病毒引起的常见肠道感染性疾病，如轮状病毒、诺如病毒感染，可能引发腹泻等。
                  </li>
                  <li>
                    感染型腹泻：常见于细菌、病毒、寄生虫等感染的情况下导致的腹泻，主要原因是肠道感染的病原体。
                  </li>
                  <li>
                    过敏性腹泻：属于由食物过敏或免疫反应引起的腹泻类型，通常与特定食物或肠道敏感性有关。
                  </li>
                </ul>
              </li>
              <li>
                器官性疾病：器官性疾病大类主要涉及特定器官或器官系统的功能障碍或疾病。
                <ul style="margin-left: 30px; margin-top:5px; list-style-type: disc;">
                  <li>
                    肝病：如脂肪肝、病毒性肝炎、肝硬化等，与肝脏代谢和解毒功能异常等。
                  </li>
                  <li>
                    心脑血管疾病：如高血压、冠心病、心肌梗塞、脑梗等，与血管功能和心脑供血异常等。
                  </li>
                  <li>
                    甲状腺疾病：如甲状腺功能亢进、甲状腺功能减退和甲状腺结节等，涉及甲状腺激素的分泌异常。
                  </li>
                  <li>
                    肺部疾病：如慢性阻塞性肺疾病（COPD）、哮喘、肺炎等。
                  </li>
                </ul>
              </li>
              <li>
                神经系统疾病：神经系统疾病大类主要影响中枢神经系统（如大脑和脊髓）以及外周神经系统的功能和结构。
                <ul style="margin-left: 30px; margin-top:5px; list-style-type: disc;">
                  <li>
                    神经行为发育异常：如儿童发生的神经发育障碍，如自闭症谱系障碍（ASD）和注意缺陷多动障碍（ADHD）等。
                  </li>
                </ul>
              </li>

            </ul>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <h3 class="custom-title-third-level page-break">常见问题及说明</h3>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">

    <div class="qa-box">
      <div class="flex items-start ml-2">
        <p class="text-lg font-bold text-lightpurple">
          <i class="fas fa-question-circle icon icon-purple"></i>
          慢病的风险是如何评估的？
        </p>
      </div>
      <div class="flex items-start ml-2 mt-2">
        <p class="answer-text">
          <i class="fas fa-comments icon icon-orange"></i>
          利用数十万例的临床和人群样本数据，结合机器学习方法，我们针对数十种疾病使用肠道菌群数据进行疾病状态和风险的预测，并给出了精确的风险概率。
        </p>
      </div>
    </div>

    <div class="qa-box">
      <div class="flex items-start ml-2">
        <p class="text-lg font-bold text-lightpurple">
          <i class="fas fa-question-circle icon icon-purple"></i>
          评估结果易受到自身的一些疾病症状或者环境影响吗？
        </p>
      </div>
      <div class="flex items-start ml-2 mt-2">
        <p class="answer-text">
          <i class="fas fa-comments icon icon-orange"></i>
          疾病症状相关菌的检测丰度异常（无论是较参考范围偏少还是偏多）只是提示该菌群可能与某种疾病的相关症状相关，但它并不能直接证明一定会出现该疾病的相关症状。人体微生物组是一个复杂的生态系统，菌群丰度的变化受到多种因素的影响，包括饮食、生活习惯、遗传、药物使用等。此外，疾病的发生往往是多因素共同作用的结果，即使某种菌群与疾病存在关联，也需结合其他生物标志物、临床症状和医学检查进行综合评估。菌群的丰度异常更倾向于提供风险提示，如果确实出现了相关疾病症状，请及时咨询医生，以便得到专业诊断和治疗。
        </p>
      </div>
    </div>

    <div class="qa-box">
      <div class="flex items-start ml-2">
        <p class="text-lg font-bold text-lightpurple">
          <i class="fas fa-question-circle icon icon-purple"></i>
          如果慢病的风险评估不是中高风险，是否不用关注？
        </p>
      </div>
      <div class="flex items-start ml-2 mt-2">
        <p class="answer-text">
          <i class="fas fa-comments icon icon-orange"></i>
          疾病症状相关菌的检测丰度异常（无论是较参考范围偏少还是偏多）只是提示该菌群可能与某种疾病的相关症状相关，但它并不能直接证明一定会出现该疾病的相关症状。人体微生物组是一个复杂的生态系统，菌群丰度的变化受到多种因素的影响，包括饮食、生活习惯、遗传、药物使用等。此外，疾病的发生往往是多因素共同作用的结果，即使某种菌群与疾病存在关联，也需结合其他生物标志物、临床症状和医学检查进行综合评估。菌群的丰度异常更倾向于提供风险提示，如果确实出现了相关疾病症状，请及时咨询医生，以便得到专业诊断和治疗。
        </p>
      </div>
    </div>

    <!-- 严重疾病或家族疾病警告提示信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg">
            <i class="fas fa-exclamation-triangle" style="color: orange;"></i>
            <strong>注意：</strong>
            慢病相关风险评估结果旨在提供参考信息，不能作为疾病诊断或治疗的唯一依据。慢性疾病的发生和发展通常受到多种因素（如生活方式、遗传因素、环境因素等）的综合影响，检测结果需结合个人的实际情况、其他医学检查和专业医生的建议进行综合评估。分析结果中提及的风险相关性仅为可能性参考，不能直接等同于因果关系或作为健康状况的绝对判断依据。如果出现与相关慢病风险相关的异常症状或健康问题，请务必及时咨询医生，以确保获得科学、准确的诊断和适当的治疗或干预方案。
          </p>
        </div>
      </div>
    </div>

    <!-- 警告提示信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg">
            <i class="fas fa-exclamation-triangle" style="color: orange;"></i>
            <strong>特别注意：</strong>
            慢病相关风险评估结果旨在提供参考信息，不能作为疾病诊断或治疗的唯一依据。慢性疾病的发生和发展通常受到多种因素（如生活方式、遗传因素、环境因素等）的综合影响，检测结果需结合个人的实际情况、其他医学检查和专业医生的建议进行综合评估。分析结果中提及的风险相关性仅为可能性参考，不能直接等同于因果关系或作为健康状况的绝对判断依据。如果出现与相关慢病风险相关的异常症状或健康问题，请务必及时咨询医生，以确保获得科学、准确的诊断和适当的治疗或干预方案。
          </p>
        </div>
      </div>
    </div>
  </div>


  <!-- 慢病风险评估板块 -->
  <h3 class="custom-title-1 page-break">慢病风险评估表格</h3>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">
    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            下列表格展示了您的慢病风险评估数据（以风险评估等级递减排序）。
          </p>
        </div>
      </div>
    </div>

    <!-- 慢病风险评估板块 : 慢病风险表格 -->
    <div class="rounded-table">
      <!-- 主表格只包含标题 -->
      <table class="min-w-full">
        <thead>
        <tr style="background-color: #00B2B4; color: white;">
          <th class="py-2 px-4 text-left slow-disease-first-column" style="font-size: 13px;">
            评估慢病名称
          </th>
          <th class="py-2 px-4 text-center slow-disease-second-column" style="font-size: 13px; padding: 5px 5px;">
            风险评估数值
          </th>
          <th class="py-2 px-4 text-center slow-disease-third-column" style="font-size: 13px; padding: 5px 5px;">
            风险评估结果
          </th>
        </tr>
        </thead>
      </table>

      <!-- 数据表格容器 -->
      <div id="slow-disease-table-body">
        <!-- 数据将通过 JavaScript 动态插入 -->
      </div>
    </div>

    <script>
      // 确保 DATA_PATHS 已定义
      if (typeof DATA_PATHS === 'undefined') {
        var DATA_PATHS = {
          DATA: './data.json' // 默认路径，请确保这个路径是正确的
        };
      }

      // 慢病风险评估命名空间
      const SlowDiseaseRisk = {
        // 常量定义
        CONSTANTS: {
          COLORS: {
            RED: '#ff4d4f',
            GREEN: '#389e0d',
            GRAY: '#808080',
            PRIMARY: '#00B2B4',
            WARNING: '#FF0000',
            BLACK: '#000000',
            LOW_RISK: '#52c41a',    // 低风险
            ATTENTION: '#fadb14',   // 注意
            MEDIUM_RISK: '#faad14', // 中高风险
            HIGH_RISK: '#ff4d4f'    // 高风险
          },
          RANGE_MARKERS: [0.3, 0.5, 0.7] // 风险阈值标记
        },

        // 获取风险级别颜色
        getRiskColor(evaluationValue) {
          if (evaluationValue < this.CONSTANTS.RANGE_MARKERS[0]) return this.CONSTANTS.COLORS.LOW_RISK;
          if (evaluationValue < this.CONSTANTS.RANGE_MARKERS[1]) return this.CONSTANTS.COLORS.ATTENTION;
          if (evaluationValue < this.CONSTANTS.RANGE_MARKERS[2]) return this.CONSTANTS.COLORS.MEDIUM_RISK;
          return this.CONSTANTS.COLORS.HIGH_RISK;
        },

        // 获取风险级别标签
        getRiskLabel(evaluationValue) {
          if (evaluationValue < this.CONSTANTS.RANGE_MARKERS[0]) return "低风险";
          if (evaluationValue < this.CONSTANTS.RANGE_MARKERS[1]) return "注意";
          if (evaluationValue < this.CONSTANTS.RANGE_MARKERS[2]) return "中等风险";
          return "高风险";
        },

        // 创建描述行
        createDescriptionRow(disease) {
          // 如果没有说明，返回空字符串
          if (!disease["说明"] || disease["说明"].trim() === '') {
            return '';
          }

          return `
          <tr class="disease-desc-row">
            <td colspan="3" class="py-2 px-4 text-left">
              <div class="description-container text-gray-600" style="font-size: 11px;">
                <div class="flex items-start mb-0">
                  <div class="ml-1">
                    <p>
                      <i class="fas fa-info-circle" style="color: ${this.CONSTANTS.COLORS.PRIMARY};"></i>
                      ${disease["说明"]}
                    </p>
                  </div>
                </div>
              </div>
            </td>
          </tr>
        `;
        },

        // 创建疾病行
        createDiseaseRow(disease) {
          // 处理评估值 - 直接使用数字类型
          const evaluationValue = typeof disease["评估值"] === 'number'
            ? disease["评估值"]
            : parseFloat(disease["评估值"] || 0);

          if (isNaN(evaluationValue)) {
            return document.createElement('div'); // 返回空div避免错误
          }

          const riskColor = this.getRiskColor(evaluationValue);
          const resultLabel = disease["结果评价"] || this.getRiskLabel(evaluationValue);

          // 创建行容器
          const diseaseContainer = document.createElement('div');
          diseaseContainer.className = 'bacteria-info-container';

          const table = document.createElement('table');
          table.className = 'bacteria-table min-w-full';

          // 生成显示值的行
          const dataRow = `
          <tr>
            <td class="py-2 pl-4 pr-2 text-left slow-disease-first-column">
              <div class="slow-disease-chinese-text"><strong>${disease["检测项目"] || '未知项目'}</strong></div>
              <div class="slow-disease-english-text">${disease["英文名"] || '未知'}</div>
            </td>
            <td class="py-2 px-4 text-center slow-disease-column-text slow-disease-second-column">
              <div class="flex items-center justify-center">
                <span style="color: ${riskColor}">
                  <strong>${evaluationValue.toFixed(2)}</strong>
                </span>
              </div>
              <!-- 进度条及分界线 -->
              <div class="progress-bar-container w-full mt-2 relative">
                <div class="progress-bar w-full" style="background-color: #e9ecef; height: 8px; border-radius: 4px; overflow: hidden;">
                  <div class="progress"
                      style="width: ${(evaluationValue * 100) + '%'};
                            height: 100%;
                            background-color: ${riskColor};
                            transition: width 0.3s ease;">
                  </div>
                </div>
                <!-- 分界线 -->
                <div class="division-line" style="position: absolute; top: 0; bottom: 0; left: 30%; width: 1px; background-color: rgba(0,0,0,0.1);"></div>
                <div class="division-line" style="position: absolute; top: 0; bottom: 0; left: 50%; width: 1px; background-color: rgba(0,0,0,0.1);"></div>
                <div class="division-line" style="position: absolute; top: 0; bottom: 0; left: 70%; width: 1px; background-color: rgba(0,0,0,0.1);"></div>

                <!-- 范围标记 -->
                <div class="range-labels flex justify-between mt-1" style="font-size: 9px; color: #666;">
                  <span>0</span>
                  <span>0.3</span>
                  <span>0.5</span>
                  <span>0.7</span>
                  <span>1</span>
                </div>
              </div>
            </td>
            <td class="py-2 px-4 text-center slow-disease-column-text slow-disease-third-column">
              <span class="risk-label px-4 py-2 rounded-full text-white"
                    style="background-color: ${riskColor}; font-size: 12px; display: inline-block; min-width: 70px;">
                <strong>${resultLabel}</strong>
              </span>
            </td>
          </tr>
        `;

          // 生成描述行
          const descRow = this.createDescriptionRow(disease);

          table.innerHTML = `<tbody>${dataRow}${descRow}</tbody>`;
          diseaseContainer.appendChild(table);

          return diseaseContainer;
        },

        // 主渲染函数
        renderTable(diseaseData) {
          const container = document.getElementById('slow-disease-table-body');
          if (!container) {
            console.error('Cannot find container element: slow-disease-table-body');
            return;
          }

          container.innerHTML = '';

          // 如果没有数据
          if (!diseaseData || !Array.isArray(diseaseData) || diseaseData.length === 0) {
            container.innerHTML = '<div class="no-data-message">暂无数据</div>';
            return;
          }

          // 使用DocumentFragment批量处理DOM操作
          const fragment = document.createDocumentFragment();

          diseaseData.forEach(disease => {
            if (disease) {  // 确保disease存在
              const diseaseElement = this.createDiseaseRow(disease);
              fragment.appendChild(diseaseElement);
            }
          });

          // 一次性添加所有元素到DOM
          container.appendChild(fragment);
        },

        // 加载数据
        async loadData() {
          try {
            const response = await fetch(DATA_PATHS.DATA);
            if (!response.ok) {
              throw new Error(`Network response error: ${response.status}`);
            }

            const data = await response.json();

            // 检查慢病风险数据是否存在
            if (!data["慢病风险"] || !Array.isArray(data["慢病风险"])) {
              document.getElementById('slow-disease-table-body').innerHTML =
                '<div class="error-message">数据格式不正确</div>';
              return;
            }

            // 对慢病风险按照评估值从大到小排序
            data["慢病风险"].sort((a, b) => {
              // 处理数字类型的评估值
              const valueA = typeof a["评估值"] === 'number' ? a["评估值"] : parseFloat(a["评估值"] || 0);
              const valueB = typeof b["评估值"] === 'number' ? b["评估值"] : parseFloat(b["评估值"] || 0);
              return valueB - valueA;
            });

            this.renderTable(data["慢病风险"]);
          } catch (error) {
            console.error('Error loading slow disease risk data:', error);
            document.getElementById('slow-disease-table-body').innerHTML =
              '<div class="error-message">数据加载失败，请稍后再试</div>';
          }
        },

        // 初始化
        init() {
          if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => this.loadData());
          } else {
            this.loadData();
          }
        }
      };

      // 初始化慢病风险评估模块
      SlowDiseaseRisk.init();
    </script>
  </div>


  <!-- 疾病症状相关菌板块 -->

  <!-- 疾病症状相关菌首页 -->

  <h1 class="custom-title-second-level page-break">疾病症状相关菌</h1>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">
    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            临床研究数据揭示，肠道菌群丰度特征与疾病发生呈现显著相关性。特定菌群失调（如拟杆菌/厚壁菌比值异常）与代谢性疾病（肥胖、糖尿病）、免疫性疾病（过敏、IBD）及神经精神类疾病（抑郁、自闭症）存在明确生物标志物关联。通过菌群检测可识别微生态失衡特征，为疾病早期预警和精准干预提供重要依据。
          </p>
        </div>
      </div>
    </div>

    <!-- 6中疾病症状总结性的信息图表 -->

    <div class="disease-card">
      <div class="disease-icon-box obesity">
        <i class="fas fa-weight"></i>
        肥胖
      </div>
      <div class="disease-content-box">
        肥胖与肠道菌群失调密切相关，研究表明肥胖人群的肠道菌群多样性显著降低，拟杆菌/厚壁菌比例失衡。这种失衡会影响能量代谢、脂肪存储和食欲调节，同时增加炎症因子水平，形成恶性循环。益生菌干预可通过调节GLP-1和PYY等饱腹激素，帮助改善代谢功能。
      </div>
    </div>

    <div class="disease-card">
      <div class="disease-icon-box constipation">
        <i class="fas fa-exclamation-circle"></i>
        便秘
      </div>
      <div class="disease-content-box">
        便秘往往反映肠道菌群功能紊乱，主要表现为产丁酸菌群减少、肠道蠕动功能受损。健康菌群通过产生短链脂肪酸促进肠道蠕动，调节水分代谢，维持正常排便功能。双歧杆菌和乳酸菌的补充可有效改善肠道微环境，促进肠道蠕动。
      </div>
    </div>

    <div class="disease-card">
      <div class="disease-icon-box bloating">
        <i class="fas fa-expand-alt"></i>
        腹胀
      </div>
      <div class="disease-content-box">
        腹胀常见于肠道菌群发酵异常，产气菌群过度生长。这种状况会导致肠道气体产生增多，肠壁张力改变，引起腹部不适。调节肠道菌群结构，特别是限制产气菌群过度生长，同时增加有益菌数量，可有效缓解腹胀症状。
      </div>
    </div>

    <div class="disease-card">
      <div class="disease-icon-box allergy">
        <i class="fas fa-allergies"></i>
        过敏
      </div>
      <div class="disease-content-box">
        过敏与免疫系统过度反应及肠道屏障功能受损有关。健康的肠道菌群可通过调节Th1/Th2平衡，促进调节性T细胞生成，抑制过度免疫反应。益生菌干预能够增强肠道屏障功能，降低过敏原穿透，减轻过敏症状。
      </div>
    </div>

    <div class="disease-card">
      <div class="disease-icon-box depression">
        <i class="fas fa-brain"></i>
        抑郁
      </div>
      <div class="disease-content-box">
        肠-脑轴研究表明，肠道菌群通过神经递质、内分泌和免疫调节影响情绪。菌群失调会降低血清素、GABA等神经递质水平，增加炎症因子表达，影响认知功能和情绪调节。补充特定益生菌可改善肠道微生态，帮助缓解抑郁症状。
      </div>
    </div>

    <div class="disease-card">
      <div class="disease-icon-box insomnia">
        <i class="fas fa-moon"></i>
        失眠
      </div>
      <div class="disease-content-box">
        失眠与昼夜节律紊乱和神经递质失衡相关。肠道菌群参与褪黑激素、血清素等睡眠相关物质的合成与代谢，影响睡眠-觉醒周期。改善肠道菌群结构可以优化褪黑激素分泌节律，帮助调节睡眠周期。
      </div>
    </div>

  </div>

  <!-- 疾病相关菌阅读指南 -->
  <h1 class="custom-title-third-level page-break">阅读指南</h1>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">
    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            临床研究数据揭示，肠道菌群丰度特征与疾病症状的表现呈现显著相关性。通过菌群检测可识别微生态失衡特征，为疾病症状早期预警和精准干预提供重要依据。
          </p>
        </div>
      </div>
    </div>

    <!-- 问答信息框 -->
    <div class="qa-box">
      <div class="flex items-start ml-2">
        <p class="text-lg font-bold text-lightpurple">
          <i class="fas fa-question-circle icon icon-purple"></i>
          如何阅读疾病症状相关菌的表格？
        </p>
      </div>
      <div class="flex items-start ml-2 mt-2">
        <p class="answer-text">
          <i class="fas fa-comments icon icon-orange"></i>
          以下是对疾病症状相关菌的表格中的各部分信息进行的说明解释：
        </p>
      </div>
      <div class="flex items-start ml-2 mt-2">
        <ul style="margin-left: 50px; list-style-type: disc;">
          <li class="answer-text">
            <strong>疾病症状相关菌名称：</strong>
            这一列列出特定的症状相关菌群名称。
          </li>
          <li class="answer-text">
            <strong>参考范围%：</strong>
            此列显示该菌群的参考范围，此范围为比较您的检测结果提供了参考标准。
          </li>
          <li class="answer-text">
            <strong>检测丰度%：</strong>
            这一列显示经过检测后您体内该菌群在肠道微生物中的相对丰度，以数字（包括未检出）和进度条展示。
            <ul style="margin-left: 30px; margin-top:5px; list-style-type: disc;">
              <li>
                <i class="fas fa-arrow-up text-red-500 ml-0.5"></i>：表示该菌群的检测丰度较参考范围的下限偏少。
              </li>
              <li>
                <i class="fas fa-arrow-down text-red-500 ml-0.5"></i>：表示该菌群的检测丰度较参考范围的上限偏多。
              </li>
              <li>
                未检出：表示表示该菌群的相对丰度低于检出下限。
              </li>
            </ul>
          </li>
          <li class="answer-text">
            <strong>超过%的人：</strong>
            这一列展示了该菌群的检测丰度水平超过了多少同样进行过检测的人群比例。这一数据可以帮助您了解该菌群丰度在大人群中的分布情况。
          </li>
          <li class="answer-text">
            <strong>相关性：</strong>
            这一列标示该菌群丰度与特定疾病相关症状之间的关系。
            <ul style="margin-left: 30px; margin-top:5px; list-style-type: disc;">
              <li>
                若标记为“正相关”，则表示菌群丰度的升高与症状的发生与进展呈正相关。
              </li>
              <li>
                若标记为“负相关”，则表示菌群丰度的降低与症状的发生与进展呈正相关。
              </li>
            </ul>
          </li>
          <li class="answer-text">
            <strong>相关性强度：</strong>
            这一列表明该菌群和该疾病症状之间的相关性证据的强度，分为三个强度级别（正相关的相关性强度为<i class="fa fa-star text-orange-500" aria-hidden="true"></i>，负相关的相关性强度为<i class="fa fa-star text-blue-500" aria-hidden="true"></i>）
            <ul style="margin-left: 30px; margin-top:5px; list-style-type: disc;">
              <li>
                <i class="fa fa-star text-orange-500" aria-hidden="true"></i>（<i class="fa fa-star text-blue-500" aria-hidden="true"></i>）：依据的是单一研究或人群数据统计。
              </li>
              <li>
                <i class="fa fa-star text-orange-500" aria-hidden="true"></i><i class="fa fa-star text-orange-500" aria-hidden="true"></i>（<i class="fa fa-star text-blue-500" aria-hidden="true"></i><i class="fa fa-star text-blue-500" aria-hidden="true"></i>）：基于大规模人群样本统计和至少一项研究的支持。
              </li>
              <li>
                <i class="fa fa-star text-orange-500" aria-hidden="true"></i><i class="fa fa-star text-orange-500" aria-hidden="true"></i><i class="fa fa-star text-orange-500" aria-hidden="true"></i>（<i class="fa fa-star text-blue-500" aria-hidden="true"></i><i class="fa fa-star text-blue-500" aria-hidden="true"></i><i class="fa fa-star text-blue-500" aria-hidden="true"></i>）：有大量研究论文对此结果的确认。
              </li>
            </ul>
            在阅读表格时应着重关注下列菌群：
            <ul style="margin-left: 30px; margin-top:5px; list-style-type: disc;">
              <li>
                检测丰度较参考范围相对超标+相关性为正相关的菌群，该菌群整行会被橙色的边框包围来提示您重点关注。
              </li>
              <li>
                检测丰度较参考范围相对偏少+相关性为负相关的菌群，该菌群整行会被蓝色的边框包围来提示您重点关注。
              </li>
            </ul>
          </li>
          <li>
            <i class="fa fa-info-circle" style="color: rgb(0, 178, 180);"></i> 与 <i class="fa fa-bell text-red-500"></i> 分别是通过对全球最大规模的调查样本进行相关性分析和统计检验得出的菌群简介信息和丰度较参考范围异常时相对应的饮食改善。
          </li>
        </ul>
      </div>
    </div>

  </div>

  <h3 class="custom-title-third-level page-break">常见问题与说明</h3>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">
    <div class="qa-box">
      <div class="flex items-start ml-2">
        <p class="text-lg font-bold text-lightpurple">
          <i class="fas fa-question-circle icon icon-purple"></i>
          为什么选取这些疾病症状相关菌？
        </p>
      </div>
      <div class="flex items-start ml-2 mt-2">
        <p class="answer-text">
          <i class="fas fa-comments icon icon-orange"></i>
          这些疾病症状相关菌的选取主要基于两方面的依据：
        </p>
      </div>
      <div class="flex items-start ml-2 mt-2">
        <ul style="margin-left: 50px; list-style-type: disc;">
          <li class="answer-text">
            <strong>文献报告：</strong>
            通过参考已有的科学文献和研究成果，筛选出不同疾病和健康状态中具有明确关联的菌群。
          </li>
          <li class="answer-text">
            <strong>数据分析：</strong>
            利用我们数据库中的疾病样本与健康对照样本进行统计分析，筛选出在两者之间存在显著差异的菌群。
          </li>
        </ul>
      </div>
    </div>
    <div class="qa-box">
      <div class="flex items-start ml-2">
        <p class="text-lg font-bold text-lightpurple">
          <i class="fas fa-question-circle icon icon-purple"></i>
          涉及到的疾病症状相关菌和相对应的疾病症状存在因果关系吗？
        </p>
      </div>
      <div class="flex items-start ml-2 mt-2">
        <p class="answer-text">
          <i class="fas fa-comments icon icon-orange"></i>
          涉及到的疾病症状相关菌与相对应的疾病症状之间仅表现为相关性，并不能直接说明存在因果关系。相关性仅说明两者在统计数据中具有一定关联，但并不意味着一种情况会直接导致另一种情况的发生。对于因果关系的判断，还需要通过更多的机制研究才能确定。
        </p>
      </div>
    </div>
    <div class="qa-box">
      <div class="flex items-start ml-2">
        <p class="text-lg font-bold text-lightpurple">
          <i class="fas fa-question-circle icon icon-purple"></i>
          疾病症状相关菌的检测丰度较参考范围正常代表着一定不会出现该疾病相关症状吗？
        </p>
      </div>
      <div class="flex items-start ml-2 mt-2">
        <p class="answer-text">
          <i class="fas fa-comments icon icon-orange"></i>
          菌群的检测丰度较参考违反正常并不能完全排除疾病相关症状的出现。疾病的发生通常是多种因素综合作用的结果，包括其他菌群的丰度变化、遗传因素、免疫状态、环境影响、生活习惯等。此外，有些疾病的表现可能由其他病原体或非微生物因素引发，而不一定完全依赖特定菌群的丰度异常。
          因此，即使检测结果显示菌群丰度正常，如果仍出现相关疾病的症状，建议及时咨询医生进行更全面的检查和评估，以明确病因并采取适当的诊疗措施。
        </p>
      </div>
    </div>
    <div class="qa-box">
      <div class="flex items-start ml-2">
        <p class="text-lg font-bold text-lightpurple">
          <i class="fas fa-question-circle icon icon-purple"></i>
          疾病症状相关菌的检测丰度较参考范围异常代表着一定会出现该疾病相关症状吗？
        </p>
      </div>
      <div class="flex items-start ml-2 mt-2">
        <p class="answer-text">
          <i class="fas fa-comments icon icon-orange"></i>
          疾病症状相关菌的检测丰度异常（无论是较参考范围偏少还是偏多）只是提示该菌群可能与某种疾病的相关症状相关，但它并不能直接证明一定会出现该疾病的相关症状。人体微生物组是一个复杂的生态系统，菌群丰度的变化受到多种因素的影响，包括饮食、生活习惯、遗传、药物使用等。此外，疾病的发生往往是多因素共同作用的结果，即使某种菌群与疾病存在关联，也需结合其他生物标志物、临床症状和医学检查进行综合评估。菌群的丰度异常更倾向于提供风险提示，如果确实出现了相关疾病症状，请及时咨询医生，以便得到专业诊断和治疗。
        </p>
      </div>
    </div>

    <!-- 警告提示信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg">
            <i class="fas fa-exclamation-triangle" style="color: orange;"></i>
            <strong>特别注意：</strong>
            疾病症状相关群的分析结果旨在提供参考信息，不能作为疾病症状诊断或治疗的唯一依据。微生物组的变化具有复杂性，检测结果需结合个人的实际情况、其他医学检查和专业医生的建议进行综合评估。请勿将相关性结果直接等同于因果关系或作为健康状况的绝对判断依据。如果出现相关疾病的症状，务必及时咨询医生，以确保获得科学准确的诊断和适当的治疗方案。
          </p>
        </div>
      </div>
    </div>

  </div>

  <!-- 疾病症状相关菌 : 肥胖相关菌 -->

  <h3 class="custom-title-third-level page-break">
    肥胖相关菌
  </h3>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">
    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            肠道菌群失衡会显著影响人体的代谢功能，研究表明，肥胖人群的肠道菌群结构与正常体重人群存在明显差异，这种失衡可能是导致肥胖的重要因素之一
          </p>
        </div>
      </div>
    </div>

    <div class="rounded-table">
      <!-- 创建表格头部 -->
      <table class="min-w-full">
        <thead>
        <tr style="background-color: #00B2B4; color: white;">
          <th
            class="py-2 px-4 text-left obesity-first-column"
            style="font-size: 13px;">肥胖相关菌名称</th>
          <th
            class="py-2 px-4 text-center obesity-second-column"
            style="font-size: 13px; padding: 5px 5px;">参考范围%</th>
          <th
            class="py-2 px-4 text-center obesity-third-column"
            style="font-size: 13px; padding: 5px 5px;">检测丰度%</th>
          <th
            class="py-2 px-4 text-center obesity-fourth-column"
            style="font-size: 13px; padding: 5px 5px;">相关性</th>
          <th
            class="py-2 px-4 text-center obesity-fifth-column"
            style="font-size: 13px; padding: 5px 5px;">相关性强度</th>
        </tr>
        </thead>
      </table>

      <!-- 数据表格容器 -->
      <div id="obesity-data-table-body"></div>
    </div>

    <script>
      // 肥胖相关菌数据展示模块
      const ObesityBacteria = {
        // 常量定义
        CONSTANTS: {
          COLORS: {
            RED: '#ff4d4f',
            GREEN: '#389e0d',
            YELLOW: '#faad14',
            BLUE: '#3b82f6',
            GRAY: '#808080',
            BLACK: '#000000',
            PRIMARY: '#00B2B4',
            WARNING: '#faad14',
            ORANGE: '#fa8c16'
          },
          CORRELATION: {
            "+": {
              text: "正相关",
              textColor: "text-black", // 文本显示为黑色
              starColor: "text-orange-500" // 星星保持橙色
            },
            "-": {
              text: "负相关",
              textColor: "text-black", // 文本显示为黑色
              starColor: "text-blue-500" // 星星保持蓝色
            }
          }
        },

        // 格式化数字
        formatNumber(value, precision = 2) {
          if (value === "ND") return "未检出";
          if (typeof value === "string") {
            // 尝试将字符串转换为数字
            const num = Number(value);
            if (isNaN(num)) return value;
            return num.toPrecision(precision).replace(/\.?0+$/, '');
          }
          return value.toPrecision(precision).replace(/\.?0+$/, '');
        },

        // 解析正常范围
        parseRange(rangeStr) {
          if (!rangeStr || typeof rangeStr !== 'string') {
            return { min: 0, max: 0 };
          }
          const parts = rangeStr.split('-');
          return {
            min: parseFloat(parts[0] || 0),
            max: parseFloat(parts[1] || 0)
          };
        },

        // 分离中文名和拉丁名
        separateName(fullName) {
          if (!fullName) return { chineseName: '', latinName: '' };

          // 假设拉丁名是斜体或者包含字母的部分
          // 常见的分隔模式: "中文名 拉丁名" 或 "中文名（拉丁名）"
          let chineseName, latinName;

          if (fullName.includes('(') || fullName.includes('（')) {
            // 处理带括号的形式: "中文名（拉丁名）"
            const match = fullName.match(/(.*?)[\(（](.*?)[\)）]/);
            if (match) {
              chineseName = match[1].trim();
              latinName = match[2].trim();
            } else {
              // 没找到括号匹配，使用整个名称
              chineseName = fullName;
              latinName = '';
            }
          } else {
            // 处理空格分隔的形式: "中文名 拉丁名"
            // 假设拉丁名包含字母
            const hasLatin = /[a-zA-Z]/.test(fullName);

            if (hasLatin) {
              // 查找第一个字母出现的位置
              const firstLatinIndex = fullName.search(/[a-zA-Z]/);
              if (firstLatinIndex > 0) {
                // 将名称分为两部分
                chineseName = fullName.substring(0, firstLatinIndex).trim();
                latinName = fullName.substring(firstLatinIndex).trim();
              } else {
                // 如果拉丁名在最前面，整个作为拉丁名
                chineseName = '';
                latinName = fullName.trim();
              }
            } else {
              // 没有拉丁字符，整个作为中文名
              chineseName = fullName;
              latinName = '';
            }
          }

          return { chineseName, latinName };
        },

        // 获取状态信息
        getStatus(detected, normalRange) {
          const { min, max } = this.parseRange(normalRange);

          if (detected === "ND") {
            if (min > 0) {
              // 如果参考范围下限大于0，但检测结果为未检出，显示为缺乏状态（红色+向下箭头）
              return {
                text: '缺乏',
                color: this.CONSTANTS.COLORS.RED,
                icon: '<i class="fas fa-arrow-down ml-1" style="color: ' + this.CONSTANTS.COLORS.RED + ';"></i>',
                isNormal: false,
                direction: 'down',
                isGrayND: false
              };
            } else {
              // 如果参考范围下限为0，检测结果为未检出是正常的，显示为灰色
              return {
                text: '正常',
                color: this.CONSTANTS.COLORS.GRAY,
                icon: '',
                isNormal: true,
                direction: null,
                isGrayND: true
              };
            }
          }

          if (detected < min) {
            return {
              text: '偏低',
              color: this.CONSTANTS.COLORS.RED,
              icon: '<i class="fas fa-arrow-down ml-1" style="color: ' + this.CONSTANTS.COLORS.RED + ';"></i>',
              isNormal: false,
              direction: 'down',
              isGrayND: false
            };
          } else if (detected > max) {
            return {
              text: '超标',
              color: this.CONSTANTS.COLORS.RED,
              icon: '<i class="fas fa-arrow-up ml-1" style="color: ' + this.CONSTANTS.COLORS.RED + ';"></i>',
              isNormal: false,
              direction: 'up',
              isGrayND: false
            };
          } else {
            return {
              text: '正常',
              color: this.CONSTANTS.COLORS.GREEN,
              icon: '',
              isNormal: true,
              direction: null,
              isGrayND: false
            };
          }
        },

        // 生成星星评级
        generateStars(count, correlationType) {
          // 使用starColor而不是textColor来设置星星颜色
          const starColor = this.CONSTANTS.CORRELATION[correlationType].starColor;
          return Array(3).fill().map((_, i) =>
            `<i class="fa fa-star ${i < count ? starColor : 'text-gray-300'}" aria-hidden="true"></i>`
          ).join('');
        },

        // 计算进度条百分比
        calculateProgressWidth(value) {
          if (value === 'ND' || value === 0) return 0;

          const num = Number(value);
          if (num <= 20) {
            return Math.min(20, Math.max(5, num * 1.5));
          }
          return Math.min(100, Math.max(0, num));
        },

        // 创建描述行
        createDescriptionRow(bacteria, status) {
          let descriptionContent = '';

          // 首先添加常规简介
          if (bacteria.说明 && bacteria.说明.trim()) {
            descriptionContent += `
            <div class="flex items-start mb-0">
              <div class="ml-1">
                <p>
                  <i class="fas fa-info-circle" style="color: ${this.CONSTANTS.COLORS.PRIMARY};"></i>
                  ${bacteria.说明}
                </p>
              </div>
            </div>
          `;
          }

          // 如果状态不是正常，根据状态添加相应的改善建议
          if (!status.isNormal && bacteria.改善方式 && bacteria.改善方式.trim()) {
            descriptionContent += `
            <div class="flex items-start mt-0">
              <div class="ml-1">
                <p>
                  <i class="fas fa-bell" style="color: ${this.CONSTANTS.COLORS.WARNING};"></i>
                  <strong>改善建议：</strong> ${bacteria.改善方式}
                </p>
              </div>
            </div>
          `;
          }

          // 如果有内容需要显示，返回完整的行
          if (descriptionContent.trim()) {
            return `
            <tr class="description-row">
              <td colspan="5" class="py-2 px-4 text-left">
                <div class="description-container text-gray-600" style="font-size: 11px;">
                  ${descriptionContent}
                </div>
              </td>
            </tr>
          `;
          }

          // 如果没有描述内容，返回空字符串
          return '';
        },

        // 渲染表格
        renderTable(bacteriaData) {
          const container = document.getElementById('obesity-data-table-body');
          if (!container) {
            console.error('Cannot find container element');
            return;
          }

          container.innerHTML = '';

          if (!bacteriaData || !Array.isArray(bacteriaData) || bacteriaData.length === 0) {
            container.innerHTML = '<div class="text-center p-4 text-red-500">暂无肥胖相关菌数据</div>';
            return;
          }

          const fragment = document.createDocumentFragment();

          bacteriaData.forEach(bacteria => {
            const fullName = bacteria.名称;
            const { chineseName, latinName } = this.separateName(fullName);
            const detected = bacteria["丰度%"];
            const normalRange = bacteria["正常范围"];
            const correlation = bacteria["问题相关性"];
            const evidenceStrength = parseInt(bacteria["证据强度"] || "0", 10);

            const { min, max } = this.parseRange(normalRange);
            const status = this.getStatus(detected, normalRange);
            const isPositive = correlation === "+";
            const isNegative = correlation === "-";
            const correlationText = this.CONSTANTS.CORRELATION[correlation].text;

            // 创建容器
            const bacteriaContainer = document.createElement('div');
            bacteriaContainer.className = 'bacteria-info-container';

            // 高亮风险组合：
            // 1. 正相关且超标
            // 2. 负相关且偏低或缺乏（包括未检出但应该有的情况）
            if ((status.text === '超标' && isPositive) ||
              ((status.text === '偏低' || status.text === '缺乏') && isNegative)) {
              // 选择合适的边框颜色
              let borderColor;
              if (isPositive) {
                borderColor = this.CONSTANTS.COLORS.RED; // 正相关+超标用红色
              } else {
                borderColor = this.CONSTANTS.COLORS.ORANGE; // 负相关+偏低/缺乏用橙色
              }

              bacteriaContainer.style.border = `1px solid ${borderColor}`;
              bacteriaContainer.style.borderRadius = '4px';
              bacteriaContainer.style.margin = '4px 0';
            } else {
              bacteriaContainer.style.border = '1px solid transparent';
            }

            // 创建表格
            const table = document.createElement('table');
            table.className = 'bacteria-table min-w-full';

            // 数据行
            const progressPercentage = this.calculateProgressWidth(detected);

            // 根据状态确定未检出的颜色
            const detectedText = detected === "ND"
              ? (status.isGrayND ? '<span style="color: ' + this.CONSTANTS.COLORS.GRAY + '">未检出</span>' : '未检出')
              : this.formatNumber(detected);

            const dataRow = `
            <tr>
              <td class="py-2 px-4 text-left obesity-first-column">
                <div class="obesity-chinese-text"><strong>${chineseName || '未知'}</strong></div>
                <div class="obesity-latin-text text-gray-500">${latinName || ''}</div>
              </td>
              <td class="py-2 px-4 text-center obesity-second-column obesity-column-text">
                ${min.toPrecision(2)}-${max.toPrecision(2)}
              </td>
              <td class="py-2 px-4 text-center obesity-third-column disease-column-text">
                <span style="color: ${status.isNormal && !status.isGrayND ? 'inherit' : status.color}">
                  ${detectedText}
                  ${status.icon || ''}
                </span>
                <div class="progress-bar w-full mt-2" style="background-color: #e9ecef; height: 8px; border-radius: 4px; overflow: hidden;">
                  <div class="progress"
                       style="width: ${progressPercentage}%;
                              height: 100%;
                              background-color: ${this.CONSTANTS.COLORS.PRIMARY};
                              transition: width 0.3s ease;">
                  </div>
                </div>
              </td>
              <td class="py-2 px-4 text-center obesity-fourth-column obesity-column-text">
                <span class="${this.CONSTANTS.CORRELATION[correlation].textColor}">${correlationText}</span>
              </td>
              <td class="py-2 px-4 text-center obesity-fifth-column obesity-column-text">
                <div class="flex justify-center items-center">
                  ${this.generateStars(evidenceStrength, correlation)}
                </div>
              </td>
            </tr>
          `;

            // 描述行（同时包含说明和改善建议）
            const descRow = this.createDescriptionRow(bacteria, status);

            table.innerHTML = `<tbody>${dataRow}${descRow}</tbody>`;
            bacteriaContainer.appendChild(table);
            fragment.appendChild(bacteriaContainer);
          });

          container.appendChild(fragment);
        },

        // 加载数据
        async loadData() {
          try {
            const response = await fetch(DATA_PATHS.DATA);
            if (!response.ok) {
              throw new Error(`Network response error: ${response.status}`);
            }
            const data = await response.json();

            // 提取肥胖相关菌数据
            const obesityData = data["疾病相关菌"] ? data["疾病相关菌"]["肥胖"] : [];
            this.renderTable(obesityData);
          } catch (error) {
            console.error('Error loading obesity bacteria data:', error);
            document.getElementById('obesity-data-table-body').innerHTML =
              '<div class="text-center p-4 text-red-500">数据加载失败，请稍后再试</div>';
          }
        },

        // 初始化
        init() {
          if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => this.loadData());
          } else {
            this.loadData();
          }
        }
      };

      // 初始化肥胖相关菌模块
      ObesityBacteria.init();
    </script>

  </div>

  <!-- 疾病症状相关菌 : 便秘相关菌 -->

  <h3 class="custom-title-third-level page-break">
    便秘相关菌
  </h3>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">
    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            肠道菌群失调通过减少短链脂肪酸（如丁酸）合成削弱肠蠕动，甲烷菌过度增殖抑制肠道推进运动（便秘患者甲烷呼气浓度升高1.8倍），而拟杆菌/普雷沃菌比例失衡导致肠道神经递质5-HT合成减少。临床研究显示，益生菌联合膳食纤维干预可使排便频率提升65%，产丁酸菌丰度恢复至健康水平82%。
          </p>
        </div>
      </div>
    </div>

    <div class="rounded-table">
      <!-- 创建表格头部 -->
      <table class="min-w-full">
        <thead>
        <tr style="background-color: #00B2B4; color: white;">
          <th
            class="py-2 px-4 text-left constipation-first-column"
            style="font-size: 13px;"
          >
            便秘相关菌种名称
          </th>
          <th
            class="py-2 px-4 text-center constipation-second-column"
            style="font-size: 13px; padding: 5px 5px;"
          >
            正常范围%
          </th>
          <th
            class="py-2 px-4 text-center constipation-third-column"
            style="font-size: 13px; padding: 5px 5px;"
          >
            检测丰度%
          </th>
          <th
            class="py-2 px-4 text-center constipation-fourth-column"
            style="font-size: 13px; padding: 5px 5px;"
          >
            相关性
          </th>
          <th
            class="py-2 px-4 text-center constipation-fifth-column"
            style="font-size: 13px; padding: 5px 5px;"
          >
            相关性强度
          </th>
        </tr>
        </thead>
      </table>

      <!-- 数据表格容器 -->
      <div id="constipation-data-table-body">
        <!-- 数据将通过 JavaScript 动态插入 -->
      </div>
    </div>

    <script>
      // 便秘相关菌数据展示模块
      const ConstipationBacteria = {
        // 常量定义
        CONSTANTS: {
          COLORS: {
            RED: '#ff4d4f',
            GREEN: '#389e0d',
            YELLOW: '#faad14',
            BLUE: '#3b82f6',
            GRAY: '#808080',
            BLACK: '#000000',
            PRIMARY: '#00B2B4',
            WARNING: '#faad14',
            ORANGE: '#fa8c16'
          },
          CORRELATION: {
            "+": {
              text: "正相关",
              textColor: "text-black",
              starColor: "text-orange-500"
            },
            "-": {
              text: "负相关",
              textColor: "text-black",
              starColor: "text-blue-500"
            }
          }
        },

        // 格式化数字
        formatNumber(value, precision = 2) {
          if (value === "ND" || value === "-") return value;
          const num = Number(value);
          if (isNaN(num)) return value;
          return num.toPrecision(precision).replace(/\.?0+$/, '');
        },

        // 解析正常范围
        parseRange(rangeStr) {
          if (!rangeStr || typeof rangeStr !== 'string') {
            return { min: 0, max: 0 };
          }
          const parts = rangeStr.split('-');
          return {
            min: parseFloat(parts[0] || 0),
            max: parseFloat(parts[1] || 0)
          };
        },

        // 分离中文名和拉丁名
        separateName(fullName) {
          if (!fullName) return { chineseName: '', latinName: '' };

          // 假设格式是"中文名 拉丁名"，用空格分隔
          const parts = fullName.split(' ');

          // 如果只有一个部分，或者没有包含拉丁字符的部分
          if (parts.length === 1) {
            return { chineseName: parts[0], latinName: '' };
          }

          // 找到第一个包含拉丁字符的部分
          let latinIndex = -1;
          for (let i = 0; i < parts.length; i++) {
            if (/[a-zA-Z]/.test(parts[i])) {
              latinIndex = i;
              break;
            }
          }

          if (latinIndex === -1) {
            // 如果没有找到拉丁字符，全部作为中文名
            return { chineseName: fullName, latinName: '' };
          }

          // 分离中文名和拉丁名
          const chineseName = parts.slice(0, latinIndex).join(' ');
          const latinName = parts.slice(latinIndex).join(' ');

          return { chineseName, latinName };
        },

        // 获取状态信息
        getStatus(detected, normalRange) {
          const { min, max } = this.parseRange(normalRange);

          if (detected === "ND") {
            if (min > 0) {
              return {
                text: '缺乏',
                color: this.CONSTANTS.COLORS.RED,
                icon: '<i class="fas fa-arrow-down ml-1" style="color: ' + this.CONSTANTS.COLORS.RED + ';"></i>',
                isNormal: false,
                direction: 'down',
                isGrayND: false
              };
            } else {
              return {
                text: '正常',
                color: this.CONSTANTS.COLORS.GRAY,
                icon: '',
                isNormal: true,
                direction: null,
                isGrayND: true
              };
            }
          }

          // 如果检测值不是ND，转换为数字进行比较
          const numDetected = Number(detected);

          if (numDetected < min) {
            return {
              text: '偏低',
              color: this.CONSTANTS.COLORS.RED,
              icon: '<i class="fas fa-arrow-down ml-1" style="color: ' + this.CONSTANTS.COLORS.RED + ';"></i>',
              isNormal: false,
              direction: 'down',
              isGrayND: false
            };
          } else if (numDetected > max) {
            return {
              text: '超标',
              color: this.CONSTANTS.COLORS.RED,
              icon: '<i class="fas fa-arrow-up ml-1" style="color: ' + this.CONSTANTS.COLORS.RED + ';"></i>',
              isNormal: false,
              direction: 'up',
              isGrayND: false
            };
          } else {
            return {
              text: '正常',
              color: this.CONSTANTS.COLORS.GREEN,
              icon: '',
              isNormal: true,
              direction: null,
              isGrayND: false
            };
          }
        },

        // 生成星星评级
        generateStars(count, correlationType) {
          const starColor = this.CONSTANTS.CORRELATION[correlationType].starColor;
          return Array(3).fill().map((_, i) =>
            `<i class="fa fa-star ${i < count ? starColor : 'text-gray-300'}" aria-hidden="true"></i>`
          ).join('');
        },

        // 计算进度条百分比
        calculateProgressWidth(value) {
          if (value === 'ND' || value === 0) return 0;

          const num = Number(value);
          if (isNaN(num)) return 0;

          if (num <= 20) {
            return Math.min(20, Math.max(5, num * 1.5));
          }
          return Math.min(100, Math.max(0, num));
        },

        // 创建描述行
        createDescriptionRow(bacteria, status) {
          let descriptionContent = '';

          // 添加常规说明
          if (bacteria.说明 && bacteria.说明.trim()) {
            descriptionContent += `
            <div class="flex items-start mb-0">
              <div class="ml-1">
                <p>
                  <i class="fas fa-info-circle" style="color: ${this.CONSTANTS.COLORS.PRIMARY};"></i>
                  ${bacteria.说明}
                </p>
              </div>
            </div>
          `;
          }

          // 如果状态不是正常，并且有改善方式，添加改善建议
          if (!status.isNormal && bacteria.改善方式 && bacteria.改善方式.trim()) {
            descriptionContent += `
            <div class="flex items-start mt-0">
              <div class="ml-1">
                <p>
                  <i class="fas fa-bell" style="color: ${this.CONSTANTS.COLORS.WARNING};"></i>
                  <strong>改善建议：</strong> ${bacteria.改善方式}
                </p>
              </div>
            </div>
          `;
          }

          // 如果有内容需要显示，返回完整的行
          if (descriptionContent.trim()) {
            return `
            <tr class="description-row">
              <td colspan="6" class="py-2 px-4 text-left">
                <div class="description-container text-gray-600" style="font-size: 11px;">
                  ${descriptionContent}
                </div>
              </td>
            </tr>
          `;
          }

          // 如果没有描述内容，返回空字符串
          return '';
        },

        // 渲染表格
        renderTable(constipationData) {
          const container = document.getElementById('constipation-data-table-body');
          if (!container) {
            console.error('Cannot find container element');
            return;
          }

          container.innerHTML = '';

          if (!constipationData || !Array.isArray(constipationData) || constipationData.length === 0) {
            container.innerHTML = '<div class="text-center p-4 text-red-500">暂无便秘相关菌数据</div>';
            return;
          }

          const fragment = document.createDocumentFragment();

          constipationData.forEach(bacteria => {
            const { chineseName, latinName } = this.separateName(bacteria.名称);
            const normalRange = bacteria.正常范围;
            const detected = bacteria["丰度%"];
            const higherThanPercentage = bacteria.超过人群百分比 || "-";
            const correlation = bacteria.问题相关性;
            const evidenceStrength = parseInt(bacteria.证据强度 || "0", 10);

            const { min, max } = this.parseRange(normalRange);
            const status = this.getStatus(detected, normalRange);
            const isPositive = correlation === "+";
            const isNegative = correlation === "-";

            // 创建容器
            const bacteriaContainer = document.createElement('div');
            bacteriaContainer.className = 'bacteria-info-container';

            // 高亮风险组合
            if ((status.text === '超标' && isPositive) ||
              ((status.text === '偏低' || status.text === '缺乏') && isNegative)) {
              // 选择合适的边框颜色
              let borderColor;
              if (isPositive) {
                borderColor = this.CONSTANTS.COLORS.RED; // 正相关+超标用红色
              } else {
                borderColor = this.CONSTANTS.COLORS.ORANGE; // 负相关+偏低/缺乏用橙色
              }

              bacteriaContainer.style.border = `1px solid ${borderColor}`;
              bacteriaContainer.style.borderRadius = '4px';
              bacteriaContainer.style.margin = '4px 0';
            } else {
              bacteriaContainer.style.border = '1px solid transparent';
            }

            // 创建表格
            const table = document.createElement('table');
            table.className = 'bacteria-table min-w-full';

            // 格式化数值
            const formattedMinRange = this.formatNumber(min, 2);
            const formattedMaxRange = this.formatNumber(max, 2);

            // 数据行
            const progressPercentage = this.calculateProgressWidth(detected);

            // 根据状态确定未检出的颜色
            const detectedText = detected === "ND"
              ? (status.isGrayND ? `<span style="color: ${this.CONSTANTS.COLORS.GRAY}">未检出</span>` : '未检出')
              : this.formatNumber(detected);

            const dataRow = `
            <tr>
              <td class="py-2 px-4 text-left constipation-first-column">
                <div class="obesity-chinese-text"><strong>${chineseName || '未知'}</strong></div>
                <div class="obesity-latin-text text-gray-500">${latinName || ''}</div>
              </td>
              <td class="py-2 px-4 text-center constipation-second-column obesity-column-text">
                ${formattedMinRange}-${formattedMaxRange}
              </td>
              <td class="py-2 px-4 text-center constipation-third-column disease-column-text">
                <span style="color: ${status.isNormal && !status.isGrayND ? 'inherit' : status.color}">
                  ${detectedText}
                  ${status.icon || ''}
                </span>
                <div class="progress-bar w-full mt-2" style="background-color: #e9ecef; height: 8px; border-radius: 4px; overflow: hidden;">
                  <div class="progress"
                       style="width: ${progressPercentage}%;
                              height: 100%;
                              background-color: ${this.CONSTANTS.COLORS.PRIMARY};
                              transition: width 0.3s ease;">
                  </div>
                </div>
              </td>

              <td class="py-2 px-4 text-center constipation-fourth-column disease-column-text">
                <span class="${this.CONSTANTS.CORRELATION[correlation].textColor}">${this.CONSTANTS.CORRELATION[correlation].text}</span>
              </td>
              <td class="py-2 px-4 text-center constipation-fifth-column disease-column-text">
                <div class="flex justify-center items-center">
                  ${this.generateStars(evidenceStrength, correlation)}
                </div>
              </td>
            </tr>
          `;

            // 描述行
            const descRow = this.createDescriptionRow(bacteria, status);

            table.innerHTML = `<tbody>${dataRow}${descRow}</tbody>`;
            bacteriaContainer.appendChild(table);
            fragment.appendChild(bacteriaContainer);
          });

          container.appendChild(fragment);
        },

        // 加载数据
        async loadData() {
          try {
            const response = await fetch(DATA_PATHS.DATA);
            if (!response.ok) {
              throw new Error(`Network response error: ${response.status}`);
            }
            const data = await response.json();

            // 提取便秘相关菌数据
            const constipationData = data["疾病相关菌"] ? data["疾病相关菌"]["便秘"] : [];
            this.renderTable(constipationData);
          } catch (error) {
            console.error('Error loading constipation bacteria data:', error);
            document.getElementById('constipation-data-table-body').innerHTML =
              '<div class="text-center p-4 text-red-500">数据加载失败，请稍后再试</div>';
          }
        },

        // 初始化
        init() {
          if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => this.loadData());
          } else {
            this.loadData();
          }
        }
      };

      // 初始化便秘相关菌模块
      ConstipationBacteria.init();
    </script>
  </div>

  <!-- 疾病症状相关菌 : 腹胀相关菌 -->

  <h3 class="custom-title-third-level page-break">
    腹胀相关菌
  </h3>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">
    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            肠道菌群失衡可通过异常产气、肠动力障碍及屏障损伤引发腹胀：产甲烷菌和厚壁菌门过度增殖导致气体异常蓄积（甲烷浓度达健康组2.1倍），拟杆菌减少削弱短链脂肪酸对肠蠕动的调节（转运时间延长35%），而变形菌门增殖引发的肠漏使未消化物质发酵加剧。临床干预显示，低FODMAP饮食联合益生菌干预4周可降低腹胀频率62%，并显著减少产甲烷菌丰度。
          </p>
        </div>
      </div>
    </div>

    <div class="rounded-table">
      <!-- 创建表格头部 -->
      <table class="min-w-full">
        <thead>
        <tr style="background-color: #00B2B4; color: white;">
          <th
            class="py-2 px-4 text-left bloating-first-column"
            style="font-size: 13px;"
          >
            腹胀相关菌名称
          </th>
          <th
            class="py-2 px-4 text-center bloating-second-column"
            style="font-size: 13px; padding: 5px 5px;"
          >
            参考范围%
          </th>
          <th
            class="py-2 px-4 text-center bloating-third-column"
            style="font-size: 13px; padding: 5px 5px;"
          >
            检测丰度%
          </th>
          <th
            class="py-2 px-4 text-center bloating-fourth-column"
            style="font-size: 13px; padding: 5px 5px;"
          >
            相关性
          </th>
          <th
            class="py-2 px-4 text-center bloating-fifth-column"
            style="font-size: 13px; padding: 5px 5px;"
          >
            相关性强度
          </th>
        </tr>
        </thead>
      </table>

      <!-- 数据表格容器 -->
      <div id="bloating-data-table-body">
        <!-- 数据将通过 JavaScript 动态插入 -->
      </div>
    </div>

    <script>
      // 腹胀相关菌数据展示模块
      const BloatingBacteria = {
        // 常量定义
        CONSTANTS: {
          COLORS: {
            RED: '#ff4d4f',
            GREEN: '#389e0d',
            YELLOW: '#faad14',
            BLUE: '#3b82f6',
            GRAY: '#808080',
            BLACK: '#000000',
            PRIMARY: '#00B2B4',
            WARNING: '#faad14',
            ORANGE: '#fa8c16'
          },
          CORRELATION: {
            "+": {
              text: "正相关",
              textColor: "text-black",
              starColor: "text-orange-500"
            },
            "-": {
              text: "负相关",
              textColor: "text-black",
              starColor: "text-blue-500"
            }
          }
        },

        // 格式化数字
        formatNumber(value, precision = 2) {
          if (value === "ND" || value === "-") return value;
          const num = Number(value);
          if (isNaN(num)) return value;
          return num.toPrecision(precision).replace(/\.?0+$/, '');
        },

        // 解析正常范围
        parseRange(rangeStr) {
          if (!rangeStr || typeof rangeStr !== 'string') {
            return { min: 0, max: 0 };
          }
          const parts = rangeStr.split('-');
          return {
            min: parseFloat(parts[0] || 0),
            max: parseFloat(parts[1] || 0)
          };
        },

        // 分离中文名和拉丁名
        separateName(fullName) {
          if (!fullName) return { chineseName: '', latinName: '' };

          // 假设格式是"中文名 拉丁名"，用空格分隔
          const parts = fullName.split(' ');

          // 如果只有一个部分，或者没有包含拉丁字符的部分
          if (parts.length === 1) {
            return { chineseName: parts[0], latinName: '' };
          }

          // 找到第一个包含拉丁字符的部分
          let latinIndex = -1;
          for (let i = 0; i < parts.length; i++) {
            if (/[a-zA-Z]/.test(parts[i])) {
              latinIndex = i;
              break;
            }
          }

          if (latinIndex === -1) {
            // 如果没有找到拉丁字符，全部作为中文名
            return { chineseName: fullName, latinName: '' };
          }

          // 分离中文名和拉丁名
          const chineseName = parts.slice(0, latinIndex).join(' ');
          const latinName = parts.slice(latinIndex).join(' ');

          return { chineseName, latinName };
        },

        // 获取状态信息
        getStatus(detected, normalRange) {
          const { min, max } = this.parseRange(normalRange);

          if (detected === "ND") {
            if (min > 0) {
              return {
                text: '缺乏',
                color: this.CONSTANTS.COLORS.RED,
                icon: '<i class="fas fa-arrow-down ml-1" style="color: ' + this.CONSTANTS.COLORS.RED + ';"></i>',
                isNormal: false,
                direction: 'down',
                isGrayND: false
              };
            } else {
              return {
                text: '正常',
                color: this.CONSTANTS.COLORS.GRAY,
                icon: '',
                isNormal: true,
                direction: null,
                isGrayND: true
              };
            }
          }

          // 如果检测值不是ND，转换为数字进行比较
          const numDetected = Number(detected);

          if (numDetected < min) {
            return {
              text: '偏低',
              color: this.CONSTANTS.COLORS.RED,
              icon: '<i class="fas fa-arrow-down ml-1" style="color: ' + this.CONSTANTS.COLORS.RED + ';"></i>',
              isNormal: false,
              direction: 'down',
              isGrayND: false
            };
          } else if (numDetected > max) {
            return {
              text: '超标',
              color: this.CONSTANTS.COLORS.RED,
              icon: '<i class="fas fa-arrow-up ml-1" style="color: ' + this.CONSTANTS.COLORS.RED + ';"></i>',
              isNormal: false,
              direction: 'up',
              isGrayND: false
            };
          } else {
            return {
              text: '正常',
              color: this.CONSTANTS.COLORS.GREEN,
              icon: '',
              isNormal: true,
              direction: null,
              isGrayND: false
            };
          }
        },

        // 生成星星评级
        generateStars(count, correlationType) {
          const starColor = this.CONSTANTS.CORRELATION[correlationType].starColor;
          return Array(3).fill().map((_, i) =>
            `<i class="fa fa-star ${i < count ? starColor : 'text-gray-300'}" aria-hidden="true"></i>`
          ).join('');
        },

        // 计算进度条百分比
        calculateProgressWidth(value) {
          if (value === 'ND' || value === 0) return 0;

          const num = Number(value);
          if (isNaN(num)) return 0;

          if (num <= 20) {
            return Math.min(20, Math.max(5, num * 1.5));
          }
          return Math.min(100, Math.max(0, num));
        },

        // 创建描述行
        createDescriptionRow(bacteria, status) {
          let descriptionContent = '';

          // 添加常规说明
          if (bacteria.说明 && bacteria.说明.trim()) {
            descriptionContent += `
            <div class="flex items-start mb-0">
              <div class="ml-1">
                <p>
                  <i class="fas fa-info-circle" style="color: ${this.CONSTANTS.COLORS.PRIMARY};"></i>
                  ${bacteria.说明}
                </p>
              </div>
            </div>
          `;
          }

          // 如果状态不是正常，并且有改善方式，添加改善建议
          if (!status.isNormal && bacteria.改善方式 && bacteria.改善方式.trim()) {
            descriptionContent += `
            <div class="flex items-start mt-0">
              <div class="ml-1">
                <p>
                  <i class="fas fa-bell" style="color: ${this.CONSTANTS.COLORS.WARNING};"></i>
                  <strong>改善建议：</strong> ${bacteria.改善方式}
                </p>
              </div>
            </div>
          `;
          }

          // 如果有内容需要显示，返回完整的行
          if (descriptionContent.trim()) {
            return `
            <tr class="description-row">
              <td colspan="7" class="py-2 px-4 text-left">
                <div class="description-container text-gray-600" style="font-size: 11px;">
                  ${descriptionContent}
                </div>
              </td>
            </tr>
          `;
          }

          // 如果没有描述内容，返回空字符串
          return '';
        },

        // 渲染表格
        renderTable(bloatingData) {
          const container = document.getElementById('bloating-data-table-body');
          if (!container) {
            console.error('Cannot find container element');
            return;
          }

          container.innerHTML = '';

          if (!bloatingData || !Array.isArray(bloatingData) || bloatingData.length === 0) {
            container.innerHTML = '<div class="text-center p-4 text-red-500">暂无腹胀相关菌数据</div>';
            return;
          }

          const fragment = document.createDocumentFragment();

          bloatingData.forEach(bacteria => {
            const { chineseName, latinName } = this.separateName(bacteria.名称);
            const normalRange = bacteria.正常范围;
            const detected = bacteria["丰度%"];
            const higherThanPercentage = bacteria.超过人群百分比 || "-";
            const correlation = bacteria.问题相关性;
            const evidenceStrength = parseInt(bacteria.证据强度 || "0", 10);

            const { min, max } = this.parseRange(normalRange);
            const status = this.getStatus(detected, normalRange);
            const isPositive = correlation === "+";
            const isNegative = correlation === "-";

            // 创建容器
            const bacteriaContainer = document.createElement('div');
            bacteriaContainer.className = 'bacteria-info-container';

            // 高亮风险组合
            if ((status.text === '超标' && isPositive) ||
              ((status.text === '偏低' || status.text === '缺乏') && isNegative)) {
              // 选择合适的边框颜色
              let borderColor;
              if (isPositive) {
                borderColor = this.CONSTANTS.COLORS.RED; // 正相关+超标用红色
              } else {
                borderColor = this.CONSTANTS.COLORS.ORANGE; // 负相关+偏低/缺乏用橙色
              }

              bacteriaContainer.style.border = `1px solid ${borderColor}`;
              bacteriaContainer.style.borderRadius = '4px';
              bacteriaContainer.style.margin = '4px 0';
            } else {
              bacteriaContainer.style.border = '1px solid transparent';
            }

            // 创建表格
            const table = document.createElement('table');
            table.className = 'bacteria-table min-w-full';

            // 格式化数值
            const formattedMinRange = this.formatNumber(min, 2);
            const formattedMaxRange = this.formatNumber(max, 2);

            // 数据行
            const progressPercentage = this.calculateProgressWidth(detected);

            // 根据状态确定未检出的颜色
            const detectedText = detected === "ND"
              ? (status.isGrayND ? `<span style="color: ${this.CONSTANTS.COLORS.GRAY}">未检出</span>` : '未检出')
              : this.formatNumber(detected);

            const dataRow = `
            <tr>
              <td class="py-2 px-4 text-left bloating-first-column">
                <div class="obesity-chinese-text"><strong>${chineseName || '未知'}</strong></div>
                <div class="obesity-latin-text text-gray-500">${latinName || ''}</div>
              </td>
              <td class="py-2 px-4 text-center bloating-second-column obesity-column-text">
                ${formattedMinRange}-${formattedMaxRange}
              </td>
              <td class="py-2 px-4 text-center bloating-third-column disease-column-text">
                <span style="color: ${status.isNormal && !status.isGrayND ? 'inherit' : status.color}">
                  ${detectedText}
                  ${status.icon || ''}
                </span>
                <div class="progress-bar w-full mt-2" style="background-color: #e9ecef; height: 8px; border-radius: 4px; overflow: hidden;">
                  <div class="progress"
                       style="width: ${progressPercentage}%;
                              height: 100%;
                              background-color: ${this.CONSTANTS.COLORS.PRIMARY};
                              transition: width 0.3s ease;">
                  </div>
                </div>
              </td>
              <td class="py-2 px-4 text-center bloating-fourth-column disease-column-text">
                <span class="${this.CONSTANTS.CORRELATION[correlation].textColor}">${this.CONSTANTS.CORRELATION[correlation].text}</span>
              </td>
              <td class="py-2 px-4 text-center bloating-fifth-column disease-column-text">
                <div class="flex justify-center items-center">
                  ${this.generateStars(evidenceStrength, correlation)}
                </div>
              </td>
            </tr>
          `;

            // 描述行
            const descRow = this.createDescriptionRow(bacteria, status);

            table.innerHTML = `<tbody>${dataRow}${descRow}</tbody>`;
            bacteriaContainer.appendChild(table);
            fragment.appendChild(bacteriaContainer);
          });

          container.appendChild(fragment);
        },

        // 加载数据
        async loadData() {
          try {
            const response = await fetch(DATA_PATHS.DATA);
            if (!response.ok) {
              throw new Error(`Network response error: ${response.status}`);
            }
            const data = await response.json();

            // 提取腹胀相关菌数据
            const bloatingData = data["疾病相关菌"] ? data["疾病相关菌"]["腹胀"] : [];
            this.renderTable(bloatingData);
          } catch (error) {
            console.error('Error loading bloating bacteria data:', error);
            document.getElementById('bloating-data-table-body').innerHTML =
              '<div class="text-center p-4 text-red-500">数据加载失败，请稍后再试</div>';
          }
        },

        // 初始化
        init() {
          if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => this.loadData());
          } else {
            this.loadData();
          }
        }
      };

      // 初始化腹胀相关菌模块
      BloatingBacteria.init();
    </script>
  </div>

  <!-- 疾病症状相关菌 : 过敏相关菌 -->

  <h3 class="custom-title-third-level page-break">
    过敏相关菌
  </h3>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">
    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            肠道菌群通过调控免疫耐受影响过敏反应。菌群失调（如双歧杆菌/乳酸菌丰度下降）会破坏Th1/Th2免疫平衡，导致Th2过度激活并刺激IgE分泌，引发肥大细胞脱颗粒。临床研究发现，过敏儿童肠道内梭菌属比例较健康组高3.8倍，而产丁酸菌减少使肠屏障通透性增加（血浆连蛋白水平升高62%），过敏原更易穿透肠道。益生菌干预可恢复IL-10/TGF-β抗炎通路，使特应性皮炎发病率降低40%
          </p>
        </div>
      </div>
    </div>

    <div class="rounded-table">
      <!-- 创建表格头部 -->
      <table class="min-w-full">
        <thead>
        <tr style="background-color: #00B2B4; color: white;">
          <th
            class="py-2 px-4 text-left allergy-first-column"
            style="font-size: 13px;"
          >
            过敏相关菌名称
          </th>
          <th
            class="py-2 px-4 text-center allergy-second-column"
            style="font-size: 13px; padding: 5px 5px;"
          >
            参考范围%
          </th>
          <th
            class="py-2 px-4 text-center allergy-third-column"
            style="font-size: 13px; padding: 5px 5px;"
          >
            检测丰度%
          </th>
          <th
            class="py-2 px-4 text-center allergy-fourth-column"
            style="font-size: 13px; padding: 5px 5px;"
          >
            相关性
          </th>
          <th
            class="py-2 px-4 text-center allergy-fifth-column"
            style="font-size: 13px; padding: 5px 5px;"
          >
            相关性强度
          </th>
        </tr>
        </thead>
      </table>

      <!-- 数据表格容器 -->
      <div id="allergy-data-table-body">
        <!-- 数据将通过 JavaScript 动态插入 -->
      </div>
    </div>

    <script>
      // 过敏相关菌数据展示模块
      const AllergyBacteria = {
        // 常量定义
        CONSTANTS: {
          COLORS: {
            RED: '#ff4d4f',
            GREEN: '#389e0d',
            YELLOW: '#faad14',
            BLUE: '#3b82f6',
            GRAY: '#808080',
            BLACK: '#000000',
            PRIMARY: '#00B2B4',
            WARNING: '#faad14',
            ORANGE: '#fa8c16'
          },
          CORRELATION: {
            "+": {
              text: "正相关",
              textColor: "text-black",
              starColor: "text-orange-500"
            },
            "-": {
              text: "负相关",
              textColor: "text-black",
              starColor: "text-blue-500"
            }
          }
        },

        // 格式化数字
        formatNumber(value, precision = 2) {
          if (value === "ND" || value === "-") return value;
          const num = Number(value);
          if (isNaN(num)) return value;
          return num.toPrecision(precision).replace(/\.?0+$/, '');
        },

        // 解析正常范围
        parseRange(rangeStr) {
          if (!rangeStr || typeof rangeStr !== 'string') {
            return { min: 0, max: 0 };
          }
          const parts = rangeStr.split('-');
          return {
            min: parseFloat(parts[0] || 0),
            max: parseFloat(parts[1] || 0)
          };
        },

        // 分离中文名和拉丁名
        separateName(fullName) {
          if (!fullName) return { chineseName: '', latinName: '' };

          // 假设格式是"中文名 拉丁名"，用空格分隔
          const parts = fullName.split(' ');

          // 如果只有一个部分，或者没有包含拉丁字符的部分
          if (parts.length === 1) {
            return { chineseName: parts[0], latinName: '' };
          }

          // 找到第一个包含拉丁字符的部分
          let latinIndex = -1;
          for (let i = 0; i < parts.length; i++) {
            if (/[a-zA-Z]/.test(parts[i])) {
              latinIndex = i;
              break;
            }
          }

          if (latinIndex === -1) {
            // 如果没有找到拉丁字符，全部作为中文名
            return { chineseName: fullName, latinName: '' };
          }

          // 分离中文名和拉丁名
          const chineseName = parts.slice(0, latinIndex).join(' ');
          const latinName = parts.slice(latinIndex).join(' ');

          return { chineseName, latinName };
        },

        // 获取状态信息
        getStatus(detected, normalRange) {
          const { min, max } = this.parseRange(normalRange);

          if (detected === "ND") {
            if (min > 0) {
              return {
                text: '缺乏',
                color: this.CONSTANTS.COLORS.RED,
                icon: '<i class="fas fa-arrow-down ml-1" style="color: ' + this.CONSTANTS.COLORS.RED + ';"></i>',
                isNormal: false,
                direction: 'down',
                isGrayND: false
              };
            } else {
              return {
                text: '正常',
                color: this.CONSTANTS.COLORS.GRAY,
                icon: '',
                isNormal: true,
                direction: null,
                isGrayND: true
              };
            }
          }

          // 如果检测值不是ND，转换为数字进行比较
          const numDetected = Number(detected);

          if (numDetected < min) {
            return {
              text: '偏低',
              color: this.CONSTANTS.COLORS.RED,
              icon: '<i class="fas fa-arrow-down ml-1" style="color: ' + this.CONSTANTS.COLORS.RED + ';"></i>',
              isNormal: false,
              direction: 'down',
              isGrayND: false
            };
          } else if (numDetected > max) {
            return {
              text: '超标',
              color: this.CONSTANTS.COLORS.RED,
              icon: '<i class="fas fa-arrow-up ml-1" style="color: ' + this.CONSTANTS.COLORS.RED + ';"></i>',
              isNormal: false,
              direction: 'up',
              isGrayND: false
            };
          } else {
            return {
              text: '正常',
              color: this.CONSTANTS.COLORS.GREEN,
              icon: '',
              isNormal: true,
              direction: null,
              isGrayND: false
            };
          }
        },

        // 生成星星评级
        generateStars(count, correlationType) {
          const starColor = this.CONSTANTS.CORRELATION[correlationType].starColor;
          return Array(3).fill().map((_, i) =>
            `<i class="fa fa-star ${i < count ? starColor : 'text-gray-300'}" aria-hidden="true"></i>`
          ).join('');
        },

        // 计算进度条百分比
        calculateProgressWidth(value) {
          if (value === 'ND' || value === 0) return 0;

          const num = Number(value);
          if (isNaN(num)) return 0;

          if (num <= 20) {
            return Math.min(20, Math.max(5, num * 1.5));
          }
          return Math.min(100, Math.max(0, num));
        },

        // 创建描述行
        createDescriptionRow(bacteria, status) {
          let descriptionContent = '';

          // 添加常规说明
          if (bacteria.说明 && bacteria.说明.trim()) {
            descriptionContent += `
            <div class="flex items-start mb-0">
              <div class="ml-1">
                <p>
                  <i class="fas fa-info-circle" style="color: ${this.CONSTANTS.COLORS.PRIMARY};"></i>
                  ${bacteria.说明}
                </p>
              </div>
            </div>
          `;
          }

          // 如果状态不是正常，并且有改善方式，添加改善建议
          if (!status.isNormal && bacteria.改善方式 && bacteria.改善方式.trim()) {
            descriptionContent += `
            <div class="flex items-start mt-0">
              <div class="ml-1">
                <p>
                  <i class="fas fa-bell" style="color: ${this.CONSTANTS.COLORS.WARNING};"></i>
                  <strong>改善建议：</strong> ${bacteria.改善方式}
                </p>
              </div>
            </div>
          `;
          }

          // 如果有内容需要显示，返回完整的行
          if (descriptionContent.trim()) {
            return `
            <tr class="description-row">
              <td colspan="7" class="py-2 px-4 text-left">
                <div class="description-container text-gray-600" style="font-size: 11px;">
                  ${descriptionContent}
                </div>
              </td>
            </tr>
          `;
          }

          // 如果没有描述内容，返回空字符串
          return '';
        },

        // 渲染表格
        renderTable(allergyData) {
          const container = document.getElementById('allergy-data-table-body');
          if (!container) {
            console.error('Cannot find container element');
            return;
          }

          container.innerHTML = '';

          if (!allergyData || !Array.isArray(allergyData) || allergyData.length === 0) {
            container.innerHTML = '<div class="text-center p-4 text-red-500">暂无过敏相关菌数据</div>';
            return;
          }

          const fragment = document.createDocumentFragment();

          allergyData.forEach(bacteria => {
            const { chineseName, latinName } = this.separateName(bacteria.名称);
            const normalRange = bacteria.正常范围;
            const detected = bacteria["丰度%"];
            const higherThanPercentage = bacteria.超过人群百分比 || "-";
            const correlation = bacteria.问题相关性;
            const evidenceStrength = parseInt(bacteria.证据强度 || "0", 10);

            const { min, max } = this.parseRange(normalRange);
            const status = this.getStatus(detected, normalRange);
            const isPositive = correlation === "+";
            const isNegative = correlation === "-";

            // 创建容器
            const bacteriaContainer = document.createElement('div');
            bacteriaContainer.className = 'bacteria-info-container';

            // 高亮风险组合
            if ((status.text === '超标' && isPositive) ||
              ((status.text === '偏低' || status.text === '缺乏') && isNegative)) {
              // 选择合适的边框颜色
              let borderColor;
              if (isPositive) {
                borderColor = this.CONSTANTS.COLORS.RED; // 正相关+超标用红色
              } else {
                borderColor = this.CONSTANTS.COLORS.ORANGE; // 负相关+偏低/缺乏用橙色
              }

              bacteriaContainer.style.border = `1px solid ${borderColor}`;
              bacteriaContainer.style.borderRadius = '4px';
              bacteriaContainer.style.margin = '4px 0';
            } else {
              bacteriaContainer.style.border = '1px solid transparent';
            }

            // 创建表格
            const table = document.createElement('table');
            table.className = 'bacteria-table min-w-full';

            // 格式化数值
            const formattedMinRange = this.formatNumber(min, 2);
            const formattedMaxRange = this.formatNumber(max, 2);

            // 数据行
            const progressPercentage = this.calculateProgressWidth(detected);

            // 根据状态确定未检出的颜色
            const detectedText = detected === "ND"
              ? (status.isGrayND ? `<span style="color: ${this.CONSTANTS.COLORS.GRAY}">未检出</span>` : '未检出')
              : this.formatNumber(detected);

            const dataRow = `
            <tr>
              <td class="py-2 px-4 text-left allergy-first-column">
                <div class="allergy-chinese-text"><strong>${chineseName || '未知'}</strong></div>
                <div class="allergy-latin-text text-gray-500">${latinName || ''}</div>
              </td>
              <td class="py-2 px-4 text-center allergy-second-column allergy-column-text">
                ${formattedMinRange}-${formattedMaxRange}
              </td>
              <td class="py-2 px-4 text-center allergy-third-column allergy-column-text">
                <span style="color: ${status.isNormal && !status.isGrayND ? 'inherit' : status.color}">
                  ${detectedText}
                  ${status.icon || ''}
                </span>
                <div class="progress-bar w-full mt-2" style="background-color: #e9ecef; height: 8px; border-radius: 4px; overflow: hidden;">
                  <div class="progress"
                       style="width: ${progressPercentage}%;
                              height: 100%;
                              background-color: ${this.CONSTANTS.COLORS.PRIMARY};
                              transition: width 0.3s ease;">
                  </div>
                </div>
              </td>

              <td class="py-2 px-4 text-center allergy-fourth-column allergy-column-text">
                <span class="${this.CONSTANTS.CORRELATION[correlation].textColor}">${this.CONSTANTS.CORRELATION[correlation].text}</span>
              </td>
              <td class="py-2 px-4 text-center allergy-fifth-column allergy-column-text">
                <div class="flex justify-center items-center">
                  ${this.generateStars(evidenceStrength, correlation)}
                </div>
              </td>
            </tr>
          `;

            // 描述行
            const descRow = this.createDescriptionRow(bacteria, status);

            table.innerHTML = `<tbody>${dataRow}${descRow}</tbody>`;
            bacteriaContainer.appendChild(table);
            fragment.appendChild(bacteriaContainer);
          });

          container.appendChild(fragment);
        },

        // 加载数据
        async loadData() {
          try {
            const response = await fetch(DATA_PATHS.DATA);
            if (!response.ok) {
              throw new Error(`Network response error: ${response.status}`);
            }
            const data = await response.json();

            // 提取过敏相关菌数据
            const allergyData = data["疾病相关菌"] ? data["疾病相关菌"]["过敏"] : [];
            this.renderTable(allergyData);
          } catch (error) {
            console.error('Error loading allergy bacteria data:', error);
            document.getElementById('allergy-data-table-body').innerHTML =
              '<div class="text-center p-4 text-red-500">数据加载失败，请稍后再试</div>';
          }
        },

        // 初始化
        init() {
          if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => this.loadData());
          } else {
            this.loadData();
          }
        }
      };

      // 初始化过敏相关菌模块
      AllergyBacteria.init();
    </script>
  </div>

  <!-- 疾病症状相关菌 : 抑郁相关菌 -->

  <h2 class="custom-title-1 page-break">抑郁相关菌</h2>

  <div class="bg-white rounded-lg p-5 mx-auto" style="width: 100%;">
    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            最新的医学研究表明，肠道菌群通过肠-脑轴双向通路参与情绪调控机制。特定共生菌（如产短链脂肪酸的罗斯氏菌属、双歧杆菌）的多样性衰减，会导致色氨酸代谢向犬尿氨酸途径偏移，5-HT合成路径受抑，同时伴随前额叶皮质多巴胺代谢稳态紊乱。临床队列数据显示，重度抑郁患者肠道内普氏菌属/嗜胆菌属比值异常升高（3.2倍于健康组），通过粪菌移植重构菌群构成后，皮质醇觉醒反应趋于正常化，HAMD-17量表评分降幅达54.3%（P<0.001），且肠道菌群β多样性指数与脑源性神经营养因子（BDNF）水平呈现显著正相关（r=0.72）。
          </p>
        </div>
      </div>
    </div>

    <div class="rounded-table" style="margin-bottom: -20px">
      <!-- 创建一个表格，其最小宽度被设置为其父元素的宽度 -->
      <table class="min-w-full">
        <thead>
        <tr style="background-color: #00B2B4; color: white;">
          <th class="py-2 px-4 text-left disease-first-column" style="font-size: 11px;">
            抑郁相关菌种名称
          </th>
          <th class="py-2 px-4 text-center disease-second-column" style="font-size: 11px; padding: 5px 5px;">
            正常范围%
          </th>
          <th class="py-2 px-4 text-center disease-third-column" style="font-size: 11px; padding: 5px 5px;">
            检测丰度%
          </th>
          <th class="py-2 px-4 text-center disease-fourth-column" style="font-size: 11px; padding: 5px 5px;">
            结果评价
          </th>
          <th class="py-2 px-4 text-center disease-fifth-column" style="font-size: 11px; padding: 5px 5px;">
            超过%的人
          </th>
          <th class="py-2 px-4 text-center disease-sixth-column" style="font-size: 11px; padding: 5px 5px;">
            相关性
          </th>
          <th class="py-2 px-4 text-center disease-seventh-column" style="font-size: 11px; padding: 5px 5px;">
            相关性强度
          </th>
        </tr>
        </thead>
      </table>

      <!-- 数据表格容器 -->
      <div id="depression-data-table-body">
        <!-- 数据将通过 JavaScript 动态插入 -->
      </div>
    </div>

    <script>
      // Javascript function to load the depression data
      async function loadDepressionData() {
        try {
          const response = await fetch(DATA_PATHS.DATA);
          const data = await response.json();
          renderDepressionDataTable(data.depression_data);
        } catch (error) {
          console.error('Error loading depression data:', error);
        }
      }

      // Javascript function to format numeric value in decimal places
      function formatNumber(value, precision = 3) {
        if (typeof value === "string") {
          return value;
        }
        const num = Number(value);
        return num.toPrecision(precision).replace(/\.?0+$/, '');
      }

      // Javascript function to scale progress bar
      function calculateProgressPercentage(value) {
        if (value < 0) return 0;
        if (value > 100) return 100;

        const num = Number(value);

        if (num <= 20) {
          return Math.min(20, Math.max(5, num * 1.5));
        }
        return num;
      }

      // Javascript function to determine the status
      function determineStatus(value, minRange, maxRange) {
        if (value < minRange) {
          return {
            text: '偏低',
            color: 'red',
            direction: 'down'
          };
        } else if (value > maxRange) {
          return {
            text: '超标',
            color: 'red',
            direction: 'up'
          };
        } else {
          return {
            text: '正常',
            color: 'green',
            direction: null
          };
        }
      }

      function generateStars(count, isPositive) {
        const starColor = isPositive ? 'text-orange-500' : 'text-blue-500';
        return Array(3).fill().map((_, i) =>
          `<i class="fa fa-star ${i < count ? starColor : 'text-gray-300'}" aria-hidden="true"></i>`
        ).join('');
      }

      function renderDepressionDataTable(depressionData) {
        const container = document.getElementById('depression-data-table-body');
        container.innerHTML = '';

        const CUSTOM_COLORS = {
          red: '#ff4d4f',
          green: '#389e0d',
          yellow: '#faad14'
        };

        depressionData.forEach(bacteria => {
          const bacteriaContainer = document.createElement('div');
          bacteriaContainer.className = 'bacteria-info-container';

          const table = document.createElement('table');
          table.className = 'bacteria-table min-w-full';

          const minRange = bacteria.normal_range.normal_range_min;
          const maxRange = bacteria.normal_range.normal_range_max;
          const currentValue = bacteria.detected_abundance;

          const formattedCurrentValue = formatNumber(currentValue);
          const formattedMinRange = formatNumber(minRange);
          const formattedMaxRange = formatNumber(maxRange);

          const status = determineStatus(currentValue, minRange, maxRange);
          const isNormal = status.text === '正常';

          const correlationText = bacteria.correlation === 'positive' ? '正相关' : '负相关';
          const isPositive = bacteria.correlation === 'positive';
          const isNegative = bacteria.correlation === 'negative';

          if (status.text === '超标' && isPositive) {
            bacteriaContainer.style.border = '1px solid #ff4d4f';
            bacteriaContainer.style.borderRadius = '4px';
            bacteriaContainer.style.margin = '4px 0';
          } else if (status.text === '偏低' && isNegative) {
            bacteriaContainer.style.border = '1px solid #3b82f6';
            bacteriaContainer.style.borderRadius = '4px';
            bacteriaContainer.style.margin = '4px 0';
          } else {
            bacteriaContainer.style.border = '1px solid transparent';
          }

          // 在 dataRow 模板中修改第三列的内容
          const dataRow = `
            <tr>
              <td class="py-2 px-4 text-left disease-first-column">
                <div class="chinese-text">
                  ${bacteria.chinese_name}
                </div>
                <div class="latin-text text-gray-500">
                  ${bacteria.latin_name}
                </div>
              </td>
              <td class="py-2 px-4 text-center disease-second-column disease-column-text">
                ${parseFloat(Number(formattedMinRange).toPrecision(2))}-${parseFloat(Number(formattedMaxRange).toPrecision(2))}
              </td>
              <td class="py-2 px-4 text-center disease-third-column disease-column-text">
                <span>${bacteria.detected_abundance === "ND" ? "未检出" : parseFloat(Number(formattedCurrentValue).toPrecision(2))}</span>
                <div class="progress-bar w-full mt-2">
                  <div class="progress"
                       style="width: ${bacteria.detected_abundance === 'ND' ? '0' :
                              Math.min(100,
                                Math.max(0,
                                  bacteria.detected_abundance <= 20
                                    ? Math.min(20, Math.max(5, bacteria.detected_abundance * 1.5))
                                    : bacteria.detected_abundance
                                )
                              )}%;
                              background-color: #00B2B4;
                              transition: width 0.3s ease;">
                  </div>
                </div>
              </td>
              <td class="py-2 px-4 text-center disease-fourth-column disease-column-text">
                <span class="font-bold" style="color: ${CUSTOM_COLORS[status.color]}">
                  ${status.text}
                  ${status.direction ? `<i class="fas fa-arrow-${status.direction} ml-1"></i>` : ''}
                </span>
              </td>
              <td class="py-2 px-4 text-center disease-fifth-column disease-column-text">
                ${bacteria.higher_than_percentage === "-" ? '-%' : (bacteria.higher_than_percentage * 100).toFixed(0) + '%'}
              </td>
              <td class="py-2 px-4 text-center disease-sixth-column disease-column-text">
                ${correlationText}
              </td>
              <td class="py-2 px-4 text-center disease-seventh-column disease-column-text">
                <div class="flex justify-center items-center">
                  ${generateStars(bacteria.stars, isPositive)}
                </div>
              </td>
            </tr>
          `;

          const filteredDescriptions = bacteria.descriptions.filter(desc =>
            desc.type === 'info' || (!isNormal && desc.type === 'warning')
          );

          const descRow = filteredDescriptions.length > 0 ? `
        <tr class="description-row">
          <td colspan="7" class="py-2 px-4 text-left">
            <div class="description-container text-gray-600" style="font-size: 10px;">
              ${filteredDescriptions.map(desc => `
                <div>
                  <i class="fas fa-${desc.type === 'info' ? 'info-circle' : 'bell'}"
                     style="color: ${desc.color};">
                  </i>
                  ${desc.text}
                </div>
              `).join('')}
            </div>
          </td>
        </tr>
      ` : '';

          table.innerHTML = `<tbody>${dataRow}${descRow}</tbody>`;
          bacteriaContainer.appendChild(table);
          container.appendChild(bacteriaContainer);
        });
      }

      document.addEventListener('DOMContentLoaded', loadDepressionData);
    </script>

  </div>

  <!-- 疾病症状相关菌 : 失眠相关菌 -->

  <h2 class="custom-title-1 page-break">失眠相关菌</h2>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">

    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            最新研究揭示肠道菌群通过肠-脑轴调控睡眠周期。特定菌群（如产丁酸菌群）的丰度下降会导致褪黑素合成减少，5-HT/γ-氨基丁酸代谢异常，进而影响睡眠-觉醒周期。临床数据显示，失眠患者普遍存在普雷沃菌属/乳酸菌属比值失衡，菌群移植干预可使睡眠效率提升40%
          </p>
        </div>
      </div>
    </div>

    <!-- 失眠相关菌群表格 -->
    <div class="rounded-table">
      <!-- 创建一个表格，其最小宽度被设置为其父元素的宽度。这在响应式设计中非常有用 -->
      <table class="min-w-full">
        <thead>
        <tr style="background-color: #00B2B4; color: white;">
          <th
            class="py-2 px-4 text-left disease-first-column"
            style="font-size: 11px;">
            失眠相关菌种名称
          </th>
          <th
            class="py-2 px-4 text-center disease-second-column"
            style="font-size: 11px; padding: 5px 5px;">
            正常范围%
          </th>
          <th
            class="py-2 px-4 text-center disease-third-column"
            style="font-size: 11px; padding: 5px 5px;">
            检测丰度%
          </th>
          <th
            class="py-2 px-4 text-center disease-fourth-column"
            style="font-size: 11px; padding: 5px 5px;">
            结果评价
          </th>
          <th
            class="py-2 px-4 text-center disease-fifth-column"
            style="font-size: 11px; padding: 5px 5px;">
            超过%的人
          </th>
          <th
            class="py-2 px-4 text-center disease-sixth-column"
            style="font-size: 11px; padding: 5px 5px;">
            相关性
          </th>
          <th
            class="py-2 px-4 text-center disease-seventh-column"
            style="font-size: 11px; padding: 5px 5px;">
            相关性强度
          </th>
        </tr>
        </thead>
      </table>

      <!-- 数据表格容器 -->
      <div id="insomnia-data-table-body">
        <!-- 数据将通过 JavaScript 动态插入 -->
      </div>

    </div>

    <!-- Javascript script to fulfill data into table data row dynamically -->
    <script>

      // Javascript function to load the insomnia data
      async function loadInsomniaData() {
        try {
          const response = await fetch(DATA_PATHS.DATA);
          const data = await response.json();
          renderInsomniaDataTable(data.insomnia_data);
        } catch (error) {
          console.error('Error loading insomnia data:', error);
        }
      }

      // Javascript function to format numeric value in decimal places
      function formatNumber(value, precision = 3) {
        if (typeof value === "string") {
          return value;
        }

        const num = Number(value);
        return num.toPrecision(precision).replace(/\.?0+$/, '');
      }

      // Javascript function to scale progress bar
      function calculateProgressPercentage(value) {
        // 输入范围检查
        if (value < 0) return 0; // 小于0返回0
        if (value > 100) return 100; // 大于100返回100

        const num = Number(value); // 转换输入为数字

        // 小范围数字的放大处理
        if (num <= 20) {
          return Math.min(20, Math.max(5, num * 1.5)); // 在0到20之间放大
        }

        // 大范围数字时，直接返回输入值
        return num; // 返回输入值，保持接近性的要求
      }

      // Javascript function to determine the status of the detection abundance of gut bacteria
      function determineStatus(value, minRange, maxRange) {
        if (value < minRange) {
          return {
            text: '偏低',
            color: 'red',
            direction: 'down'
          };
        } else if (value > maxRange) {
          return {
            text: '超标',
            color: 'red',
            direction: 'up'
          };
        } else {
          return {
            text: '正常',
            color: 'green',
            direction: null
          };
        }
      }

      function generateStars(count, isPositive) {
        const starColor = isPositive ? 'text-orange-500' : 'text-blue-500';
        return Array(3).fill().map((_, i) =>
          `<i class="fa fa-star ${i < count ? starColor : 'text-gray-300'}" aria-hidden="true"></i>`
        ).join('');
      }

      function renderInsomniaDataTable(insomniaData) {
        const container = document.getElementById('insomnia-data-table-body');
        container.innerHTML = '';

        const CUSTOM_COLORS = {
          red: '#ff4d4f',
          green: '#389e0d',
          yellow: '#faad14'
        };

        insomniaData.forEach(bacteria => {
          const bacteriaContainer = document.createElement('div');
          bacteriaContainer.className = 'bacteria-info-container';

          const table = document.createElement('table');
          table.className = 'bacteria-table min-w-full';

          const minRange = bacteria.normal_range.normal_range_min;
          const maxRange = bacteria.normal_range.normal_range_max;
          const currentValue = bacteria.detected_abundance;

          // 格式化数值，保留3位有效数字
          const formattedCurrentValue = formatNumber(currentValue);
          const formattedMinRange = formatNumber(minRange);
          const formattedMaxRange = formatNumber(maxRange);

          // 确定状态
          const status = determineStatus(currentValue, minRange, maxRange);
          const isNormal = status.text === '正常';

          // 确定相关性文本
          const correlationText = bacteria.correlation === 'positive' ? '正相关' : '负相关';
          const isPositive = bacteria.correlation === 'positive';
          const isNegative = bacteria.correlation === 'negative';

          // 判断边框颜色条件
          if (status.text === '超标' && isPositive) {
            // 超标且正相关时显示红色边框
            bacteriaContainer.style.border = '1px solid #ff4d4f';
            bacteriaContainer.style.borderRadius = '4px';
            bacteriaContainer.style.margin = '4px 0';
          } else if (status.text === '偏低' && isNegative) {
            // 偏低且负相关时显示蓝色边框
            bacteriaContainer.style.border = '1px solid #3b82f6'; // text-blue-500的十六进制颜色值
            bacteriaContainer.style.borderRadius = '4px';
            bacteriaContainer.style.margin = '4px 0';
          } else {
            // 其他情况显示透明边框
            bacteriaContainer.style.border = '1px solid transparent';
          }

          const dataRow = `
            <tr>
              <td class="py-2 px-4 text-left disease-first-column">
                <div class="chinese-text">
                    ${bacteria.chinese_name}
                </div>
                <div class="latin-text text-gray-500">
                    ${bacteria.latin_name}
                </div>
              </td>
              <td class="py-2 px-4 text-center disease-second-column disease-column-text">
                ${parseFloat(Number(formattedMinRange).toPrecision(2))}-${parseFloat(Number(formattedMaxRange).toPrecision(2))}
              </td>
              <td class="py-2 px-4 text-center disease-third-column disease-column-text">
                <span>${bacteria.detected_abundance === "ND" ? "未检出" : parseFloat(Number(formattedCurrentValue).toPrecision(2))}</span>
                <div class="progress-bar w-full mt-2">
                  <div class="progress"
                       style="width: ${bacteria.detected_abundance === 'ND' ? '0' :
                              Math.min(100,
                                Math.max(0,
                                  bacteria.detected_abundance <= 20
                                    ? Math.min(20, Math.max(5, bacteria.detected_abundance * 1.5))
                                    : bacteria.detected_abundance
                                )
                              )}%;
                              background-color: #00B2B4;
                              transition: width 0.3s ease;">
                  </div>
                </div>
              </td>
              <td class="py-2 px-4 text-center disease-fourth-column disease-column-text">
                <span
                  class="font-bold"
                  style="color: ${CUSTOM_COLORS[status.color]}">
                    ${status.text}
                    ${status.direction ?
                    `<i class="fas fa-arrow-${status.direction} ml-1"></i>`
                    : ''}
                </span>
              </td>
              <td class="py-2 px-4 text-center disease-fifth-column disease-column-text">
                ${bacteria.higher_than_percentage === "-" ? '-%' : (bacteria.higher_than_percentage * 100) + '%'}
              </td>
              <td class="py-2 px-4 text-center disease-sixth-column disease-column-text">
                ${correlationText}
              </td>
              <td class="py-2 px-4 text-center disease-seventh-column disease-column-text">
                <div class="flex justify-center items-center">
                  ${generateStars(bacteria.stars, isPositive)}
                </div>
              </td>
            </tr>
          `;

          // 过滤描述：始终显示info类型，只在不正常时显示warning类型
          const filteredDescriptions = bacteria.descriptions.filter(desc =>
            desc.type === 'info' || (!isNormal && desc.type === 'warning')
          );

          // 只有在有描述时才添加描述行
          const descRow = filteredDescriptions.length > 0 ? `
            <tr class="description-row">
              <td
                colspan="7"
                class="py-2 px-4 text-left">
                  <div
                    class="description-container text-gray-600"
                    style="font-size: 10px;">
                      ${filteredDescriptions.map(desc => `
                        <div>
                          <i class="fas fa-${desc.type === 'info' ? 'info-circle' : 'bell'}"
                             style="color: ${desc.color};">
                          </i>
                            ${desc.text}
                        </div>
                      `).join('')}
                  </div>
              </td>
            </tr>
          ` : '';

          table.innerHTML = `<tbody>${dataRow}${descRow}</tbody>`;
          bacteriaContainer.appendChild(table);
          container.appendChild(bacteriaContainer);
        });
      }

      document.addEventListener('DOMContentLoaded', loadInsomniaData);

    </script>

  </div>


  <!-- 个性化饮食板块 -->
  <h1 class="custom-title-second-level page-break">个性化饮食推荐</h1>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">

    <!-- 信息框 -->

    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">

          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            我们为您提供了200多种常见食物的个性化推荐指数，评分范围从 -100 到 100，并附有每种食物的详细营养成分构成（基于每 100g 计算）。
          </p>

          <ul class="list-disc ml-5">

            <li>
              <strong>推荐原理</strong>
              <ul class="list-disc ml-5">
                <li>
                  基于您的肠道菌群构成、营养状况和疾病风险进行综合评估
                </li>
                <li>
                  计算每种食物的营养构成与您当前营养状况的匹配程度
                </li>
                <li>
                  考虑特定疾病需要避免的食物
                </li>
                <li>
                  正分值表示建议增加摄入，负分值表示建议减少摄入
                </li>
                <li>
                  对于营养缺乏的成分，含该营养较高的食物会获得更高的推荐分值
                </li>
              </ul>
            </li>

            <li>
              <strong>使用说明</strong>
              <ul class="list-disc ml-5">
                <li>
                  本推荐适用于成年人，不适合 2 岁以下婴幼儿<
                </li>
                <li>
                  母乳喂养期间，可作为母亲的膳食参考
                </li>
                <li>
                  建议2个月后重新检测更新建议，以适应健康状况变化
                </li>
              </ul>
            </li>

            <li>
              <strong>数据来源</strong>
              <ul class="list-disc ml-5">
                <li>
                  基于大规模人群营养饮食调查
                </li>
                <li>
                  参考《2017中国居民膳食指南》
                </li>
                <li>
                  采用机器学习和统计方法计算
                </li>
                <li>
                  营养成分数据参考了来自 USDA 食品成分数据库
                </li>
              </ul>
            </li>

          </ul>

        </div>

      </div>

    </div>



  </div>

    <!-- 个性化饮食板块 : 个性化饮食推荐TOP30 -->
  <h2 class="custom-title-second-level page-break">个性化饮食推荐TOP30</h2>
  <div class="bg-white rounded-lg mt-4 mx-auto" style="width: 100%;">

    <!-- 图例 -->

    <div class="food-recommendation-top-legend-container">
      <div class="bg-[#FF3B30] text-center text-white text-sm py-1">避免摄入</div>
      <div class="bg-[#FF9500] text-center text-white text-sm py-1">控制摄入</div>
      <div class="bg-[#FFCC00] text-center text-white text-sm py-1">适当摄入</div>
      <div class="bg-[#7ED321] text-center text-white text-sm py-1">建议食用</div>
      <div class="bg-[#00C35A] text-center text-white text-sm py-1">建议多食用</div>
      <div class="bg-[#00B248] text-center text-white text-sm py-1">强烈推荐</div>
    </div>

    <!-- 刻度 -->
    <div class="food-recommendation-top-scale-container mb-2">
      <span class="food-recommendation-top-scale-number" style="left: 0">-100</span>
      <span class="food-recommendation-top-scale-number" style="left: 16.67%">-60</span>
      <span class="food-recommendation-top-scale-number" style="left: 33.33%">-30</span>
      <span class="food-recommendation-top-scale-number" style="left: 50%">0</span>
      <span class="food-recommendation-top-scale-number" style="left: 66.67%">30</span>
      <span class="food-recommendation-top-scale-number" style="left: 83.33%">60</span>
      <span class="food-recommendation-top-scale-number" style="left: 100%">100</span>
    </div>

    <!-- 食品条目 -->
    <div id="food-container"></div> <!-- 用于展示食品条目的容器 -->

    <script>
      async function fetchAndRenderTopAndLowestFoods() {
        try {
          // 1. 获取数据
          const response = await fetch(DATA_PATHS.DATA);
          const data = await response.json();

          // 2. 创建包含要合并的键的列表
          const keysToMerge = [
            'staple_food_data',
            'dairy_products_data',
            'dried_fruits_data',
            'fast_food_data',
            'aquatic_products_data',
            'fruit_data',
            'soup_data',
            'meat_data',
            'vegetables_data'
          ];

          // 3. 合并所有指定的食物数据
          let allFoods = [];
          keysToMerge.forEach(key => {
            if (data[key] && Array.isArray(data[key])) {
              allFoods = allFoods.concat(data[key]);
            }
          });

          // 4. 按推荐分数从高到低排序，取前 30 个和后 30 个
          const sortedFoods = allFoods.sort((a, b) => b.evaluation_value - a.evaluation_value); // 从高到低排序

          const topFoods = sortedFoods.slice(0, 30); // 最高的 30 个
          const lowestFoods = sortedFoods.slice(-30); // 最低的 30 个

          // 5. 渲染到页面
          const foodContainer = document.getElementById('food-container');
          foodContainer.innerHTML = ''; // 清空容器

          // 6. 渲染最高和最低食品一一对应
          const maxRows = Math.max(topFoods.length, lowestFoods.length);
          for (let i = 0; i < maxRows; i++) {
            const topFood = topFoods[i] || {}; // 如果没有更多的项，使用空对象
            const lowestFood = lowestFoods[maxRows - i - 1] || {}; // 同上

            const getNegativeColor = (value) => {
              if (value >= -100 && value < -60) {
                return '#FF3B30'; // -100 到 -60
              } else if (value >= -60 && value < -30) {
                return '#FF9500'; // -60 到 -30
              } else if (value >= -30 && value < 0) {
                return '#FFCC00'; // -30 到 0
              }
              return 'transparent'; // 其他情况
            };

            const getPositiveColor = (value) => {
              if (value >= 0 && value < 30) {
                return '#7ED321'; // 0 到 30
              } else if (value >= 30 && value < 60) {
                return '#00C35A'; // 30 到 60
              } else if (value >= 60 && value <= 100) {
                return '#00B248'; // 60 到 100
              }
              return 'transparent'; // 其他情况
            };

            const foodRow = `
              <div class="flex items-center mt-[1px]">
                  <div class="w-20 text-right pr-4">${lowestFood.chinese_name || '未定义'}</div>
                  <div class="food-recommendation-top-score-bar-container">
                      <div class="h-3.5 bg-gray-200 rounded-full overflow-hidden food-recommendation-top-score-bar">
                          <div class="food-recommendation-top-negative-score" style="background-color: ${getNegativeColor(lowestFood.evaluation_value)}; transform: scaleX(${-(lowestFood.evaluation_value || 0) / 100});"></div>
                          <div class="food-recommendation-top-positive-score" style="background-color: ${getPositiveColor(topFood.evaluation_value)}; transform: scaleX(${(topFood.evaluation_value || 0) / 100})"></div>
                      </div>
                  </div>
                  <div class="w-20 pl-4">${topFood.chinese_name || '未定义'}</div>
              </div>
          `;

            foodContainer.innerHTML += foodRow; // 动态添加到 DOM 中
          }

        } catch (error) {
          console.error("Error fetching or processing data:", error);
        }
      }

      // 调用函数
      fetchAndRenderTopAndLowestFoods();
    </script>
  </div>

  <h3 class="custom-title-third-level page-break">主食类饮食推荐</h3>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">
    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <i class="fas fa-info-circle icon"></i>
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
           主食类饮食是指以谷物、淀粉类食物为主要组成部分的饮食习惯，通常包括米饭、面条、面包、土豆、玉米等。主食是人体获取能量的主要来源，富含碳水化合物，是维持日常活动和身体功能所需的重要营养成分。
          </p>
        </div>
      </div>
    </div>

    <!-- 主食类推荐表格 -->
    <div class="rounded-table">
      <table class="min-w-full">
        <thead>
        <!-- 标题行 -->
        <tr style="background-color: #00B2B4; color: white;">
          <th class="py-2 px-4 text-left food-first-column" style="font-size: 10px;">食物名称</th>
          <th class="py-2 px-4 text-center food-second-column" style="font-size: 10px; padding: 5px 5px;">推荐指数</th>
          <th class="py-2 px-4 text-center food-third-column" style="font-size: 10px; padding: 5px 5px;">能量(KJ)</th>
          <th class="py-2 px-4 text-center food-fourth-column" style="font-size: 10px; padding: 5px 5px;">蛋白(g)</th>
          <th class="py-2 px-4 text-center food-fifth-column" style="font-size: 10px; padding: 5px 5px;">脂肪(g)</th>
          <th class="py-2 px-4 text-center food-sixth-column" style="font-size: 10px; padding: 5px 5px;">碳水化合物(g)</th>
          <th class="py-2 px-4 text-center food-seventh-column" style="font-size: 10px; padding: 5px 5px;">淀粉(g)</th>
          <th class="py-2 px-4 text-center food-eighth-column" style="font-size: 10px; padding: 5px 5px;">膳食纤维(g)</th>
          <th class="py-2 px-4 text-center food-nineth-column" style="font-size: 10px; padding: 5px 5px;">胆固醇(mg)</th>
        </tr>
        </thead>
        <tbody id="staple-food-data-table-body">

        </tbody>
      </table>

      <script>
        async function loadStapleFoodData() {
          try {
            const response = await fetch(DATA_PATHS.DATA);
            const data = await response.json();
            renderStapleFoodTable(data.staple_food_data);
          } catch (error) {
            console.error('Error loading food data:', error);
          }
        }

        function renderStapleFoodTable(staplefoodData) {
          const tableBody = document.getElementById('staple-food-data-table-body');
          if (!tableBody) {
            console.error('Food data table body not found');
            return;
          }

          tableBody.innerHTML = '';

          staplefoodData.forEach(food => {
            // 创建数据行
            const dataRow = document.createElement('tr');
            dataRow.classList.add('staple-food-data-row');
            const getProgressBarColor = (value) => {
              if (value >= -100 && value < -60) {
                return '#FF3B30'; // -100 到 -60
              } else if (value >= -60 && value < -30) {
                return '#FF9500'; // -60 到 -30
              } else if (value >= -30 && value < 0) {
                return '#FFCC00'; // -30 到 0
              } else if (value >= 0 && value < 30) {
                return '#7ED321'; // 0 到 30
              } else if (value >= 30 && value < 60) {
                return '#00C35A'; // 30 到 60
              } else if (value >= 60 && value <= 100) {
                return '#00B248'; // 60 到 100
              }
              return 'transparent'; // 其他情况
            };

            const progressBarColor = getProgressBarColor(food.evaluation_value);

            dataRow.innerHTML = `
              <td class="py-2 px-4 text-left">
                  <div class="chinese-text">${food.chinese_name}</div>
                  <div class="latin-text">${food.english_name}</div>
              </td>
              <td class="py-2 px-4 text-center food-column-text">
                  ${food.evaluation_value}
                  <div class="progress-bar w-full mt-1">
                      <div class="progress" style="background-color: ${progressBarColor}; width: ${Math.abs(food.evaluation_value)}%;"></div>
                  </div>
              </td>
              <td class="py-2 px-4 text-center food-column-text">${food.calories}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.protein}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.fat}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.carbohydrates}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.starch}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.fiber}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.cholesterol}</td>
          `;


            // 添加到表格
            tableBody.appendChild(dataRow);
          });
        }

        // 页面加载时加载致病菌数据
        document.addEventListener('DOMContentLoaded', loadStapleFoodData);
      </script>

    </div>

  </div>

  <h3 class="custom-title-third-level page-break">肉类推荐</h3>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">
    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <i class="fas fa-info-circle icon"></i>
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            肉类饮食是指以各种肉类为主要组成部分的饮食习惯，包括红肉（如牛肉、羊肉、猪肉）、禽肉（如鸡肉、鸭肉）和海鲜（如鱼、虾、贝类等）。
          </p>
        </div>
      </div>
    </div>

    <!-- 肉类推荐表格 -->
    <div class="rounded-table">
      <table class="min-w-full">
        <thead>
        <!-- 标题行 -->
        <tr style="background-color: #00B2B4; color: white;">
          <th class="py-2 px-4 text-left food-first-column" style="font-size: 10px;">食物名称</th>
          <th class="py-2 px-4 text-center food-second-column" style="font-size: 10px; padding: 5px 5px;">推荐指数</th>
          <th class="py-2 px-4 text-center food-third-column" style="font-size: 10px; padding: 5px 5px;">能量(KJ)</th>
          <th class="py-2 px-4 text-center food-fourth-column" style="font-size: 10px; padding: 5px 5px;">蛋白(g)</th>
          <th class="py-2 px-4 text-center food-fifth-column" style="font-size: 10px; padding: 5px 5px;">脂肪(g)</th>
          <th class="py-2 px-4 text-center food-sixth-column" style="font-size: 10px; padding: 5px 5px;">碳水化合物(g)</th>
          <th class="py-2 px-4 text-center food-seventh-column" style="font-size: 10px; padding: 5px 5px;">淀粉(g)</th>
          <th class="py-2 px-4 text-center food-eighth-column" style="font-size: 10px; padding: 5px 5px;">膳食纤维(g)</th>
          <th class="py-2 px-4 text-center food-nineth-column" style="font-size: 10px; padding: 5px 5px;">胆固醇(mg)</th>
        </tr>
        </thead>
        <tbody id="meat-data-table-body">

        </tbody>
      </table>

      <script>
        async function loadMeatData() {
          try {
            const response = await fetch(DATA_PATHS.DATA);
            const data = await response.json();
            // 对 aquatic_products_data 按照 evaluation_value 从大到小（从正到负）排序
            data.meat_data.sort((a, b) => b.evaluation_value - a.evaluation_value);
            renderMeatTable(data.meat_data);
          } catch (error) {
            console.error('Error loading meat data:', error);
          }
        }

        function renderMeatTable(fruitData) {
          const tableBody = document.getElementById('meat-data-table-body');
          if (!tableBody) {
            console.error('Meat data table body not found');
            return;
          }

          tableBody.innerHTML = '';

          fruitData.forEach(food => {
            // 创建数据行
            const dataRow = document.createElement('tr');
            dataRow.classList.add('meat-data-row');
            const getProgressBarColor = (value) => {
              if (value >= -100 && value < -60) {
                return '#FF3B30'; // -100 到 -60
              } else if (value >= -60 && value < -30) {
                return '#FF9500'; // -60 到 -30
              } else if (value >= -30 && value < 0) {
                return '#FFCC00'; // -30 到 0
              } else if (value >= 0 && value < 30) {
                return '#7ED321'; // 0 到 30
              } else if (value >= 30 && value < 60) {
                return '#00C35A'; // 30 到 60
              } else if (value >= 60 && value <= 100) {
                return '#00B248'; // 60 到 100
              }
              return 'transparent'; // 其他情况
            };

            const progressBarColor = getProgressBarColor(food.evaluation_value);

            dataRow.innerHTML = `
              <td class="py-2 px-4 text-left">
                  <div class="chinese-text">${food.chinese_name}</div>
                  <div class="latin-text">${food.english_name}</div>
              </td>
              <td class="py-2 px-4 text-center food-column-text">
                  ${food.evaluation_value}
                  <div class="progress-bar w-full mt-1">
                      <div class="progress" style="background-color: ${progressBarColor}; width: ${Math.abs(food.evaluation_value)}%;"></div>
                  </div>
              </td>
              <td class="py-2 px-4 text-center food-column-text">${food.calories}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.protein}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.fat}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.carbohydrates}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.starch}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.fiber}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.cholesterol}</td>
          `;


            // 添加到表格
            tableBody.appendChild(dataRow);
          });
        }

        // 页面加载时加载致病菌数据
        document.addEventListener('DOMContentLoaded', loadMeatData);
      </script>

    </div>

  </div>

  <h3 class="custom-title-third-level page-break">水产品推荐</h3>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">
    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <i class="fas fa-info-circle icon"></i>
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            水产品饮食是指以鱼类、贝类、甲壳类等水生动物为主要食材的饮食习惯。这类食品常见于地中海饮食和亚洲饮食中，因其营养丰富而备受推崇。
          </p>
        </div>
      </div>
    </div>

    <!-- 水产品推荐表格 -->
    <div class="rounded-table">
      <table class="min-w-full">
        <thead>
        <!-- 标题行 -->
        <tr style="background-color: #00B2B4; color: white;">
          <th class="py-2 px-4 text-left food-first-column" style="font-size: 10px;">食物名称</th>
          <th class="py-2 px-4 text-center food-second-column" style="font-size: 10px; padding: 5px 5px;">推荐指数</th>
          <th class="py-2 px-4 text-center food-third-column" style="font-size: 10px; padding: 5px 5px;">能量(KJ)</th>
          <th class="py-2 px-4 text-center food-fourth-column" style="font-size: 10px; padding: 5px 5px;">蛋白(g)</th>
          <th class="py-2 px-4 text-center food-fifth-column" style="font-size: 10px; padding: 5px 5px;">脂肪(g)</th>
          <th class="py-2 px-4 text-center food-sixth-column" style="font-size: 10px; padding: 5px 5px;">碳水化合物(g)</th>
          <th class="py-2 px-4 text-center food-seventh-column" style="font-size: 10px; padding: 5px 5px;">淀粉(g)</th>
          <th class="py-2 px-4 text-center food-eighth-column" style="font-size: 10px; padding: 5px 5px;">膳食纤维(g)</th>
          <th class="py-2 px-4 text-center food-nineth-column" style="font-size: 10px; padding: 5px 5px;">胆固醇(mg)</th>
        </tr>
        </thead>
        <tbody id="aquatic-products-data-table-body">

        </tbody>
      </table>

      <script>
        async function loadAquaticProductsData() {
          try {
            const response = await fetch(DATA_PATHS.DATA);
            const data = await response.json();
            // 对 aquatic_products_data 按照 evaluation_value 从大到小（从正到负）排序
            data.aquatic_products_data.sort((a, b) => b.evaluation_value - a.evaluation_value);
            renderAquaticProductsTable(data.aquatic_products_data);
          } catch (error) {
            console.error('Error loading aquatic products data:', error);
          }
        }

        function renderAquaticProductsTable(fastfoodData) {
          const tableBody = document.getElementById('aquatic-products-data-table-body');
          if (!tableBody) {
            console.error('Aquatic products data table body not found');
            return;
          }

          tableBody.innerHTML = '';

          fastfoodData.forEach(food => {
            // 创建数据行
            const dataRow = document.createElement('tr');
            dataRow.classList.add('fast-food-data-row');
            const getProgressBarColor = (value) => {
              if (value >= -100 && value < -60) {
                return '#FF3B30'; // -100 到 -60
              } else if (value >= -60 && value < -30) {
                return '#FF9500'; // -60 到 -30
              } else if (value >= -30 && value < 0) {
                return '#FFCC00'; // -30 到 0
              } else if (value >= 0 && value < 30) {
                return '#7ED321'; // 0 到 30
              } else if (value >= 30 && value < 60) {
                return '#00C35A'; // 30 到 60
              } else if (value >= 60 && value <= 100) {
                return '#00B248'; // 60 到 100
              }
              return 'transparent'; // 其他情况
            };

            const progressBarColor = getProgressBarColor(food.evaluation_value);

            dataRow.innerHTML = `
              <td class="py-2 px-4 text-left">
                  <div class="chinese-text">${food.chinese_name}</div>
                  <div class="latin-text">${food.english_name}</div>
              </td>
              <td class="py-2 px-4 text-center food-column-text">
                  ${food.evaluation_value}
                  <div class="progress-bar w-full mt-1">
                      <div class="progress" style="background-color: ${progressBarColor}; width: ${Math.abs(food.evaluation_value)}%;"></div>
                  </div>
              </td>
              <td class="py-2 px-4 text-center food-column-text">${food.calories}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.protein}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.fat}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.carbohydrates}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.starch}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.fiber}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.cholesterol}</td>
          `;


            // 添加到表格
            tableBody.appendChild(dataRow);
          });
        }

        // 页面加载时加载致病菌数据
        document.addEventListener('DOMContentLoaded', loadAquaticProductsData);
      </script>

    </div>

  </div>

  <h3 class="custom-title-third-level page-break">乳制品推荐</h3>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">
    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <i class="fas fa-info-circle icon"></i>
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            乳制品饮食是指以牛奶及其衍生产品（如酸奶、奶酪、黄油等）为主要组成部分的饮食习惯。乳制品是重要的营养来源，富含蛋白质、钙、维生素D和多种微量元素。
          </p>
        </div>
      </div>
    </div>

    <!-- 乳制品推荐表格 -->
    <div class="rounded-table">
      <table class="min-w-full">
        <thead>
        <!-- 标题行 -->
        <tr style="background-color: #00B2B4; color: white;">
          <th class="py-2 px-4 text-left food-first-column" style="font-size: 10px;">食物名称</th>
          <th class="py-2 px-4 text-center food-second-column" style="font-size: 10px; padding: 5px 5px;">推荐指数</th>
          <th class="py-2 px-4 text-center food-third-column" style="font-size: 10px; padding: 5px 5px;">能量(KJ)</th>
          <th class="py-2 px-4 text-center food-fourth-column" style="font-size: 10px; padding: 5px 5px;">蛋白(g)</th>
          <th class="py-2 px-4 text-center food-fifth-column" style="font-size: 10px; padding: 5px 5px;">脂肪(g)</th>
          <th class="py-2 px-4 text-center food-sixth-column" style="font-size: 10px; padding: 5px 5px;">碳水化合物(g)</th>
          <th class="py-2 px-4 text-center food-seventh-column" style="font-size: 10px; padding: 5px 5px;">淀粉(g)</th>
          <th class="py-2 px-4 text-center food-eighth-column" style="font-size: 10px; padding: 5px 5px;">膳食纤维(g)</th>
          <th class="py-2 px-4 text-center food-nineth-column" style="font-size: 10px; padding: 5px 5px;">胆固醇(mg)</th>
        </tr>
        </thead>
        <tbody id="dairy-products-data-table-body">

        </tbody>
      </table>

      <script>
        async function loadDairyProductsData() {
          try {
            const response = await fetch(DATA_PATHS.DATA);
            const data = await response.json();
            renderDairyProductsTable(data.dairy_products_data);
          } catch (error) {
            console.error('Error loading dairy products data:', error);
          }
        }

        function renderDairyProductsTable(dairyproductsData) {
          const tableBody = document.getElementById('dairy-products-data-table-body');
          if (!tableBody) {
            console.error('Dairy products data table body not found');
            return;
          }

          tableBody.innerHTML = '';

          dairyproductsData.forEach(food => {
            // 创建数据行
            const dataRow = document.createElement('tr');
            dataRow.classList.add('dairy-products-data-row');
            const getProgressBarColor = (value) => {
              if (value >= -100 && value < -60) {
                return '#FF3B30'; // -100 到 -60
              } else if (value >= -60 && value < -30) {
                return '#FF9500'; // -60 到 -30
              } else if (value >= -30 && value < 0) {
                return '#FFCC00'; // -30 到 0
              } else if (value >= 0 && value < 30) {
                return '#7ED321'; // 0 到 30
              } else if (value >= 30 && value < 60) {
                return '#00C35A'; // 30 到 60
              } else if (value >= 60 && value <= 100) {
                return '#00B248'; // 60 到 100
              }
              return 'transparent'; // 其他情况
            };

            const progressBarColor = getProgressBarColor(food.evaluation_value);

            dataRow.innerHTML = `
              <td class="py-2 px-4 text-left">
                  <div class="chinese-text">${food.chinese_name}</div>
                  <div class="latin-text">${food.english_name}</div>
              </td>
              <td class="py-2 px-4 text-center food-column-text">
                  ${food.evaluation_value}
                  <div class="progress-bar w-full mt-1">
                      <div class="progress" style="background-color: ${progressBarColor}; width: ${Math.abs(food.evaluation_value)}%;"></div>
                  </div>
              </td>
              <td class="py-2 px-4 text-center food-column-text">${food.calories}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.protein}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.fat}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.carbohydrates}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.starch}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.fiber}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.cholesterol}</td>
          `;


            // 添加到表格
            tableBody.appendChild(dataRow);
          });
        }

        // 页面加载时加载致病菌数据
        document.addEventListener('DOMContentLoaded', loadDairyProductsData);
      </script>

    </div>

  </div>

  <h3 class="custom-title-third-level page-break">汤推荐</h3>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">
    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <i class="fas fa-info-circle icon"></i>
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            汤类饮食是指以汤品为主要组成部分的饮食习惯。汤可以用多种食材制作，包括肉类、蔬菜、豆类和谷物等，具有多样性和灵活性。
          </p>
        </div>
      </div>
    </div>

    <!-- 汤推荐表格 -->
    <div class="rounded-table">
      <table class="min-w-full">
        <thead>
        <!-- 标题行 -->
        <tr style="background-color: #00B2B4; color: white;">
          <th class="py-2 px-4 text-left food-first-column" style="font-size: 10px;">食物名称</th>
          <th class="py-2 px-4 text-center food-second-column" style="font-size: 10px; padding: 5px 5px;">推荐指数</th>
          <th class="py-2 px-4 text-center food-third-column" style="font-size: 10px; padding: 5px 5px;">能量(KJ)</th>
          <th class="py-2 px-4 text-center food-fourth-column" style="font-size: 10px; padding: 5px 5px;">蛋白(g)</th>
          <th class="py-2 px-4 text-center food-fifth-column" style="font-size: 10px; padding: 5px 5px;">脂肪(g)</th>
          <th class="py-2 px-4 text-center food-sixth-column" style="font-size: 10px; padding: 5px 5px;">碳水化合物(g)</th>
          <th class="py-2 px-4 text-center food-seventh-column" style="font-size: 10px; padding: 5px 5px;">淀粉(g)</th>
          <th class="py-2 px-4 text-center food-eighth-column" style="font-size: 10px; padding: 5px 5px;">膳食纤维(g)</th>
          <th class="py-2 px-4 text-center food-nineth-column" style="font-size: 10px; padding: 5px 5px;">胆固醇(mg)</th>
        </tr>
        </thead>
        <tbody id="soup-data-table-body">

        </tbody>
      </table>

      <script>
        async function loadSoupData() {
          try {
            const response = await fetch(DATA_PATHS.DATA);
            const data = await response.json();
            // 对 aquatic_products_data 按照 evaluation_value 从大到小（从正到负）排序
            data.soup_data.sort((a, b) => b.evaluation_value - a.evaluation_value);
            renderSoupTable(data.soup_data);
          } catch (error) {
            console.error('Error loading soup data:', error);
          }
        }

        function renderSoupTable(fruitData) {
          const tableBody = document.getElementById('soup-data-table-body');
          if (!tableBody) {
            console.error('Fruit data table body not found');
            return;
          }

          tableBody.innerHTML = '';

          fruitData.forEach(food => {
            // 创建数据行
            const dataRow = document.createElement('tr');
            dataRow.classList.add('soup-data-row');
            const getProgressBarColor = (value) => {
              if (value >= -100 && value < -60) {
                return '#FF3B30'; // -100 到 -60
              } else if (value >= -60 && value < -30) {
                return '#FF9500'; // -60 到 -30
              } else if (value >= -30 && value < 0) {
                return '#FFCC00'; // -30 到 0
              } else if (value >= 0 && value < 30) {
                return '#7ED321'; // 0 到 30
              } else if (value >= 30 && value < 60) {
                return '#00C35A'; // 30 到 60
              } else if (value >= 60 && value <= 100) {
                return '#00B248'; // 60 到 100
              }
              return 'transparent'; // 其他情况
            };

            const progressBarColor = getProgressBarColor(food.evaluation_value);

            dataRow.innerHTML = `
              <td class="py-2 px-4 text-left">
                  <div class="chinese-text">${food.chinese_name}</div>
                  <div class="latin-text">${food.english_name}</div>
              </td>
              <td class="py-2 px-4 text-center food-column-text">
                  ${food.evaluation_value}
                  <div class="progress-bar w-full mt-1">
                      <div class="progress" style="background-color: ${progressBarColor}; width: ${Math.abs(food.evaluation_value)}%;"></div>
                  </div>
              </td>
              <td class="py-2 px-4 text-center food-column-text">${food.calories}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.protein}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.fat}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.carbohydrates}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.starch}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.fiber}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.cholesterol}</td>
          `;


            // 添加到表格
            tableBody.appendChild(dataRow);
          });
        }

        // 页面加载时加载致病菌数据
        document.addEventListener('DOMContentLoaded', loadSoupData);
      </script>

    </div>

  </div>

  <h3 class="custom-title-third-level page-break">蔬菜推荐</h3>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">
    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <i class="fas fa-info-circle icon"></i>
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            蔬菜类饮食是指以各种蔬菜为主要组成部分的饮食习惯。蔬菜富含维生素、矿物质、纤维和抗氧化物质，对维护健康和预防疾病有重要作用。
          </p>
        </div>
      </div>
    </div>

    <!-- 蔬菜推荐表格 -->
    <div class="rounded-table">
      <table class="min-w-full">
        <thead>
        <!-- 标题行 -->
        <tr style="background-color: #00B2B4; color: white;">
          <th class="py-2 px-4 text-left food-first-column" style="font-size: 10px;">食物名称</th>
          <th class="py-2 px-4 text-center food-second-column" style="font-size: 10px; padding: 5px 5px;">推荐指数</th>
          <th class="py-2 px-4 text-center food-third-column" style="font-size: 10px; padding: 5px 5px;">能量(KJ)</th>
          <th class="py-2 px-4 text-center food-fourth-column" style="font-size: 10px; padding: 5px 5px;">蛋白(g)</th>
          <th class="py-2 px-4 text-center food-fifth-column" style="font-size: 10px; padding: 5px 5px;">脂肪(g)</th>
          <th class="py-2 px-4 text-center food-sixth-column" style="font-size: 10px; padding: 5px 5px;">碳水化合物(g)</th>
          <th class="py-2 px-4 text-center food-seventh-column" style="font-size: 10px; padding: 5px 5px;">淀粉(g)</th>
          <th class="py-2 px-4 text-center food-eighth-column" style="font-size: 10px; padding: 5px 5px;">膳食纤维(g)</th>
          <th class="py-2 px-4 text-center food-nineth-column" style="font-size: 10px; padding: 5px 5px;">胆固醇(mg)</th>
        </tr>
        </thead>
        <tbody id="vegetables-data-table-body">

        </tbody>
      </table>

      <script>
        async function loadVegetablesData() {
          try {
            const response = await fetch(DATA_PATHS.DATA);
            const data = await response.json();
            // 对 aquatic_products_data 按照 evaluation_value 从大到小（从正到负）排序
            data.vegetables_data.sort((a, b) => b.evaluation_value - a.evaluation_value);
            renderVegetablesTable(data.vegetables_data);
          } catch (error) {
            console.error('Error loading vegetables data:', error);
          }
        }

        function renderVegetablesTable(vegetablesData) {
          const tableBody = document.getElementById('vegetables-data-table-body');
          if (!tableBody) {
            console.error('Vegetables data table body not found');
            return;
          }

          tableBody.innerHTML = '';

          vegetablesData.forEach(food => {
            // 创建数据行
            const dataRow = document.createElement('tr');
            dataRow.classList.add('vegetables-data-row');
            const getProgressBarColor = (value) => {
              if (value >= -100 && value < -60) {
                return '#FF3B30'; // -100 到 -60
              } else if (value >= -60 && value < -30) {
                return '#FF9500'; // -60 到 -30
              } else if (value >= -30 && value < 0) {
                return '#FFCC00'; // -30 到 0
              } else if (value >= 0 && value < 30) {
                return '#7ED321'; // 0 到 30
              } else if (value >= 30 && value < 60) {
                return '#00C35A'; // 30 到 60
              } else if (value >= 60 && value <= 100) {
                return '#00B248'; // 60 到 100
              }
              return 'transparent'; // 其他情况
            };

            const progressBarColor = getProgressBarColor(food.evaluation_value);

            dataRow.innerHTML = `
              <td class="py-2 px-4 text-left">
                  <div class="chinese-text">${food.chinese_name}</div>
                  <div class="latin-text">${food.english_name}</div>
              </td>
              <td class="py-2 px-4 text-center food-column-text">
                  ${food.evaluation_value}
                  <div class="progress-bar w-full mt-1">
                      <div class="progress" style="background-color: ${progressBarColor}; width: ${Math.abs(food.evaluation_value)}%;"></div>
                  </div>
              </td>
              <td class="py-2 px-4 text-center food-column-text">${food.calories}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.protein}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.fat}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.carbohydrates}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.starch}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.fiber}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.cholesterol}</td>
          `;


            // 添加到表格
            tableBody.appendChild(dataRow);
          });
        }

        // 页面加载时加载致病菌数据
        document.addEventListener('DOMContentLoaded', loadVegetablesData);
      </script>

    </div>

  </div>

  <h2 class="custom-title-third-level page-break">干果推荐</h2>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">
    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <i class="fas fa-info-circle icon"></i>
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            干果类饮食是指以坚果和干果为主要组成部分的饮食习惯。干果包括核桃、杏仁、腰果、榛子、桂圆、葡萄干等，经常被视为健康零食，富含营养成分。
          </p>
        </div>
      </div>
    </div>

    <!-- 干果推荐表格 -->
    <div class="rounded-table">
      <table class="min-w-full">
        <thead>
        <!-- 标题行 -->
        <tr style="background-color: #00B2B4; color: white;">
          <th class="py-2 px-4 text-left food-first-column" style="font-size: 10px;">食物名称</th>
          <th class="py-2 px-4 text-center food-second-column" style="font-size: 10px; padding: 5px 5px;">推荐指数</th>
          <th class="py-2 px-4 text-center food-third-column" style="font-size: 10px; padding: 5px 5px;">能量(KJ)</th>
          <th class="py-2 px-4 text-center food-fourth-column" style="font-size: 10px; padding: 5px 5px;">蛋白(g)</th>
          <th class="py-2 px-4 text-center food-fifth-column" style="font-size: 10px; padding: 5px 5px;">脂肪(g)</th>
          <th class="py-2 px-4 text-center food-sixth-column" style="font-size: 10px; padding: 5px 5px;">碳水化合物(g)</th>
          <th class="py-2 px-4 text-center food-seventh-column" style="font-size: 10px; padding: 5px 5px;">淀粉(g)</th>
          <th class="py-2 px-4 text-center food-eighth-column" style="font-size: 10px; padding: 5px 5px;">膳食纤维(g)</th>
          <th class="py-2 px-4 text-center food-nineth-column" style="font-size: 10px; padding: 5px 5px;">胆固醇(mg)</th>
        </tr>
        </thead>
        <tbody id="dried-fruits-data-table-body">

        </tbody>
      </table>

      <script>
        async function loadDriedFruitsData() {
          try {
            const response = await fetch(DATA_PATHS.DATA);
            const data = await response.json();
            renderDriedFruitsTable(data.dried_fruits_data);
          } catch (error) {
            console.error('Error loading dried fruits data:', error);
          }
        }

        function renderDriedFruitsTable(driedfruitsData) {
          const tableBody = document.getElementById('dried-fruits-data-table-body');
          if (!tableBody) {
            console.error('Dried fruits data table body not found');
            return;
          }

          tableBody.innerHTML = '';

          driedfruitsData.forEach(food => {
            // 创建数据行
            const dataRow = document.createElement('tr');
            dataRow.classList.add('dairy-products-data-row');
            const getProgressBarColor = (value) => {
              if (value >= -100 && value < -60) {
                return '#FF3B30'; // -100 到 -60
              } else if (value >= -60 && value < -30) {
                return '#FF9500'; // -60 到 -30
              } else if (value >= -30 && value < 0) {
                return '#FFCC00'; // -30 到 0
              } else if (value >= 0 && value < 30) {
                return '#7ED321'; // 0 到 30
              } else if (value >= 30 && value < 60) {
                return '#00C35A'; // 30 到 60
              } else if (value >= 60 && value <= 100) {
                return '#00B248'; // 60 到 100
              }
              return 'transparent'; // 其他情况
            };

            const progressBarColor = getProgressBarColor(food.evaluation_value);

            dataRow.innerHTML = `
              <td class="py-2 px-4 text-left">
                  <div class="chinese-text">${food.chinese_name}</div>
                  <div class="latin-text">${food.english_name}</div>
              </td>
              <td class="py-2 px-4 text-center food-column-text">
                  ${food.evaluation_value}
                  <div class="progress-bar w-full mt-1">
                      <div class="progress" style="background-color: ${progressBarColor}; width: ${Math.abs(food.evaluation_value)}%;"></div>
                  </div>
              </td>
              <td class="py-2 px-4 text-center food-column-text">${food.calories}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.protein}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.fat}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.carbohydrates}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.starch}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.fiber}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.cholesterol}</td>
          `;


            // 添加到表格
            tableBody.appendChild(dataRow);
          });
        }

        // 页面加载时加载致病菌数据
        document.addEventListener('DOMContentLoaded', loadDriedFruitsData);
      </script>

    </div>

  </div>

<!--  <h2 class="custom-title-third-level page-break">快餐推荐</h2>-->

<!--  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">-->
<!--    &lt;!&ndash; 信息框 &ndash;&gt;-->
<!--    <div class="info-box">-->
<!--      <div class="flex items-start">-->
<!--        <i class="fas fa-info-circle icon"></i>-->
<!--        <div class="ml-2">-->
<!--          <p class="text-lg text-custom-teal">-->
<!--            快餐类饮食是指以快速提供和方便食用为特点的食品，通常包括汉堡、炸鸡、薯条、披萨、寿司、热狗等。快餐因其快捷性和便捷性而广受欢迎，尤其是在忙碌的现代生活中。-->
<!--          </p>-->
<!--        </div>-->
<!--      </div>-->
<!--    </div>-->

<!--    &lt;!&ndash; 快餐推荐表格 &ndash;&gt;-->
<!--    <div class="rounded-table">-->
<!--      <table class="min-w-full">-->
<!--        <thead>-->
<!--        &lt;!&ndash; 标题行 &ndash;&gt;-->
<!--        <tr style="background-color: #00B2B4; color: white;">-->
<!--          <th class="py-2 px-4 text-left food-first-column" style="font-size: 10px;">食物名称</th>-->
<!--          <th class="py-2 px-4 text-center food-second-column" style="font-size: 10px; padding: 5px 5px;">推荐指数</th>-->
<!--          <th class="py-2 px-4 text-center food-third-column" style="font-size: 10px; padding: 5px 5px;">能量(KJ)</th>-->
<!--          <th class="py-2 px-4 text-center food-fourth-column" style="font-size: 10px; padding: 5px 5px;">蛋白(g)</th>-->
<!--          <th class="py-2 px-4 text-center food-fifth-column" style="font-size: 10px; padding: 5px 5px;">脂肪(g)</th>-->
<!--          <th class="py-2 px-4 text-center food-sixth-column" style="font-size: 10px; padding: 5px 5px;">碳水化合物(g)</th>-->
<!--          <th class="py-2 px-4 text-center food-seventh-column" style="font-size: 10px; padding: 5px 5px;">淀粉(g)</th>-->
<!--          <th class="py-2 px-4 text-center food-eighth-column" style="font-size: 10px; padding: 5px 5px;">膳食纤维(g)</th>-->
<!--          <th class="py-2 px-4 text-center food-nineth-column" style="font-size: 10px; padding: 5px 5px;">胆固醇(mg)</th>-->
<!--        </tr>-->
<!--        </thead>-->
<!--        <tbody id="fast-food-data-table-body">-->

<!--        </tbody>-->
<!--      </table>-->

<!--      <script>-->
<!--        async function loadFastFoodData() {-->
<!--          try {-->
<!--            const response = await fetch(DATA_PATHS.DATA);-->
<!--            const data = await response.json();-->
<!--            // 对 aquatic_products_data 按照 evaluation_value 从大到小（从正到负）排序-->
<!--            data.fast_food_data.sort((a, b) => b.evaluation_value - a.evaluation_value);-->
<!--            renderFastFoodTable(data.fast_food_data);-->
<!--          } catch (error) {-->
<!--            console.error('Error loading fast food data:', error);-->
<!--          }-->
<!--        }-->

<!--        function renderFastFoodTable(fastfoodData) {-->
<!--          const tableBody = document.getElementById('fast-food-data-table-body');-->
<!--          if (!tableBody) {-->
<!--            console.error('Fast food data table body not found');-->
<!--            return;-->
<!--          }-->

<!--          tableBody.innerHTML = '';-->

<!--          fastfoodData.forEach(food => {-->
<!--            // 创建数据行-->
<!--            const dataRow = document.createElement('tr');-->
<!--            dataRow.classList.add('fast-food-data-row');-->
<!--            const getProgressBarColor = (value) => {-->
<!--              if (value >= -100 && value < -60) {-->
<!--                return '#FF3B30'; // -100 到 -60-->
<!--              } else if (value >= -60 && value < -30) {-->
<!--                return '#FF9500'; // -60 到 -30-->
<!--              } else if (value >= -30 && value < 0) {-->
<!--                return '#FFCC00'; // -30 到 0-->
<!--              } else if (value >= 0 && value < 30) {-->
<!--                return '#7ED321'; // 0 到 30-->
<!--              } else if (value >= 30 && value < 60) {-->
<!--                return '#00C35A'; // 30 到 60-->
<!--              } else if (value >= 60 && value <= 100) {-->
<!--                return '#00B248'; // 60 到 100-->
<!--              }-->
<!--              return 'transparent'; // 其他情况-->
<!--            };-->

<!--            const progressBarColor = getProgressBarColor(food.evaluation_value);-->

<!--            dataRow.innerHTML = `-->
<!--              <td class="py-2 px-4 text-left">-->
<!--                  <div class="chinese-text">${food.chinese_name}</div>-->
<!--                  <div class="latin-text">${food.english_name}</div>-->
<!--              </td>-->
<!--              <td class="py-2 px-4 text-center food-column-text">-->
<!--                  ${food.evaluation_value}-->
<!--                  <div class="progress-bar w-full mt-1">-->
<!--                      <div class="progress" style="background-color: ${progressBarColor}; width: ${Math.abs(food.evaluation_value)}%;"></div>-->
<!--                  </div>-->
<!--              </td>-->
<!--              <td class="py-2 px-4 text-center food-column-text">${food.calories}</td>-->
<!--              <td class="py-2 px-4 text-center food-column-text">${food.protein}</td>-->
<!--              <td class="py-2 px-4 text-center food-column-text">${food.fat}</td>-->
<!--              <td class="py-2 px-4 text-center food-column-text">${food.carbohydrates}</td>-->
<!--              <td class="py-2 px-4 text-center food-column-text">${food.starch}</td>-->
<!--              <td class="py-2 px-4 text-center food-column-text">${food.fiber}</td>-->
<!--              <td class="py-2 px-4 text-center food-column-text">${food.cholesterol}</td>-->
<!--          `;-->


<!--            // 添加到表格-->
<!--            tableBody.appendChild(dataRow);-->
<!--          });-->
<!--        }-->

<!--        // 页面加载时加载致病菌数据-->
<!--        document.addEventListener('DOMContentLoaded', loadFastFoodData);-->
<!--      </script>-->

<!--    </div>-->

<!--  </div>-->

  <h2 class="custom-title-third-level page-break">水果推荐</h2>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">
    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <i class="fas fa-info-circle icon"></i>
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            水果类饮食是指以新鲜水果为主要组成部分的饮食习惯。水果不仅美味可口，而且富含维生素、矿物质、抗氧化物和膳食纤维，对健康有诸多益处。
          </p>
        </div>
      </div>
    </div>

    <!-- 水果推荐表格 -->
    <div class="rounded-table">
      <table class="min-w-full">
        <thead>
        <!-- 标题行 -->
        <tr style="background-color: #00B2B4; color: white;">
          <th class="py-2 px-4 text-left food-first-column" style="font-size: 10px;">食物名称</th>
          <th class="py-2 px-4 text-center food-second-column" style="font-size: 10px; padding: 5px 5px;">推荐指数</th>
          <th class="py-2 px-4 text-center food-third-column" style="font-size: 10px; padding: 5px 5px;">能量(KJ)</th>
          <th class="py-2 px-4 text-center food-fourth-column" style="font-size: 10px; padding: 5px 5px;">蛋白(g)</th>
          <th class="py-2 px-4 text-center food-fifth-column" style="font-size: 10px; padding: 5px 5px;">脂肪(g)</th>
          <th class="py-2 px-4 text-center food-sixth-column" style="font-size: 10px; padding: 5px 5px;">碳水化合物(g)</th>
          <th class="py-2 px-4 text-center food-seventh-column" style="font-size: 10px; padding: 5px 5px;">淀粉(g)</th>
          <th class="py-2 px-4 text-center food-eighth-column" style="font-size: 10px; padding: 5px 5px;">膳食纤维(g)</th>
          <th class="py-2 px-4 text-center food-nineth-column" style="font-size: 10px; padding: 5px 5px;">胆固醇(mg)</th>
        </tr>
        </thead>
        <tbody id="fruit-data-table-body">
        <!-- 数据将通过 JavaScript 动态插入 -->
        </tbody>
      </table>

      <script>
        async function loadFruitData() {
          try {
            const response = await fetch(DATA_PATHS.DATA);
            const data = await response.json();
            // 对 aquatic_products_data 按照 evaluation_value 从大到小（从正到负）排序
            data.fruit_data.sort((a, b) => b.evaluation_value - a.evaluation_value);
            renderFruitTable(data.fruit_data);
          } catch (error) {
            console.error('Error loading fruit data:', error);
          }
        }

        function renderFruitTable(fruitData) {
          const tableBody = document.getElementById('fruit-data-table-body');
          if (!tableBody) {
            console.error('Fruit data table body not found');
            return;
          }

          tableBody.innerHTML = '';

          fruitData.forEach(food => {
            // 创建数据行
            const dataRow = document.createElement('tr');
            dataRow.classList.add('fast-food-data-row');
            const getProgressBarColor = (value) => {
              if (value >= -100 && value < -60) {
                return '#FF3B30'; // -100 到 -60
              } else if (value >= -60 && value < -30) {
                return '#FF9500'; // -60 到 -30
              } else if (value >= -30 && value < 0) {
                return '#FFCC00'; // -30 到 0
              } else if (value >= 0 && value < 30) {
                return '#7ED321'; // 0 到 30
              } else if (value >= 30 && value < 60) {
                return '#00C35A'; // 30 到 60
              } else if (value >= 60 && value <= 100) {
                return '#00B248'; // 60 到 100
              }
              return 'transparent'; // 其他情况
            };

            const progressBarColor = getProgressBarColor(food.evaluation_value);

            dataRow.innerHTML = `
              <td class="py-2 px-4 text-left">
                  <div class="chinese-text">${food.chinese_name}</div>
                  <div class="latin-text">${food.english_name}</div>
              </td>
              <td class="py-2 px-4 text-center food-column-text">
                  ${food.evaluation_value}
                  <div class="progress-bar w-full mt-1">
                      <div class="progress" style="background-color: ${progressBarColor}; width: ${Math.abs(food.evaluation_value)}%;"></div>
                  </div>
              </td>
              <td class="py-2 px-4 text-center food-column-text">${food.calories}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.protein}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.fat}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.carbohydrates}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.starch}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.fiber}</td>
              <td class="py-2 px-4 text-center food-column-text">${food.cholesterol}</td>
          `;

            // 添加到表格
            tableBody.appendChild(dataRow);
          });
        }

        // 页面加载时加载致病菌数据
        document.addEventListener('DOMContentLoaded', loadFruitData);
      </script>

    </div>

  </div>


  <!-- 实际检出肠道菌群板块 -->

  <h1 class="custom-title-1 page-break">检出肠道微生物</h1>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">



  </div>


  <!-- 实际检出肠道菌群板块 : 检出细菌 -->

  <h2 class="custom-title-1 page-break">检出肠道细菌</h2>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">

    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            下列表格中展示了您肠道中实际检出的肠道细菌（仅展示丰度最高的前35个并且按照丰度递减排列）
          </p>
        </div>
      </div>
    </div>

    <div class="rounded-table">
      <table class="min-w-full">
        <thead>
        <tr style="background-color: #00B2B4; color: white;">
          <th class="py-2 px-4 text-left detected-gut-microbiota-first-column">菌种名称</th>
          <th class="py-2 px-4 text-center detected-gut-microbiota-second-column">正常范围</th>
          <th class="py-2 px-4 text-center detected-gut-microbiota-third-column">检测丰度</th>
          <th class="py-2 px-4 text-center detected-gut-microbiota-fourth-column">结果评价</th>
        </tr>
        </thead>
      </table>

      <div id="detected-gut-bacteria-data-table-body">
        <!-- 数据将通过 JavaScript 动态插入 -->
      </div>
    </div>

    <script>
      async function loadDetectedGutBacteriaData() {
        try {
          const response = await fetch(DATA_PATHS.DATA);
          const data = await response.json();
          data.detected_gut_bacteria_data.sort((a, b) => b.detected_abundance - a.detected_abundance);
          renderDetectedGutBacteriaTable(data.detected_gut_bacteria_data);
        } catch (error) {
          console.error('Error loading detected gut bacteria data:', error);
        }
      }

      function formatNumber(value) {
        if (typeof value === "string" && value === "未检出") {
          return value;
        }

        const num = Number(value);

        if (num >= 1) {
          const integerDigits = Math.floor(Math.log10(num)) + 1;
          const decimalPlaces = Math.max(0, 4 - integerDigits);
          return num.toFixed(decimalPlaces);
        } else {
          const str = num.toPrecision(4);
          return str.replace(/\.?0+$/, '');
        }
      }

      function formatDetectedValue(value) {
        if (value === "ND") {
          return "未检出";
        }
        return formatNumber(value);
      }

      function formatRangeValue(value) {
        return formatNumber(value);
      }

      function calculateProgressPercentage(value) {
        if (value === "ND" || value === 0) {
          return 0;
        }

        const num = Number(value);
        const logValue = Math.log10(num);
        const minLog = -1;
        const maxLog = 3;

        const percentage = ((logValue - minLog) / (maxLog - minLog)) * 45 + 5;
        return Math.max(5, Math.min(50, percentage));
      }

      function renderDetectedGutBacteriaTable(bacteriaData) {
        const container = document.getElementById('detected-gut-bacteria-data-table-body');
        if (!container) {
          console.error('Detected gut bacteria table body not found');
          return;
        }

        container.innerHTML = '';

        const CUSTOM_COLORS = {
          red: '#ff4d4f',
          green: '#389e0d',
          gray: '#808080'
        };

        bacteriaData.forEach(bacteria => {
          let statusColor, statusText, statusIcon;
          const detected = bacteria.detected_abundance;
          const minRange = bacteria.normal_range.min_normal_value;
          const maxRange = bacteria.normal_range.max_normal_value;

          const formattedDetectedValue = formatDetectedValue(detected);
          const formattedMinRange = formatRangeValue(minRange);
          const formattedMaxRange = formatRangeValue(maxRange);

          let isNormal = true;

          if (detected === "ND") {
            if (minRange > 0) {
              statusColor = 'red';
              statusText = '偏低';
              statusIcon = '<i class="fas fa-arrow-down ml-1"></i>';
              isNormal = false;
            } else {
              statusColor = 'green';
              statusText = '正常';
              statusIcon = '';
            }
          } else {
            if (detected < minRange) {
              statusColor = 'red';
              statusText = '偏低';
              statusIcon = '<i class="fas fa-arrow-down ml-1"></i>';
              isNormal = false;
            } else if (detected <= maxRange) {
              statusColor = 'green';
              statusText = '正常';
              statusIcon = '';
            } else {
              statusColor = 'red';
              statusText = '超标';
              statusIcon = '<i class="fas fa-arrow-up ml-1"></i>';
              isNormal = false;
            }
          }

          const bacteriaContainer = document.createElement('div');
          bacteriaContainer.className = 'bacteria-info-container';

          const table = document.createElement('table');
          table.className = 'bacteria-table min-w-full';

          const dataRow = `
        <tr class="bacteria-row">
          <td class="py-2 px-4 text-left detected-gut-microbiota-first-column">
            <div class="chinese-text">${bacteria.chinese_name}</div>
            <div class="latin-text text-gray-500">${bacteria.latin_name}</div>
          </td>
          <td class="py-2 px-4 text-center column-text detected-gut-microbiota-second-column">
            ${formattedMinRange}-${formattedMaxRange}
          </td>
          <td class="py-2 px-4 text-center column-text detected-gut-microbiota-third-column">
            ${formattedDetectedValue}
            <div class="progress-bar w-full mt-1">
              <div class="progress"
                   style="width: ${calculateProgressPercentage(detected)}%;
                          background-color: #00B2B4;
                          transition: width 0.3s ease;">
              </div>
            </div>
          </td>
          <td class="py-2 px-4 text-center bold-text column-text detected-gut-microbiota-fourth-column">
            <span style="color: ${CUSTOM_COLORS[statusColor]}">
              ${statusText}${statusIcon}
            </span>
          </td>
        </tr>
      `;

          const filteredDescriptions = bacteria.descriptions.filter(desc =>
            desc.type === 'info' || (!isNormal && desc.type === 'warning')
          );

          const descRow = filteredDescriptions.length > 0 ? `
        <tr class="bacteria-desc-row">
          <td colspan="6" class="py-2 px-4 text-left">
            <div class="description-container text-gray-600">
              ${filteredDescriptions.map(desc => `
                <div class="bacteria-description">
                  <i class="fas fa-${desc.type === 'info' ? 'info-circle' : 'bell'}"
                     style="color: ${desc.color};"></i>
                  ${desc.text}
                </div>
              `).join('')}
            </div>
          </td>
        </tr>
      ` : '';

          table.innerHTML = `<tbody>${dataRow}${descRow}</tbody>`;
          bacteriaContainer.appendChild(table);
          container.appendChild(bacteriaContainer);
        });
      }

      document.addEventListener('DOMContentLoaded', loadDetectedGutBacteriaData);
    </script>

  </div>

  <!-- 实际检出肠道菌群板块 : 检出真菌 -->

  <h2 class="custom-title-1 page-break">检出肠道真菌</h2>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">

    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            下列表格中展示了您肠道中实际检出的肠道真菌（仅展示丰度最高的前35个并且按照丰度递减排列）
          </p>
        </div>
      </div>
    </div>

    <div class="rounded-table">
      <table class="min-w-full">
        <thead>
        <tr style="background-color: #00B2B4; color: white;">
          <th class="py-2 px-4 text-left detected-gut-microbiota-first-column">菌种名称</th>
          <th class="py-2 px-4 text-center detected-gut-microbiota-second-column">正常范围</th>
          <th class="py-2 px-4 text-center detected-gut-microbiota-third-column">检测丰度</th>
          <th class="py-2 px-4 text-center detected-gut-microbiota-fourth-column">结果评价</th>
        </tr>
        </thead>
      </table>

      <div id="detected-gut-fungi-data-table-body">
        <!-- 数据将通过 JavaScript 动态插入 -->
      </div>
    </div>

    <script>
      async function loadDetectedGutFungiData() {
        try {
          const response = await fetch(DATA_PATHS.DATA);
          const data = await response.json();
          data.detected_gut_fungi_data.sort((a, b) => b.detected_abundance - a.detected_abundance);
          renderDetectedGutFungiTable(data.detected_gut_fungi_data);
        } catch (error) {
          console.error('Error loading detected gut fungi data:', error);
        }
      }

      function formatNumber(value) {
        if (typeof value === "string" && value === "未检出") {
          return value;
        }

        const num = Number(value);

        if (num >= 1) {
          const integerDigits = Math.floor(Math.log10(num)) + 1;
          const decimalPlaces = Math.max(0, 4 - integerDigits);
          return num.toFixed(decimalPlaces);
        } else {
          const str = num.toPrecision(4);
          return str.replace(/\.?0+$/, '');
        }
      }

      function formatDetectedValue(value) {
        if (value === "ND") {
          return "未检出";
        }
        return formatNumber(value);
      }

      function formatRangeValue(value) {
        return formatNumber(value);
      }

      function calculateProgressPercentage(value) {
        if (value === "ND" || value === 0) {
          return 0;
        }

        const num = Number(value);
        const logValue = Math.log10(num);
        const minLog = -1;
        const maxLog = 3;

        const percentage = ((logValue - minLog) / (maxLog - minLog)) * 45 + 5;
        return Math.max(5, Math.min(50, percentage));
      }

      function renderDetectedGutFungiTable(fungiData) {
        const container = document.getElementById('detected-gut-fungi-data-table-body');
        if (!container) {
          console.error('Detected gut fungi table body not found');
          return;
        }

        container.innerHTML = '';

        const CUSTOM_COLORS = {
          red: '#ff4d4f',
          green: '#389e0d',
          gray: '#808080'
        };

        fungiData.forEach(fungi => {
          let statusColor, statusText, statusIcon;
          const detected = fungi.detected_abundance;
          const minRange = fungi.normal_range.min_normal_value;
          const maxRange = fungi.normal_range.max_normal_value;

          const formattedDetectedValue = formatDetectedValue(detected);
          const formattedMinRange = formatRangeValue(minRange);
          const formattedMaxRange = formatRangeValue(maxRange);

          let isNormal = true;

          if (detected === "ND") {
            if (minRange > 0) {
              statusColor = 'red';
              statusText = '偏低';
              statusIcon = '<i class="fas fa-arrow-down ml-1"></i>';
              isNormal = false;
            } else {
              statusColor = 'green';
              statusText = '正常';
              statusIcon = '';
            }
          } else {
            if (detected < minRange) {
              statusColor = 'red';
              statusText = '偏低';
              statusIcon = '<i class="fas fa-arrow-down ml-1"></i>';
              isNormal = false;
            } else if (detected <= maxRange) {
              statusColor = 'green';
              statusText = '正常';
              statusIcon = '';
            } else {
              statusColor = 'red';
              statusText = '超标';
              statusIcon = '<i class="fas fa-arrow-up ml-1"></i>';
              isNormal = false;
            }
          }

          const fungiContainer = document.createElement('div');
          fungiContainer.className = 'fungi-info-container';

          const table = document.createElement('table');
          table.className = 'fungi-table min-w-full';

          const dataRow = `
        <tr class="fungi-row">
          <td class="py-2 px-4 text-left detected-gut-microbiota-first-column">
            <div class="chinese-text">${fungi.chinese_name}</div>
            <div class="latin-text text-gray-500">${fungi.latin_name}</div>
          </td>
          <td class="py-2 px-4 text-center column-text detected-gut-microbiota-second-column">
            ${formattedMinRange}-${formattedMaxRange}
          </td>
          <td class="py-2 px-4 text-center column-text detected-gut-microbiota-third-column">
            ${formattedDetectedValue}
            <div class="progress-bar w-full mt-1">
              <div class="progress"
                   style="width: ${calculateProgressPercentage(detected)}%;
                          background-color: #00B2B4;
                          transition: width 0.3s ease;">
              </div>
            </div>
          </td>
          <td class="py-2 px-4 text-center bold-text column-text detected-gut-microbiota-fourth-column">
            <span style="color: ${CUSTOM_COLORS[statusColor]}">
              ${statusText}${statusIcon}
            </span>
          </td>
        </tr>
      `;

          const filteredDescriptions = fungi.descriptions.filter(desc =>
            desc.type === 'info' || (!isNormal && desc.type === 'warning')
          );

          const descRow = filteredDescriptions.length > 0 ? `
        <tr class="fungi-desc-row">
          <td colspan="4" class="py-2 px-4 text-left">
            <div class="description-container text-gray-600">
              ${filteredDescriptions.map(desc => `
                <div class="fungi-description">
                  <i class="fas fa-${desc.type === 'info' ? 'info-circle' : 'bell'}"
                     style="color: ${desc.color};"></i>
                  ${desc.text}
                </div>
              `).join('')}
            </div>
          </td>
        </tr>
      ` : '';

          table.innerHTML = `<tbody>${dataRow}${descRow}</tbody>`;
          fungiContainer.appendChild(table);
          container.appendChild(fungiContainer);
        });
      }

      document.addEventListener('DOMContentLoaded', loadDetectedGutFungiData);
    </script>

  </div>

  <!-- 实际检出肠道菌群板块 : 检出真核生物 -->

  <h2 class="custom-title-1 page-break">检出肠道真核生物</h2>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">

    <!-- 信息框 -->
    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            下列表格中展示了您肠道中实际检出的肠道真核生物（仅展示丰度最高的前35个并且按照丰度递减排列）
          </p>
        </div>
      </div>
    </div>

    <div class="rounded-table">
      <table class="min-w-full">
        <thead>
        <tr style="background-color: #00B2B4; color: white;">
          <th class="py-2 px-4 text-left detected-gut-microbiota-first-column">菌种名称</th>
          <th class="py-2 px-4 text-center detected-gut-microbiota-second-column">正常范围</th>
          <th class="py-2 px-4 text-center detected-gut-microbiota-third-column">检测丰度</th>
          <th class="py-2 px-4 text-center detected-gut-microbiota-fourth-column">结果评价</th>
        </tr>
        </thead>
      </table>

      <div id="detected-gut-eukaryotes-data-table-body">
        <!-- 数据将通过 JavaScript 动态插入 -->
      </div>
    </div>

    <script>
      async function loadDetectedGutEukaryotesData() {
        try {
          const response = await fetch(DATA_PATHS.DATA);
          const data = await response.json();
          data.detected_gut_eukaryotes_data.sort((a, b) => b.detected_abundance - a.detected_abundance);
          renderDetectedGutEukaryotesTable(data.detected_gut_eukaryotes_data);
        } catch (error) {
          console.error('Error loading detected gut eukaryotes data:', error);
        }
      }

      function formatNumber(value) {
        if (typeof value === "string" && value === "未检出") {
          return value;
        }

        const num = Number(value);

        if (num >= 1) {
          const integerDigits = Math.floor(Math.log10(num)) + 1;
          const decimalPlaces = Math.max(0, 4 - integerDigits);
          return num.toFixed(decimalPlaces);
        } else {
          const str = num.toPrecision(4);
          return str.replace(/\.?0+$/, '');
        }
      }

      function formatDetectedValue(value) {
        if (value === "ND") {
          return "未检出";
        }
        return formatNumber(value);
      }

      function formatRangeValue(value) {
        return formatNumber(value);
      }

      function calculateProgressPercentage(value) {
        if (value === "ND" || value === 0) {
          return 0;
        }

        const num = Number(value);
        const logValue = Math.log10(num);
        const minLog = -1;
        const maxLog = 3;

        const percentage = ((logValue - minLog) / (maxLog - minLog)) * 45 + 5;
        return Math.max(5, Math.min(50, percentage));
      }

      function renderDetectedGutEukaryotesTable(eukaryotesData) {
        const container = document.getElementById('detected-gut-eukaryotes-data-table-body');
        if (!container) {
          console.error('Detected gut eukaryotes table body not found');
          return;
        }

        container.innerHTML = '';

        const CUSTOM_COLORS = {
          red: '#ff4d4f',
          green: '#389e0d',
          gray: '#808080'
        };

        eukaryotesData.forEach(eukaryotes => {
          let statusColor, statusText, statusIcon;
          const detected = eukaryotes.detected_abundance;
          const minRange = eukaryotes.normal_range.min_normal_value;
          const maxRange = eukaryotes.normal_range.max_normal_value;

          const formattedDetectedValue = formatDetectedValue(detected);
          const formattedMinRange = formatRangeValue(minRange);
          const formattedMaxRange = formatRangeValue(maxRange);

          let isNormal = true;

          if (detected === "ND") {
            if (minRange > 0) {
              statusColor = 'red';
              statusText = '偏低';
              statusIcon = '<i class="fas fa-arrow-down ml-1"></i>';
              isNormal = false;
            } else {
              statusColor = 'green';
              statusText = '正常';
              statusIcon = '';
            }
          } else {
            if (detected < minRange) {
              statusColor = 'red';
              statusText = '偏低';
              statusIcon = '<i class="fas fa-arrow-down ml-1"></i>';
              isNormal = false;
            } else if (detected <= maxRange) {
              statusColor = 'green';
              statusText = '正常';
              statusIcon = '';
            } else {
              statusColor = 'red';
              statusText = '超标';
              statusIcon = '<i class="fas fa-arrow-up ml-1"></i>';
              isNormal = false;
            }
          }

          const eukaryotesContainer = document.createElement('div');
          eukaryotesContainer.className = 'eukaryotes-info-container';

          const table = document.createElement('table');
          table.className = 'eukaryotes-table min-w-full';

          const dataRow = `
        <tr class="eukaryotes-row">
          <td class="py-2 px-4 text-left detected-gut-microbiota-first-column">
            <div class="chinese-text">${eukaryotes.chinese_name}</div>
            <div class="latin-text text-gray-500">${eukaryotes.latin_name}</div>
          </td>
          <td class="py-2 px-4 text-center column-text detected-gut-microbiota-second-column">
            ${formattedMinRange}-${formattedMaxRange}
          </td>
          <td class="py-2 px-4 text-center column-text detected-gut-microbiota-third-column">
            ${formattedDetectedValue}
            <div class="progress-bar w-full mt-1">
              <div class="progress"
                   style="width: ${calculateProgressPercentage(detected)}%;
                          background-color: #00B2B4;
                          transition: width 0.3s ease;">
              </div>
            </div>
          </td>
          <td class="py-2 px-4 text-center bold-text column-text detected-gut-microbiota-fourth-column">
            <span style="color: ${CUSTOM_COLORS[statusColor]}">
              ${statusText}${statusIcon}
            </span>
          </td>
        </tr>
      `;

          const filteredDescriptions = eukaryotes.descriptions.filter(desc =>
            desc.type === 'info' || (!isNormal && desc.type === 'warning')
          );

          const descRow = filteredDescriptions.length > 0 ? `
        <tr class="eukaryotes-desc-row">
          <td colspan="4" class="py-2 px-4 text-left">
            <div class="description-container text-gray-600">
              ${filteredDescriptions.map(desc => `
                <div class="eukaryotes-description">
                  <i class="fas fa-${desc.type === 'info' ? 'info-circle' : 'bell'}"
                     style="color: ${desc.color};"></i>
                  ${desc.text}
                </div>
              `).join('')}
            </div>
          </td>
        </tr>
      ` : '';

          table.innerHTML = `<tbody>${dataRow}${descRow}</tbody>`;
          eukaryotesContainer.appendChild(table);
          container.appendChild(eukaryotesContainer);
        });
      }

      document.addEventListener('DOMContentLoaded', loadDetectedGutEukaryotesData);
    </script>

  </div>

  <!-- 参考文献板块 -->
  <h1 class="custom-title-1 page-break">参考文献</h1>

  <div class="bg-white rounded-lg p-5 mb-5 mx-auto" style="width: 100%;">

    <!-- 参考文献板块 : 信息说明卡片 -->

    <div class="info-box">
      <div class="flex items-start">
        <div class="ml-2">
          <p class="text-lg text-custom-teal">
            <i class="fas fa-info-circle icon"></i>
            下列是本宏基因组报告作参考的文献资料。
          </p>
        </div>
      </div>
    </div>

    <!-- 参考文献板块 : 参考文献卡片展示 -->

    <div id="references" class="space-y-1"></div>

    <script>
      async function loadReferences() {
        try {
          // 使用 fetch API 获取数据
          const response = await fetch(DATA_PATHS.DATA);
          const data = await response.json();

          // 确保获取到的 data 具有 reference_data 属性
          const referencesContainer = document.getElementById('references');

          // 遍历从 JSON 获取的数据并生成 HTML
          data.reference_data.forEach(reference => {
            const referenceCard = `
              <div class="bg-white rounded-lg py-2 px-3 border border-gray-200 w-full reference-card-no-break">
                <div class="mb-1">
                  <h3 class="text-[12px] font-semibold text-gray-800">${reference.title}</h3>
                </div>
                <div class="flex flex-wrap gap-2 items-center">
                  <div class="flex items-center gap-2">
                    <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                    </svg>
                    <span class="text-[10px] text-gray-600">${reference.author}</span>
                  </div>
                  <span class="text-gray-300">•</span>
                  <div class="flex items-center gap-2">
                    <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
                    </svg>
                    <span class="text-[10px] text-gray-600">${reference.journal}</span>
                  </div>
                  <span class="text-gray-300">•</span>
                  <div class="flex items-center gap-2">
                    <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                    </svg>
                    <span class="text-[10px] text-gray-600">${reference.date}</span>
                  </div>
                </div>
              </div>
            `;

            referencesContainer.innerHTML += referenceCard; //将 HTML 卡片添加到容器中
          });
        } catch (error) {
          console.error("Error fetching data:", error);
        }
      }

      // 调用加载函数
      loadReferences();
    </script>


  </div>

</body>
</html>

